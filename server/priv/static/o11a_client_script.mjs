var k=e=>{throw TypeError(e)};var O=(e,n,t)=>n.has(e)||k("Cannot "+t);var h=(e,n,t)=>(O(e,n,"read from private field"),t?t.call(e):n.get(e)),A=(e,n,t)=>n.has(e)?k("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,t),m=(e,n,t,r)=>(O(e,n,"write to private field"),r?r.call(e,t):n.set(e,t),t);class D{withFields(n){let t=Object.keys(this).map(r=>r in n?n[r]:this[r]);return new this.constructor(...t)}}class ${static fromArray(n,t){let r=t||new y;for(let u=n.length-1;u>=0;--u)r=new E(n[u],r);return r}[Symbol.iterator](){return new T(this)}toArray(){return[...this]}atLeastLength(n){let t=this;for(;n-- >0&&t;)t=t.tail;return t!==void 0}hasLength(n){let t=this;for(;n-- >0&&t;)t=t.tail;return n===-1&&t instanceof y}countLength(){let n=this,t=0;for(;n;)n=n.tail,t++;return t-1}}function G(e,n){return new E(e,n)}function M(e,n){return $.fromArray(e,n)}var o;class T{constructor(n){A(this,o);m(this,o,n)}next(){if(h(this,o)instanceof y)return{done:!0};{let{head:n,tail:t}=h(this,o);return m(this,o,t),{value:n,done:!1}}}}o=new WeakMap;class y extends ${}class E extends ${constructor(n,t){super(),this.head=n,this.tail=t}}class p extends D{static isResult(n){return n instanceof p}}class c extends p{constructor(n){super(),this[0]=n}isOk(){return!0}}class s extends p{constructor(n){super(),this[0]=n}isOk(){return!1}}function B(e,n){return Q(e,n)}function H(e,n){let r=e,u=B(r,n);return u}function w(e,n){if(e.isOk()){let t=e[0];return new c(n(t))}else{let t=e[0];return new s(t)}}function a(e,n){if(e.isOk()){let t=e[0];return n(t)}else{let t=e[0];return new s(t)}}function _(e,n){if(e.isOk()){let t=e[0];return new c(t)}else return new s(n)}const J=void 0;function F(e){return/^[-+]?(\d+)$/.test(e)?new c(parseInt(e)):new s(J)}function d(e){return e.toString()}function Q(e,n){return e+n}function V(e,n){const t=e[Symbol.iterator]();let r=t.next().value||"",u=t.next();for(;!u.done;)r=r+n+u.value,u=t.next();return r}function S(e){console.log(e)}function x(e,n){return e<n?e:n}function U(e,n){return e>n?e:n}function W(e,n){return".dl"+d(e)+".dc"+d(n)}function L(e){let n=document.querySelector(e);return n?new c(n):new s}function X(e){e.focus()}function j(e,n){return n in e.dataset?new c(e.dataset[n]):new s(void 0)}function i(e){return e.preventDefault()}function Y(e){return e.key}function Z(e){return e.shiftKey}function ee(e,n){return window.addEventListener(e,n)}class ne extends D{constructor(n,t){super(),this.issue=n,this.cause=t}}function f(e){return new ne(e,M([]))}function g(e){return new s(f(e))}function te(e){let n=G(H("error: ",e.issue),e.cause);return V(n," <- ")}function re(e){let n=j(e,"lc"),t=a(n,F);return _(t,f("Failed to read line count data"))}function ue(e){let n=j(e,"cc"),t=a(n,F);return _(t,f("Failed to read column count data"))}const ie="line-container";function oe(e){let n=L("#L"+d(e)+"."+ie);return _(n,f("Failed to find non-empty line"))}let q=16;function se(e){q=e}function v(){return q}let C=1;function le(e){C=e}function I(){return C}let K=16;function ce(e){K=e}function fe(){return K}function ae(e,n){return new c(void 0)}function N(e,n){return a((()=>{let t=L("#audit-page"),r=_(t,f("Failed to find audit page"));return a(r,re)})(),t=>{if(n>0&&e===t)return g("Line is "+d(t)+", cannot go further down");if(n<0&&e===1)return g("Line is 1, cannot go further up");if(n===0)return g("Step is zero");{let r=U(1,x(t,e+n)),u=oe(r);if(u.isOk()){let R=u[0];return w(ue(R),z=>[r,z])}else return N(r,n>0&&r===t?-1:n>0||n<0&&r===1?1:n<0?-1:0)}})}function P(e,n){let t=L(W(e,n)),r=_(t,f("Failed to find line discussion to focus"));return w(r,X)}function l(e){return a(N(v(),e),n=>{let t=n[0],r=n[1];return w(P(t,x(r,I())),u=>(se(t),ce(r)))})}function b(e){let n=(()=>{let t=U(1,I()+e);return x(t,fe())})();return w(P(v(),n),t=>le(n))}function _e(e,n){let t=Z(e),r=Y(e);return!t&&r==="ArrowUp"?(i(e),l(-1)):!t&&r==="ArrowDown"?(i(e),l(1)):t&&r==="ArrowUp"?(i(e),l(-5)):t&&r==="ArrowDown"?(i(e),l(5)):r==="PageUp"?(i(e),l(-20)):r==="PageDown"?(i(e),l(20)):r==="ArrowLeft"?(i(e),b(-1)):r==="ArrowRight"?(i(e),b(1)):n()}function de(){return S("Starting page navigation"),ee("keydown",e=>{let n=_e(e,()=>ae());if(!(n.isOk()&&!n[0])){let t=n[0];return S(te(t))}})}document.addEventListener("DOMContentLoaded",de);
