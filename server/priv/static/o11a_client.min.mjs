var p=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},j=class{static fromArray(t,r){let n=r||new Fe;for(let i=t.length-1;i>=0;--i)n=new xe(t[i],n);return n}[Symbol.iterator](){return new br(this)}toArray(){return[...this]}atLeastLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return r!==void 0}hasLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return t===-1&&r instanceof Fe}countLength(){let t=this,r=0;for(;t;)t=t.tail,r++;return r-1}};function $(e,t){return new xe(e,t)}function a(e,t){return j.fromArray(e,t)}var br=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Fe)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},Fe=class extends j{},xe=class extends j{constructor(t,r){super(),this.head=t,this.tail=r}},Se=class{bitSize;byteSize;bitOffset;rawBuffer;constructor(t,r,n){if(!(t instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=r??t.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=n??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(t.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=t}byteAt(t){if(!(t<0||t>=this.byteSize))return Re(this.rawBuffer,this.bitOffset,t)}equals(t){if(this.bitSize!==t.bitSize)return!1;let r=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&t.bitOffset===0){for(let i=0;i<r;i++)if(this.rawBuffer[i]!==t.rawBuffer[i])return!1;let n=this.bitSize%8;if(n){let i=8-n;if(this.rawBuffer[r]>>i!==t.rawBuffer[r]>>i)return!1}}else{for(let i=0;i<r;i++){let s=Re(this.rawBuffer,this.bitOffset,i),o=Re(t.rawBuffer,t.bitOffset,i);if(s!==o)return!1}let n=this.bitSize%8;if(n){let i=Re(this.rawBuffer,this.bitOffset,r),s=Re(t.rawBuffer,t.bitOffset,r),o=8-n;if(i>>o!==s>>o)return!1}}return!0}get buffer(){if(Pn("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(Pn("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}};function Re(e,t,r){if(t===0)return e[r]??0;{let n=e[r]<<t&255,i=e[r+1]>>8-t;return n|i}}var yt=class{constructor(t){this.value=t}},Un={};function Pn(e,t){Un[e]||(console.warn(`Deprecated BitArray.${e} property used in JavaScript FFI code. ${t}.`),Un[e]=!0)}var Ae=class e extends p{static isResult(t){return t instanceof e}},h=class extends Ae{constructor(t){super(),this[0]=t}isOk(){return!0}},_=class extends Ae{constructor(t){super(),this[0]=t}isOk(){return!1}};function y(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!Dn(n)||!Dn(i)||!vs(n,i)||gs(n,i)||ys(n,i)||bs(n,i)||ks(n,i)||Os(n,i)||Ls(n,i))return!1;let o=Object.getPrototypeOf(n);if(o!==null&&typeof o.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[u,l]=xs(n);for(let f of u(n))r.push(l(n,f),l(i,f))}return!0}function xs(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function gs(e,t){return e instanceof Date&&(e>t||e<t)}function ys(e,t){return!(e instanceof Se)&&e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function bs(e,t){return Array.isArray(e)&&e.length!==t.length}function ks(e,t){return e instanceof Map&&e.size!==t.size}function Os(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function Ls(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function Dn(e){return typeof e=="object"&&e!==null}function vs(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}var m=class extends p{constructor(t){super(),this[0]=t}},w=class extends p{};function Rn(e){return!y(e,new w)}function bt(e,t){if(e instanceof m){let r=e[0];return new h(r)}else return new _(t)}function Fn(e,t){return e instanceof m?e[0]:t}function Cs(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1))e=r.tail,t=n+1;else return n}}function Lr(e){return Cs(e,0)}function Jn(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function L(e){return Jn(e,a([]))}function Yn(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return!1;if(r.atLeastLength(1)&&y(r.head,n)){let i=r.head;return!0}else e=r.tail,t=n}}function vr(e){if(e.hasLength(0))return new _(void 0);{let t=e.head;return new h(t)}}function Ns(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return L(s);{let o=n.head,u=n.tail,l=i(o)?$(o,s):s;e=u,t=i,r=l}}}function Je(e,t){return Ns(e,t,a([]))}function Is(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return L(s);{let o=n.head;e=n.tail,t=i,r=$(i(o),s)}}}function O(e,t){return Is(e,t,a([]))}function Ws(e,t,r){for(;;){let n=e,i=t,s=r;if(i<=0)return L(s);if(n.hasLength(0))return L(s);{let u=n.head;e=n.tail,t=i-1,r=$(u,s)}}}function jr(e,t){return Ws(e,t,a([]))}function Ms(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function de(e,t){return Ms(L(e),t)}function Us(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return L(n);{let i=r.head;e=r.tail,t=Jn(i,n)}}}function Ot(e){return Us(e,a([]))}function Ye(e,t){let r=O(e,t);return Ot(r)}function ue(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let o=n.head;e=n.tail,t=s(i,o),r=s}}}function Ps(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(i.hasLength(0))return s;{let l=i.head;e=i.tail,t=o(s,l,u),r=o,n=u+1}}}function Ke(e,t,r){return Ps(e,t,r,0)}function Ds(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return L(s);{let o=n.head,u=n.tail;Zn(i,o)?(e=u,t=i,r=s):(e=u,t=Y(i,o,void 0),r=$(o,s))}}}function Sr(e){return Ds(e,T(),a([]))}function Rs(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(i.hasLength(0))return[L(o),L(u)];{let l=i.head,f=i.tail;s(l)?(e=f,t=s,r=$(l,o),n=u):(e=f,t=s,r=o,n=$(l,u))}}}function Kn(e,t){return Rs(e,t,a([]),a([]))}function Fs(e,t){if(e.hasLength(0))return new _(void 0);{let r=e.head,n=e.tail;return new h(ue(n,r,t))}}function Xn(e){return Fs(e,(t,r)=>r)}function jt(e,t,r){let i=e,s=Ar(i,t,r);return s}function qr(e,t,r){if(r<0)return"";if(t<0){let s=Cr(e)+t;return s<0?"":Br(e,s,r)}else return Br(e,t,r)}function Tr(e){let r=me(e);return r}function Ze(e,t){for(;;){let r=e,n=t;if(n>0){let s=St(r);if(s.isOk())e=s[0][1],t=n-1;else return r}else return r}}function P(e,t){if(t==="")return vt(e);{let n=e,i=Er(n,t);return O(i,S)}}function Js(e){let r=ni(e);return O(r,ri)}function ei(e){return Js(e)}function ge(e,t){if(e.isOk()){let r=e[0];return new h(t(r))}else{let r=e[0];return new _(r)}}function Mr(e,t){if(e.isOk()){let r=e[0];return new h(r)}else{let r=e[0];return new _(t(r))}}function et(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new _(r)}}function K(e,t){return et(e,t)}function X(e,t){return e.isOk()?e[0]:t}function oi(e,t){if(e.isOk()){let r=e[0];return new h(r)}else{let r=e[0];return t(r)}}var li=new WeakMap,Ur=new DataView(new ArrayBuffer(8)),Pr=0;function Dr(e){let t=li.get(e);if(t!==void 0)return t;let r=Pr++;return Pr===2147483647&&(Pr=0),li.set(e,r),r}function Rr(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Hr(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function ai(e){Ur.setFloat64(0,e);let t=Ur.getInt32(0),r=Ur.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function eo(e){return Hr(e.toString())}function to(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return Dr(e);if(e instanceof Date)return ai(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+H(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+H(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+Rr(H(n),H(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];r=r+Rr(H(o),Hr(s))|0}}return r}function H(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return ai(e);case"string":return Hr(e);case"bigint":return eo(e);case"object":return to(e);case"symbol":return Dr(e);case"function":return Dr(e);default:return 0}}var re=5,Gr=Math.pow(2,re),ro=Gr-1,no=Gr/2,io=Gr/4,N=0,te=1,D=2,ye=3,Vr={type:D,bitmap:0,array:[]};function tt(e,t){return e>>>t&ro}function zt(e,t){return 1<<tt(e,t)}function so(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Jr(e,t){return so(e&t-1)}function G(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function oo(e,t,r){let n=e.length,i=new Array(n+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=r;s<n;)i[o++]=e[s++];return i}function Fr(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function fi(e,t,r,n,i,s){let o=H(t);if(o===n)return{type:ye,hash:o,array:[{type:N,k:t,v:r},{type:N,k:i,v:s}]};let u={val:!1};return rt(Yr(Vr,e,o,t,r,u),e,n,i,s,u)}function rt(e,t,r,n,i,s){switch(e.type){case te:return lo(e,t,r,n,i,s);case D:return Yr(e,t,r,n,i,s);case ye:return uo(e,t,r,n,i,s)}}function lo(e,t,r,n,i,s){let o=tt(r,t),u=e.array[o];if(u===void 0)return s.val=!0,{type:te,size:e.size+1,array:G(e.array,o,{type:N,k:n,v:i})};if(u.type===N)return y(n,u.k)?i===u.v?e:{type:te,size:e.size,array:G(e.array,o,{type:N,k:n,v:i})}:(s.val=!0,{type:te,size:e.size,array:G(e.array,o,fi(t+re,u.k,u.v,r,n,i))});let l=rt(u,t+re,r,n,i,s);return l===u?e:{type:te,size:e.size,array:G(e.array,o,l)}}function Yr(e,t,r,n,i,s){let o=zt(r,t),u=Jr(e.bitmap,o);if(e.bitmap&o){let l=e.array[u];if(l.type!==N){let d=rt(l,t+re,r,n,i,s);return d===l?e:{type:D,bitmap:e.bitmap,array:G(e.array,u,d)}}let f=l.k;return y(n,f)?i===l.v?e:{type:D,bitmap:e.bitmap,array:G(e.array,u,{type:N,k:n,v:i})}:(s.val=!0,{type:D,bitmap:e.bitmap,array:G(e.array,u,fi(t+re,f,l.v,r,n,i))})}else{let l=e.array.length;if(l>=no){let f=new Array(32),d=tt(r,t);f[d]=Yr(Vr,t+re,r,n,i,s);let c=0,g=e.bitmap;for(let E=0;E<32;E++){if(g&1){let B=e.array[c++];f[E]=B}g=g>>>1}return{type:te,size:l+1,array:f}}else{let f=oo(e.array,u,{type:N,k:n,v:i});return s.val=!0,{type:D,bitmap:e.bitmap|o,array:f}}}}function uo(e,t,r,n,i,s){if(r===e.hash){let o=Kr(e,n);if(o!==-1)return e.array[o].v===i?e:{type:ye,hash:r,array:G(e.array,o,{type:N,k:n,v:i})};let u=e.array.length;return s.val=!0,{type:ye,hash:r,array:G(e.array,u,{type:N,k:n,v:i})}}return rt({type:D,bitmap:zt(e.hash,t),array:[e]},t,r,n,i,s)}function Kr(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(y(t,e.array[n].k))return n;return-1}function Et(e,t,r,n){switch(e.type){case te:return ao(e,t,r,n);case D:return fo(e,t,r,n);case ye:return co(e,n)}}function ao(e,t,r,n){let i=tt(r,t),s=e.array[i];if(s!==void 0){if(s.type!==N)return Et(s,t+re,r,n);if(y(n,s.k))return s}}function fo(e,t,r,n){let i=zt(r,t);if(!(e.bitmap&i))return;let s=Jr(e.bitmap,i),o=e.array[s];if(o.type!==N)return Et(o,t+re,r,n);if(y(n,o.k))return o}function co(e,t){let r=Kr(e,t);if(!(r<0))return e.array[r]}function Xr(e,t,r,n){switch(e.type){case te:return po(e,t,r,n);case D:return mo(e,t,r,n);case ye:return ho(e,n)}}function po(e,t,r,n){let i=tt(r,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===N){if(!y(s.k,n))return e}else if(o=Xr(s,t+re,r,n),o===s)return e;if(o===void 0){if(e.size<=io){let u=e.array,l=new Array(e.size-1),f=0,d=0,c=0;for(;f<i;){let g=u[f];g!==void 0&&(l[d]=g,c|=1<<f,++d),++f}for(++f;f<u.length;){let g=u[f];g!==void 0&&(l[d]=g,c|=1<<f,++d),++f}return{type:D,bitmap:c,array:l}}return{type:te,size:e.size-1,array:G(e.array,i,o)}}return{type:te,size:e.size,array:G(e.array,i,o)}}function mo(e,t,r,n){let i=zt(r,t);if(!(e.bitmap&i))return e;let s=Jr(e.bitmap,i),o=e.array[s];if(o.type!==N){let u=Xr(o,t+re,r,n);return u===o?e:u!==void 0?{type:D,bitmap:e.bitmap,array:G(e.array,s,u)}:e.bitmap===i?void 0:{type:D,bitmap:e.bitmap^i,array:Fr(e.array,s)}}return y(n,o.k)?e.bitmap===i?void 0:{type:D,bitmap:e.bitmap^i,array:Fr(e.array,s)}:e}function ho(e,t){let r=Kr(e,t);if(r<0)return e;if(e.array.length!==1)return{type:ye,hash:e.hash,array:Fr(e.array,r)}}function ci(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===N){t(s.v,s.k);continue}ci(s,t)}}}var he=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=Et(this.root,0,H(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?Vr:this.root,s=rt(i,0,H(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=Xr(this.root,0,H(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:Et(this.root,0,H(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){ci(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+Rr(H(r),H(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;try{return this.forEach((r,n)=>{if(!y(t.get(n,!r),r))throw ui}),!0}catch(r){if(r===ui)return!1;throw r}}},ui=Symbol();var hi=void 0,pi={};function S(e){return e}function J(e){return e.toString()}function Ar(e,t,r){return typeof e.replaceAll<"u"?e.replaceAll(t,r):e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),r)}function Cr(e){if(e==="")return 0;let t=Bt(e);if(t){let r=0;for(let n of t)r++;return r}else return e.match(/./gsu).length}function vt(e){let t=Bt(e);return t?j.fromArray(Array.from(t).map(r=>r.segment)):j.fromArray(e.match(/./gsu))}var di;function Bt(e){if(globalThis.Intl&&Intl.Segmenter)return di||=new Intl.Segmenter,di.segment(e)[Symbol.iterator]()}function St(e){let t,r=Bt(e);return r?t=r.next().value?.segment:t=e.match(/./su)?.[0],t?new h([t,e.slice(t.length)]):new _(hi)}function be(e){return[e.charCodeAt(0)|0,e.slice(1)]}function I(e){return e.toLowerCase()}function Er(e,t){return j.fromArray(e.split(t))}function me(e){let t="";for(let r of e)t=t+r;return t}function Br(e,t,r){if(r<=0||t>=e.length)return"";let n=Bt(e);if(n){for(;t-- >0;)n.next();let i="";for(;r-- >0;){let s=n.next().value;if(s===void 0)break;i+=s.segment}return i}else return e.match(/./gsu).slice(t,t+r).join("")}function z(e,t,r){return e.slice(t,t+r)}function Nr(e,t){return e.indexOf(t)>=0}function ze(e,t){return e.startsWith(t)}var _i=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),Ea=new RegExp(`^[${_i}]*`),za=new RegExp(`[${_i}]*$`);function Zr(e){console.log(e)}function ri(e){return new yt(e)}function ni(e){return j.fromArray(Array.from(e).map(t=>t.codePointAt(0)))}function Ir(e){return e.value}function T(){return he.new()}function At(e){return j.fromArray(e.entries())}function U(e,t){let r=e.get(t,pi);return r===pi?new _(hi):new h(r)}function $i(e,t,r){return r.set(e,t)}function ee(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof Ae)return"Result";if(e instanceof j)return"List";if(e instanceof Se)return"BitArray";if(e instanceof he)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function wo(e,t){return!y(U(t,e),new _(void 0))}function Zn(e,t){return wo(t,e)}function Y(e,t,r){return $i(t,r,e)}function xo(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head[0],s=r.head[1];e=r.tail,t=Y(n,i,s)}}}function Lt(e){return xo(e,T())}function go(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function yo(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return go(n,a([]));{let i=r.head[0];e=r.tail,t=$(i,n)}}}function Qr(e){return yo(At(e),a([]))}function wi(e,t){let r=Number.isInteger(t);if(e instanceof he||e instanceof WeakMap||e instanceof Map){let n={},i=e.get(t,n);return i===n?new h(new w):new h(new m(i))}if(Number.isInteger(t)&&t<8&&e instanceof j){let n=0;for(let i of e){if(n===t)return new h(new m(i));n++}return new _("Indexable")}return r&&Array.isArray(e)||e&&typeof e=="object"||e&&Object.getPrototypeOf(e)===Object.prototype?t in e?new h(new m(e[t])):new h(new w):new _(r?"Indexable":"Dict")}function xi(e,t,r,n,i){if(!(e instanceof j||Array.isArray(e))){let o=new fe("List",ee(e),i);return[i,j.fromArray([o])]}let s=[];for(let o of e){let u=t(o),[l,f]=u;if(f instanceof xe){let[d,c]=r(u,n.toString());return[i,c]}s.push(l),n++}return[j.fromArray(s),i]}function gi(e){return Number.isInteger(e)?new h(e):new _(0)}function yi(e){return typeof e=="string"?new h(e):new _(0)}var fe=class extends p{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}},ne=class extends p{constructor(t){super(),this.function=t}};function tn(e,t){let r=t.function(e),n=r[0],i=r[1];return i.hasLength(0)?new h(n):new _(i)}function ke(e){return new ne(t=>[e,a([])])}function bo(e,t){return new ne(r=>{let n=e.function(r),i=n[0],s=n[1];return[t(i),s]})}function ko(e,t,r){for(;;){let n=e,i=t,s=r;if(s.hasLength(0))return i;{let o=s.head,u=s.tail,l=o.function(n),f=l;if(l[1].hasLength(0))return f;e=n,t=i,r=u}}}function Oo(e,t){return new ne(r=>{let n=e.function(r),i=n;return n[1].hasLength(0)?i:ko(r,i,t)})}function Lo(e,t){return a([new fe(e,ee(t),a([]))])}function bi(e,t,r){let n=r(e);return n.isOk()?[n[0],a([])]:[n[0],a([new fe(t,ee(e),a([]))])]}function vo(e){return bi(e,"Int",gi)}function ki(e,t){return new ne(r=>[e,Lo(t,r)])}var Tt=new ne(vo);function jo(e){return bi(e,"String",yi)}var V=new ne(jo);function Ct(e){return new ne(t=>xi(t,e.function,(r,n)=>qt(r,a([n])),0,a([])))}function qt(e,t){let r=Oo(V,a([bo(Tt,J)])),n=O(t,s=>{let o=s,u=tn(o,r);return u.isOk()?u[0]:"<"+ee(o)+">"}),i=O(e[1],s=>{let o=s;return new fe(o.expected,o.found,de(n,s.path))});return[e[0],i]}function So(e,t,r,n,i){for(;;){let s=e,o=t,u=r,l=n,f=i;if(s.hasLength(0)){let d=u(l);return qt(d,L(o))}else{let d=s.head,c=s.tail,g=wi(l,d);if(g.isOk()&&g[0]instanceof m){let E=g[0][0];e=c,t=$(d,o),r=u,n=E,i=f}else{if(g.isOk()&&g[0]instanceof w)return f(l,$(d,o));{let E=g[0],je=[u(l)[0],a([new fe(E,ee(l),a([]))])];return qt(je,L(o))}}}}}function Ao(e,t,r){return new ne(n=>{let i=So(e,a([]),t.function,n,(d,c)=>{let B=[t.function(d)[0],a([new fe("Field","Nothing",a([]))])];return qt(B,L(c))}),s=i[0],o=i[1],u=r(s).function(n),l=u[0],f=u[1];return[l,de(o,f)]})}function W(e,t,r){return Ao(a([e]),t,r)}var x=class extends p{constructor(t,r,n,i,s,o,u){super(),this.scheme=t,this.userinfo=r,this.host=n,this.port=i,this.path=s,this.query=o,this.fragment=u}};function To(e){return 48>=e&&e<=57||65>=e&&e<=90||97>=e&&e<=122||e===58||e===46}function se(e,t){return new h((()=>{let r=t;return new x(r.scheme,r.userinfo,r.host,r.port,r.path,r.query,new m(e))})())}function Co(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(s.startsWith("#")&&u===0){let l=s.slice(1);return se(l,o)}else if(s.startsWith("#")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(c.scheme,c.userinfo,c.host,c.port,c.path,new m(f),c.fragment)})();return se(l,d)}else{if(s==="")return new h((()=>{let l=o;return new x(l.scheme,l.userinfo,l.host,l.port,l.path,new m(i),l.fragment)})());{let f=be(s)[1];e=i,t=f,r=o,n=u+1}}}}function _e(e,t){return Co(e,e,t,0)}function No(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(s.startsWith("?")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(c.scheme,c.userinfo,c.host,c.port,f,c.query,c.fragment)})();return _e(l,d)}else if(s.startsWith("#")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(c.scheme,c.userinfo,c.host,c.port,f,c.query,c.fragment)})();return se(l,d)}else{if(s==="")return new h((()=>{let l=o;return new x(l.scheme,l.userinfo,l.host,l.port,i,l.query,l.fragment)})());{let f=be(s)[1];e=i,t=f,r=o,n=u+1}}}}function Te(e,t){return No(e,e,t,0)}function ie(e,t,r){for(;;){let n=e,i=t,s=r;if(n.startsWith("0"))e=n.slice(1),t=i,r=s*10;else if(n.startsWith("1"))e=n.slice(1),t=i,r=s*10+1;else if(n.startsWith("2"))e=n.slice(1),t=i,r=s*10+2;else if(n.startsWith("3"))e=n.slice(1),t=i,r=s*10+3;else if(n.startsWith("4"))e=n.slice(1),t=i,r=s*10+4;else if(n.startsWith("5"))e=n.slice(1),t=i,r=s*10+5;else if(n.startsWith("6"))e=n.slice(1),t=i,r=s*10+6;else if(n.startsWith("7"))e=n.slice(1),t=i,r=s*10+7;else if(n.startsWith("8"))e=n.slice(1),t=i,r=s*10+8;else if(n.startsWith("9"))e=n.slice(1),t=i,r=s*10+9;else if(n.startsWith("?")){let o=n.slice(1),u=(()=>{let l=i;return new x(l.scheme,l.userinfo,l.host,new m(s),l.path,l.query,l.fragment)})();return _e(o,u)}else if(n.startsWith("#")){let o=n.slice(1),u=(()=>{let l=i;return new x(l.scheme,l.userinfo,l.host,new m(s),l.path,l.query,l.fragment)})();return se(o,u)}else if(n.startsWith("/")){let o=(()=>{let u=i;return new x(u.scheme,u.userinfo,u.host,new m(s),u.path,u.query,u.fragment)})();return Te(n,o)}else return n===""?new h((()=>{let o=i;return new x(o.scheme,o.userinfo,o.host,new m(s),o.path,o.query,o.fragment)})()):new _(void 0)}}function It(e,t){if(e.startsWith(":0")){let r=e.slice(2);return ie(r,t,0)}else if(e.startsWith(":1")){let r=e.slice(2);return ie(r,t,1)}else if(e.startsWith(":2")){let r=e.slice(2);return ie(r,t,2)}else if(e.startsWith(":3")){let r=e.slice(2);return ie(r,t,3)}else if(e.startsWith(":4")){let r=e.slice(2);return ie(r,t,4)}else if(e.startsWith(":5")){let r=e.slice(2);return ie(r,t,5)}else if(e.startsWith(":6")){let r=e.slice(2);return ie(r,t,6)}else if(e.startsWith(":7")){let r=e.slice(2);return ie(r,t,7)}else if(e.startsWith(":8")){let r=e.slice(2);return ie(r,t,8)}else if(e.startsWith(":9")){let r=e.slice(2);return ie(r,t,9)}else{if(e.startsWith(":"))return new _(void 0);if(e.startsWith("?")){let r=e.slice(1);return _e(r,t)}else if(e.startsWith("#")){let r=e.slice(1);return se(r,t)}else return e.startsWith("/")?Te(e,t):e===""?new h(t):new _(void 0)}}function Oi(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(s==="")return new h((()=>{let l=o;return new x(l.scheme,l.userinfo,new m(i),l.port,l.path,l.query,l.fragment)})());if(s.startsWith(":")){let l=z(i,0,u),f=(()=>{let d=o;return new x(d.scheme,d.userinfo,new m(l),d.port,d.path,d.query,d.fragment)})();return It(s,f)}else if(s.startsWith("/")){let l=z(i,0,u),f=(()=>{let d=o;return new x(d.scheme,d.userinfo,new m(l),d.port,d.path,d.query,d.fragment)})();return Te(s,f)}else if(s.startsWith("?")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(c.scheme,c.userinfo,new m(f),c.port,c.path,c.query,c.fragment)})();return _e(l,d)}else if(s.startsWith("#")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(c.scheme,c.userinfo,new m(f),c.port,c.path,c.query,c.fragment)})();return se(l,d)}else{let f=be(s)[1];e=i,t=f,r=o,n=u+1}}}function Io(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(s==="")return new h((()=>{let l=o;return new x(l.scheme,l.userinfo,new m(s),l.port,l.path,l.query,l.fragment)})());if(s.startsWith("]")&&u===0){let l=s.slice(1);return It(l,o)}else if(s.startsWith("]")){let l=s.slice(1),f=z(i,0,u+1),d=(()=>{let c=o;return new x(c.scheme,c.userinfo,new m(f),c.port,c.path,c.query,c.fragment)})();return It(l,d)}else{if(s.startsWith("/")&&u===0)return Te(s,o);if(s.startsWith("/")){let l=z(i,0,u),f=(()=>{let d=o;return new x(d.scheme,d.userinfo,new m(l),d.port,d.path,d.query,d.fragment)})();return Te(s,f)}else if(s.startsWith("?")&&u===0){let l=s.slice(1);return _e(l,o)}else if(s.startsWith("?")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(c.scheme,c.userinfo,new m(f),c.port,c.path,c.query,c.fragment)})();return _e(l,d)}else if(s.startsWith("#")&&u===0){let l=s.slice(1);return se(l,o)}else if(s.startsWith("#")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(c.scheme,c.userinfo,new m(f),c.port,c.path,c.query,c.fragment)})();return se(l,d)}else{let l=be(s),f=l[0],d=l[1];if(To(f))e=i,t=d,r=o,n=u+1;else return Oi(i,i,o,0)}}}}function Wo(e,t){return Io(e,e,t,0)}function Mo(e,t){return Oi(e,e,t,0)}function qe(e,t){if(e.startsWith("["))return Wo(e,t);if(e.startsWith(":")){let r=(()=>{let n=t;return new x(n.scheme,n.userinfo,new m(""),n.port,n.path,n.query,n.fragment)})();return It(e,r)}else return e===""?new h((()=>{let r=t;return new x(r.scheme,r.userinfo,new m(""),r.port,r.path,r.query,r.fragment)})()):Mo(e,t)}function Uo(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(s.startsWith("@")&&u===0){let l=s.slice(1);return qe(l,o)}else if(s.startsWith("@")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(c.scheme,new m(f),c.host,c.port,c.path,c.query,c.fragment)})();return qe(l,d)}else{if(s==="")return qe(i,o);if(s.startsWith("/"))return qe(i,o);if(s.startsWith("?"))return qe(i,o);if(s.startsWith("#"))return qe(i,o);{let f=be(s)[1];e=i,t=f,r=o,n=u+1}}}}function Po(e,t){return Uo(e,e,t,0)}function rn(e,t){if(e==="//")return new h((()=>{let r=t;return new x(r.scheme,r.userinfo,new m(""),r.port,r.path,r.query,r.fragment)})());if(e.startsWith("//")){let r=e.slice(2);return Po(r,t)}else return Te(e,t)}function Do(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(s.startsWith("/")&&u===0)return rn(s,o);if(s.startsWith("/")){let l=z(i,0,u),f=(()=>{let d=o;return new x(new m(I(l)),d.userinfo,d.host,d.port,d.path,d.query,d.fragment)})();return rn(s,f)}else if(s.startsWith("?")&&u===0){let l=s.slice(1);return _e(l,o)}else if(s.startsWith("?")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(new m(I(f)),c.userinfo,c.host,c.port,c.path,c.query,c.fragment)})();return _e(l,d)}else if(s.startsWith("#")&&u===0){let l=s.slice(1);return se(l,o)}else if(s.startsWith("#")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(new m(I(f)),c.userinfo,c.host,c.port,c.path,c.query,c.fragment)})();return se(l,d)}else{if(s.startsWith(":")&&u===0)return new _(void 0);if(s.startsWith(":")){let l=s.slice(1),f=z(i,0,u),d=(()=>{let c=o;return new x(new m(I(f)),c.userinfo,c.host,c.port,c.path,c.query,c.fragment)})();return rn(l,d)}else{if(s==="")return new h((()=>{let l=o;return new x(l.scheme,l.userinfo,l.host,l.port,i,l.query,l.fragment)})());{let f=be(s)[1];e=i,t=f,r=o,n=u+1}}}}}function Ro(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return L(n);{let i=r.head,s=r.tail,o=i===""||i==="."?n:i===".."&&n.hasLength(0)?a([]):i===".."&&n.atLeastLength(1)?n.tail:$(i,n);e=s,t=o}}}function Fo(e){return Ro(e,a([]))}function nn(e){return Fo(P(e,"/"))}function sn(e){let t=(()=>{let u=e.fragment;if(u instanceof m){let l=u[0];return a(["#",l])}else return a([])})(),r=(()=>{let u=e.query;if(u instanceof m){let l=u[0];return $("?",$(l,t))}else return t})(),n=$(e.path,r),i=(()=>{let u=e.host,l=ze(e.path,"/");if(u instanceof m&&!l&&u[0]!==""){let f=u[0];return $("/",n)}else return n})(),s=(()=>{let u=e.host,l=e.port;if(u instanceof m&&l instanceof m){let f=l[0];return $(":",$(J(f),i))}else return i})(),o=(()=>{let u=e.scheme,l=e.userinfo,f=e.host;if(u instanceof m&&l instanceof m&&f instanceof m){let d=u[0],c=l[0],g=f[0];return $(d,$("://",$(c,$("@",$(g,s)))))}else if(u instanceof m&&l instanceof w&&f instanceof m){let d=u[0],c=f[0];return $(d,$("://",$(c,s)))}else if(u instanceof m&&l instanceof m&&f instanceof w){let d=u[0];return $(d,$(":",s))}else if(u instanceof m&&l instanceof w&&f instanceof w){let d=u[0];return $(d,$(":",s))}else if(u instanceof w&&l instanceof w&&f instanceof m){let d=f[0];return $("//",$(d,s))}else return s})();return Tr(o)}var Ho=new x(new w,new w,new w,new w,"",new w,new w);function Wt(e){return Do(e,e,Ho,0)}function $e(e,t,r){return e?t:r()}function Li(e){try{let t=JSON.parse(e);return new h(t)}catch(t){return new _(Vo(t,e))}}function Vo(e,t){return Jo(e)?new Ut:Yo(e,t)}function Jo(e){return/((unexpected (end|eof))|(end of data)|(unterminated string)|(json( parse error|\.parse)\: expected '(\:|\}|\])'))/i.test(e.message)}function Yo(e,t){let r=[Ko,Xo,Qo,Zo];for(let n of r){let i=n(e,t);if(i)return i}return new we("",0)}function Ko(e){let r=/unexpected token '(.)', ".+" is not valid JSON/i.exec(e.message);if(!r)return null;let n=Mt(r[1]);return new we(n,-1)}function Xo(e){let r=/unexpected token (.) in JSON at position (\d+)/i.exec(e.message);if(!r)return null;let n=Mt(r[1]),i=Number(r[2]);return new we(n,i)}function Zo(e,t){let n=/(unexpected character|expected .*) at line (\d+) column (\d+)/i.exec(e.message);if(!n)return null;let i=Number(n[2]),s=Number(n[3]),o=el(i,s,t),u=Mt(t[o]);return new we(u,o)}function Qo(e){let r=/unexpected (identifier|token) "(.)"/i.exec(e.message);if(!r)return null;let n=Mt(r[2]);return new we(n,0)}function Mt(e){return"0x"+e.charCodeAt(0).toString(16).toUpperCase()}function el(e,t,r){if(e===1)return t-1;let n=1,i=0;return r.split("").find((s,o)=>(s===`
`&&(n+=1),n===e?(i=o+t,!0):!1)),i}var Ut=class extends p{},we=class extends p{constructor(t){super(),this[0]=t}};var ln=class extends p{constructor(t){super(),this[0]=t}};function rl(e,t){return K(Li(e),r=>{let n=tn(r,t);return Mr(n,i=>new ln(i))})}function vi(e,t){return rl(e,t)}var st=class extends p{constructor(t){super(),this.all=t}};function ji(e){return new st(a([t=>e(t.dispatch,t.emit,t.select,t.root)]))}function Pt(e){return ji((t,r,n,i)=>e(t))}function Oe(){return new st(a([]))}function an(e){return new st(ue(e,a([]),(t,r)=>{let n=r.all;return de(t,n)}))}var Ce=class extends p{constructor(t){super(),this.content=t}},A=class extends p{constructor(t,r,n,i,s,o,u){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=s,this.self_closing=o,this.void=u}},lt=class extends p{constructor(t){super(),this.subtree=t}},Ne=class extends p{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}};function ol(e){if(e instanceof Ne)return new _(void 0);{let t=e[0],r=e[1],n=Ze(t,2);return new h([n,r])}}function ll(e,t,r){return Ke(e,t,(n,i,s)=>{let o=r+"-"+J(s);return Ei(i,n,o)})}function Ei(e,t,r){for(;;){let n=e,i=t,s=r;if(n instanceof Ce)return i;if(n instanceof lt){let o=n.subtree;e=o(),t=i,r=s}else{let o=n.attrs,u=n.children,l=ue(o,i,(f,d)=>{let c=ol(d);if(c.isOk()){let g=c[0][0],E=c[0][1];return Y(f,s+"-"+g,E)}else return f});return ll(u,l,s)}}}function zi(e){return Ei(e,T(),"0")}function ut(e,t){return new Ne(e,t,!1)}function qi(e){return ut("style",ue(e,"",(t,r)=>{let n=r[0],i=r[1];return t+n+":"+i+";"}))}function Le(e){return ut("class",e)}function M(e){return ut("id",e)}function Dt(e){return ut("href",e)}function Rt(e){return ut("rel",e)}function ve(e,t,r){return e==="area"?new A("","",e,t,a([]),!1,!0):e==="base"?new A("","",e,t,a([]),!1,!0):e==="br"?new A("","",e,t,a([]),!1,!0):e==="col"?new A("","",e,t,a([]),!1,!0):e==="embed"?new A("","",e,t,a([]),!1,!0):e==="hr"?new A("","",e,t,a([]),!1,!0):e==="img"?new A("","",e,t,a([]),!1,!0):e==="input"?new A("","",e,t,a([]),!1,!0):e==="link"?new A("","",e,t,a([]),!1,!0):e==="meta"?new A("","",e,t,a([]),!1,!0):e==="param"?new A("","",e,t,a([]),!1,!0):e==="source"?new A("","",e,t,a([]),!1,!0):e==="track"?new A("","",e,t,a([]),!1,!0):e==="wbr"?new A("","",e,t,a([]),!1,!0):new A("","",e,t,r,!1,!1)}function Ci(e){return new Ce(e)}function cn(e){return ve("lustre-fragment",a([qi(a([["display","contents"]]))]),e)}var pn=class extends p{constructor(t){super(),this.dict=t}};function Ii(){return new pn(T())}var Ft=class extends p{constructor(t){super(),this[0]=t}},Ht=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},Gt=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}};function Wi(e){return y(e.created,T())&&y(e.removed,Ii())&&y(e.updated,T())}var Vt=class extends p{constructor(t){super(),this[0]=t}},Jt=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},at=class extends p{constructor(t){super(),this[0]=t}},oe=class extends p{constructor(t){super(),this[0]=t}},ft=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},Yt=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}};var ct=class extends p{},Kt=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},Xt=class extends p{constructor(t){super(),this[0]=t}},Zt=class extends p{constructor(t){super(),this[0]=t}};globalThis.customElements&&!globalThis.customElements.get("lustre-fragment")&&globalThis.customElements.define("lustre-fragment",class extends HTMLElement{constructor(){super()}});function dn(e,t,r){let n,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:s,next:o,parent:u}=i.pop();for(;o.subtree!==void 0;)o=o.subtree();if(o.content!==void 0)if(s)if(s.nodeType===Node.TEXT_NODE)s.textContent!==o.content&&(s.textContent=o.content),n??=s;else{let l=document.createTextNode(o.content);u.replaceChild(l,s),n??=l}else{let l=document.createTextNode(o.content);u.appendChild(l),n??=l}else if(o.tag!==void 0){let l=ml({prev:s,next:o,dispatch:r,stack:i});s?s!==l&&u.replaceChild(l,s):u.appendChild(l),n??=l}}return n}function ml({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),o=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),u;if(pt.has(o))u=pt.get(o);else{let b=new Map;pt.set(o,b),u=b}let l=s?new Set(u.keys()):null,f=s?new Set(Array.from(e.attributes,b=>b.name)):null,d=null,c=null,g=null;if(s&&t.tag==="textarea"){let b=t.children[Symbol.iterator]().next().value?.content;b!==void 0&&(o.value=b)}let E=[];for(let b of t.attrs){let k=b[0],q=b[1];if(b.as_property)o[k]!==q&&(o[k]=q),s&&f.delete(k);else if(k.startsWith("on")){let Z=k.slice(2),yr=r(q,Z==="input");u.has(Z)||o.addEventListener(Z,dt),u.set(Z,yr),s&&l.delete(Z)}else if(k.startsWith("data-lustre-on-")){let Z=k.slice(15),yr=r(hl);u.has(Z)||o.addEventListener(Z,dt),u.set(Z,yr),o.setAttribute(k,q),s&&(l.delete(Z),f.delete(k))}else k.startsWith("delegate:data-")||k.startsWith("delegate:aria-")?(o.setAttribute(k,q),E.push([k.slice(10),q])):k==="class"?d=d===null?q:d+" "+q:k==="style"?c=c===null?q:c+q:k==="dangerous-unescaped-html"?g=q:(o.getAttribute(k)!==q&&o.setAttribute(k,q),(k==="value"||k==="selected")&&(o[k]=q),s&&f.delete(k))}if(d!==null&&(o.setAttribute("class",d),s&&f.delete("class")),c!==null&&(o.setAttribute("style",c),s&&f.delete("style")),s){for(let b of f)o.removeAttribute(b);for(let b of l)u.delete(b),o.removeEventListener(b,dt)}if(t.tag==="slot"&&window.queueMicrotask(()=>{for(let b of o.assignedElements())for(let[k,q]of E)b.hasAttribute(k)||b.setAttribute(k,q)}),t.key!==void 0&&t.key!=="")o.setAttribute("data-lustre-key",t.key);else if(g!==null)return o.innerHTML=g,o;let B=o.firstChild,De=null,je=null,gt=null,gr=Qt(t).next().value;if(s&&gr!==void 0&&gr.key!==void 0&&gr.key!==""){De=new Set,je=Mi(e),gt=Mi(t);for(let b of Qt(t))B=_l(B,b,o,n,gt,je,De)}else for(let b of Qt(t))n.unshift({prev:B,next:b,parent:o}),B=B?.nextSibling;for(;B;){let b=B.nextSibling;o.removeChild(B),B=b}return o}var pt=new WeakMap;function dt(e){let t=e.currentTarget;if(!pt.has(t)){t.removeEventListener(e.type,dt);return}let r=pt.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,dt);return}r.get(e.type)(e)}function hl(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((s,o)=>{let u=o.split(".");for(let l=0,f=s,d=e;l<u.length;l++)l===u.length-1?f[u[l]]=d[u[l]]:(f[u[l]]??={},d=d[u[l]],f=f[u[l]]);return s},{data:n})}}function Mi(e){let t=new Map;if(e)for(let r of Qt(e)){let n=r?.key||r?.getAttribute?.("data-lustre-key");n&&t.set(n,r)}return t}function _l(e,t,r,n,i,s,o){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let l=e.nextSibling;r.removeChild(e),e=l}if(s.size===0)return n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e;if(o.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;o.add(t.key);let u=s.get(t.key);if(!u&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!u&&e!==null){let l=document.createTextNode("");return r.insertBefore(l,e),n.unshift({prev:l,next:t,parent:r}),e}return!u||u===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(u,e),n.unshift({prev:u,next:t,parent:r}),e)}function*Qt(e){for(let t of e.children)yield*Ui(t)}function*Ui(e){e.subtree!==void 0?yield*Ui(e.subtree()):yield e}var mn=class e{static start({init:t,update:r,view:n},i,s){if(!mt())return new _(new ht);let o=i instanceof HTMLElement?i:document.querySelector(i);if(!o)return new _(new er(i));let u=new e(o,t(s),r,n);return new h(l=>u.send(l))}constructor(t,[r,n],i,s){this.root=t,this.#e=r,this.#s=i,this.#r=s,this.#t=window.setTimeout(()=>this.#n(n.all.toArray(),!0),0)}root;send(t){if(t instanceof at){if(t[0]instanceof Zt){this.#t=window.clearTimeout(this.#t),this.#i=[],this.#e=t[0][0];let r=this.#r(this.#e),n=(s,o=!1)=>u=>{let l=s(u);l instanceof h&&this.send(new oe(l[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));dn(i,r,n)}}else if(t instanceof oe){let r=t[0],n=t[1]??!1;this.#i.push(r),n?(this.#t=window.clearTimeout(this.#t),this.#n()):this.#t||(this.#t=window.setTimeout(()=>this.#n()))}else if(t instanceof ft){let r=t[0],n=t[1];this.root.dispatchEvent(new CustomEvent(r,{detail:n,bubbles:!0,composed:!0}))}else if(t instanceof ct)for(this.#t=window.clearTimeout(this.#t),this.#e=null,this.#s=null,this.#r=null,this.#i=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#s;#r;#i=[];#t;#n(t=[]){this.#t=void 0,this.#o(t);let r=this.#r(this.#e),n=(s,o=!1)=>u=>{let l=s(u);l instanceof h&&this.send(new oe(l[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));dn(i,r,n)}#o(t=[]){for(;this.#i.length>0;){let r=this.#i.shift(),[n,i]=this.#s(this.#e,r);t=t.concat(i.all.toArray()),this.#e=n}for(;t.length>0;){let r=t.shift(),n=u=>this.send(new oe(u)),i=(u,l)=>this.root.dispatchEvent(new CustomEvent(u,{detail:l,bubbles:!0,composed:!0})),s=()=>{},o=this.root;r({dispatch:n,emit:i,select:s,root:o})}this.#i.length>0&&this.#o(t)}},Pi=mn.start;var hn=class e{static start({init:t,update:r,view:n,on_attribute_change:i},s){let o=new e(t(s),r,n,i);return new h(u=>o.send(u))}constructor([t,r],n,i,s){this.#e=t,this.#s=n,this.#i=i,this.#t=i(t),this.#u=s,this.#n=new Map,this.#o=zi(this.#t),this.#l(r.all.toArray())}send(t){if(t instanceof Vt){for(let r of t[0]){let n=this.#u.get(r[0]);if(!n)continue;let i=n(r[1]);i instanceof _||this.#r.push(i)}this.#l()}else if(t instanceof Jt)this.#r=this.#r.concat(t[0].toArray()),this.#l(t[1].all.toArray());else if(!(t instanceof at))if(t instanceof oe)this.#r.push(t[0]),this.#l();else if(t instanceof ft){let r=new Ht(t[0],t[1]);for(let[n,i]of this.#n)i(r)}else if(t instanceof Yt){let r=this.#o.get(t[0]);if(!r)return;let n=r(t[1]);if(n instanceof _)return;this.#r.push(n[0]),this.#l()}else if(t instanceof Kt){let r=Qr(this.#u),n=new Gt(r,this.#t);this.#n=this.#n.set(t[0],t[1]),t[1](n)}else t instanceof Xt&&(this.#n=this.#n.delete(t[0]))}#e;#s;#r;#i;#t;#n;#o;#u;#l(t=[]){this.#a(t);let r=this.#i(this.#e),n=elements(this.#t,r);if(!Wi(n)){let i=new Ft(n);for(let[s,o]of this.#n)o(i)}this.#t=r,this.#o=n.handlers}#a(t=[]){for(;this.#r.length>0;){let r=this.#r.shift(),[n,i]=this.#s(this.#e,r);t=t.concat(i.all.toArray()),this.#e=n}for(;t.length>0;)t.shift()({dispatch:u=>this.send(new oe(u)),emit:(u,l)=>this.root.dispatchEvent(new CustomEvent(u,{detail:l,bubbles:!0,composed:!0})),select:()=>{},root:null});this.#r.length>0&&this.#a(t)}},$l=hn.start,mt=()=>globalThis.window&&window.document;var _n=class extends p{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var er=class extends p{constructor(t){super(),this.selector=t}},ht=class extends p{};function Di(e,t,r){return new _n(e,t,r,new w)}function Ri(e,t,r){return $e(!mt(),new _(new ht),()=>Pi(e,t,r))}function le(e){return Ci(e)}function Hi(e,t){return ve("h3",e,t)}function R(e,t){return ve("div",e,t)}function Ie(e,t){return ve("p",e,t)}function tr(e,t){return ve("a",e,t)}var We=class extends p{},_t=class extends p{},rr=class extends p{},nr=class extends p{},ir=class extends p{},sr=class extends p{},or=class extends p{},lr=class extends p{},ur=class extends p{};var ar=class extends p{},$t=class extends p{};function Vi(e){return e instanceof or?"connect":e instanceof ir?"delete":e instanceof We?"get":e instanceof rr?"head":e instanceof lr?"options":e instanceof ur?"patch":e instanceof _t?"post":e instanceof nr?"put":e instanceof sr?"trace":e[0]}function Ji(e){return e instanceof ar?"http":"https"}function Yi(e){let t=I(e);return t==="http"?new h(new ar):t==="https"?new h(new $t):new _(void 0)}var wn=class extends p{constructor(t,r,n,i,s,o,u,l){super(),this.method=t,this.headers=r,this.body=n,this.scheme=i,this.host=s,this.port=o,this.path=u,this.query=l}};function Xi(e){return new x(new m(Ji(e.scheme)),new w,new m(e.host),e.port,e.path,e.query,new w)}function xn(e){return K((()=>{let t=e.scheme,r=Fn(t,"");return Yi(r)})(),t=>K((()=>{let r=e.host;return bt(r,void 0)})(),r=>{let n=new wn(new We,a([]),"",t,r,e.port,e.path,e.query);return new h(n)}))}function Zi(e){let r=Wt(e);return K(r,xn)}var ce=class extends p{constructor(t,r,n){super(),this.status=t,this.headers=r,this.body=n}};var Me=class e{constructor(t){this.promise=t}static wrap(t){return t instanceof Promise?new e(t):t}static unwrap(t){return t instanceof e?t.promise:t}};function fr(e){return Promise.resolve(Me.wrap(e))}function Qi(e,t){return e.then(r=>t(Me.unwrap(r)))}function cr(e,t){return e.then(r=>Me.wrap(t(Me.unwrap(r))))}function gn(e,t){return e.catch(r=>t(r))}function es(e,t){return cr(e,n=>(t(n),n))}function pr(e,t){return Qi(e,n=>{if(n.isOk()){let i=n[0];return t(i)}else{let i=n[0];return fr(new _(i))}})}async function rs(e){try{return new h(await fetch(e))}catch(t){return new _(new dr(t.toString()))}}function ns(e){return new ce(e.status,j.fromArray([...e.headers]),e)}function is(e){let t=sn(Xi(e)),r=Vi(e.method).toUpperCase(),n={headers:vl(e.headers),method:r};return r!=="GET"&&r!=="HEAD"&&(n.body=e.body),new globalThis.Request(t,n)}function vl(e){let t=new globalThis.Headers;for(let[r,n]of e)t.append(r.toLowerCase(),n);return t}async function yn(e){let t;try{t=await e.body.text()}catch{return new _(new mr)}return new h(e.withFields({body:t}))}var dr=class extends p{constructor(t){super(),this[0]=t}},mr=class extends p{};function ss(e){let r=is(e),n=rs(r);return pr(n,i=>fr(new h(ns(i))))}function os(){window.location.href}var bn=class extends p{constructor(t){super(),this[0]=t}},kn=class extends p{constructor(t){super(),this[0]=t}},On=class extends p{constructor(t){super(),this[0]=t}},hr=class extends p{},Ln=class extends p{},vn=class extends p{constructor(t,r){super(),this[0]=t,this[1]=r}},jn=class extends p{},Sn=class extends p{constructor(t){super(),this.run=t}};function Sl(e){return oi(Zi(e),t=>et((()=>{let r=os();return Wt(r)})(),r=>{let n=(()=>{let s=r;return new x(s.scheme,s.userinfo,s.host,s.port,s.path,new w,new w)})(),i=(()=>{if(e.startsWith("/")){let s=n;return new x(s.scheme,s.userinfo,s.host,s.port,e,s.query,s.fragment)}else{let s=n;return new x(s.scheme,s.userinfo,s.host,s.port,n.path+"/"+e,s.query,s.fragment)}})();return xn(i)}))}function Al(e,t,r){let n=ss(e),i=pr(n,yn),s=cr(i,u=>{if(u.isOk()){let l=u[0];return t.run(new h(l))}else return t.run(new _(new hr))}),o=gn(s,u=>t.run(new _(new hr)));es(o,r)}function An(e,t){return Pt(r=>{let n=Sl(e);if(n.isOk()){let i=n[0];return Al(i,t,r)}else return r(t.run(new _(new bn(e))))})}function El(e){if(e instanceof ce&&200<=e.status&&e.status<=299){let t=e.status,r=e.body;return new h(r)}else{if(e instanceof ce&&e.status===401)return new _(new jn);if(e instanceof ce&&e.status===404)return new _(new Ln);if(e instanceof ce&&e.status===500){let t=e.body;return new _(new kn(t))}else{let t=e.status,r=e.body;return new _(new vn(t,r))}}}function En(e,t){return new Sn(r=>{let i=K(r,El),s=K(i,o=>{let u=vi(o,e);if(u.isOk()){let l=u[0];return new h(l)}else{let l=u[0];return new _(new On(l))}});return t(s)})}var Bl={handle_external_links:!1,handle_internal_links:!0},ls=window?.location?.href,Bn=()=>ls?new h(zn(new URL(ls))):new _(void 0),qn=(e,t=Bl)=>{document.addEventListener("click",r=>{let n=us(r.target);if(n)try{let i=new URL(n.href),s=zn(i),o=i.host!==window.location.host;return!t.handle_external_links&&o||!t.handle_internal_links&&!o?void 0:(r.preventDefault(),o||(window.history.pushState({},"",n.href),window.requestAnimationFrame(()=>{i.hash&&document.getElementById(i.hash.slice(1))?.scrollIntoView()})),e(s))}catch{return}}),window.addEventListener("popstate",r=>{r.preventDefault();let n=new URL(window.location.href),i=zn(n);window.requestAnimationFrame(()=>{n.hash&&document.getElementById(n.hash.slice(1))?.scrollIntoView()}),e(i)}),window.addEventListener("modem-push",({detail:r})=>{e(r)}),window.addEventListener("modem-replace",({detail:r})=>{e(r)})};var us=e=>!e||e.tagName==="BODY"?null:e.tagName==="A"?e:us(e.parentElement),zn=e=>new x(e.protocol?new m(e.protocol.slice(0,-1)):new w,new w,e.hostname?new m(e.hostname):new w,e.port?new m(Number(e.port)):new w,e.pathname,e.search?new m(e.search.slice(1)):new w,e.hash?new m(e.hash.slice(1)):new w);function as(e){return Pt(t=>$e(!mt(),void 0,()=>qn(r=>{let i=e(r);return t(i)})))}var Tn=class extends p{constructor(t,r,n){super(),this.audit_name=t,this.audit_formatted_name=r,this.in_scope_files=n}};function fs(){return W("audit_name",V,e=>W("audit_formatted_name",V,t=>W("in_scope_files",Ct(V),r=>ke(new Tn(e,t,r)))))}var Cn=class extends p{constructor(t,r,n,i,s,o,u){super(),this.significance=t,this.line_number=r,this.line_number_text=n,this.line_tag=i,this.line_id=s,this.leading_spaces=o,this.elements=u}},Nn=class extends p{constructor(t){super(),this.topic_id=t}},In=class extends p{},_r=class extends p{};function Cl(){return W("type",V,e=>e==="single_declaration_line"?W("topic_id",V,t=>ke(new Nn(t))):e==="non_empty_line"?ke(new In):e==="empty_line"?ke(new _r):ki(new _r,"PreProcessedLineSignificance"))}function cs(){return W("significance",Cl(),e=>W("line_number",Tt,t=>W("line_number_text",V,r=>W("line_tag",V,n=>W("line_id",V,i=>W("leading_spaces",Tt,s=>W("elements",V,o=>ke(new Cn(e,t,r,n,i,s,o)))))))))}function ps(){return globalThis?.process?.platform==="win32"||globalThis?.Deno?.build?.os==="windows"}function Il(e){let t=(()=>{let r=P(e,"/");if(r.hasLength(1)&&r.head==="")return a([]);if(r.atLeastLength(1)&&r.head===""){let n=r.tail;return $("/",n)}else return r})();return Je(t,r=>r!=="")}function Wl(e){let t=qr(e,0,3),r=ei(t),n=O(r,Ir);if(n.hasLength(3)&&(n.tail.tail.head===47||n.tail.tail.head===92)&&n.tail.head===58&&(n.head>=65&&n.head<=90||n.head>=97&&n.head<=122)){let i=n.head,s=n.tail.head,o=n.tail.tail.head,u=qr(e,0,1),l=I(u)+":/",f=Ze(e,3);return[new m(l),f]}else return[new w,e]}function Ml(e){let t=Wl(e),r=t[0],n=t[1],i=(()=>{let o=P(n,"/");return Ye(o,u=>P(u,"\\"))})(),s=(()=>{if(r instanceof m){let o=r[0];return $(o,i)}else return i})();if(s.hasLength(1)&&s.head==="")return a([]);if(s.atLeastLength(1)&&s.head===""){let o=s.tail;return $("/",o)}else return s}function Ul(e){return ps()?Ml(e):Il(e)}function $r(e){return $e(e==="/","",()=>{let r=Ul(e),n=Xn(r);return X(n,"")})}function ms(e,t,r){let n=(()=>{let o=U(r,e);return X(o,[a([]),a([])])})(),i=n[0],s=n[1];return R(a([M(e)]),a([Ie(a([Le("tree-item")]),a([le($r(e))])),R(a([M(e+"-dirs"),Le("nested-tree-items")]),O(i,o=>ms(o,t,r))),R(a([M(e+"-files"),Le("nested-tree-items")]),O(s,o=>tr(a([Le("tree-item tree-link"+(o===t?" underline":"")),Dt("/"+o),Rt("prefetch")]),a([le($r(o))]))))]))}function Dl(e){let r=P(e,"/"),n=jr(r,Lr(P(e,"/"))-1),i=Ke(n,a([]),(s,o,u)=>{if(u===0)return $(o,s);{let l=(()=>{let f=vr(s);return X(f,"")})();return $(l+"/"+o,s)}});return L(i)}function ds(e){let r=(()=>{let s=Ye(e,Dl);return Sr(s)})(),n=O(r,i=>{let s=i+"/",o=Je(e,g=>ze(g,s)),u=Kn(o,g=>{let E=jt(g,s,"");return Nr(E,"/")}),l=u[0],f=u[1],d=(()=>{let g=O(l,E=>{let B=jt(E,s,""),De=(()=>{let je=P(B,"/"),gt=vr(je);return X(gt,"")})();return s+De});return Sr(g)})();return[i,[d,f]]});return Lt(n)}function Rl(e,t,r){let n=Yn(r,t)?ds(r):ds($(t,r)),i=(()=>{let l=U(n,e);return X(l,[a([]),a([])])})(),s=i[0],o=i[1],u=e+"/dashboard";return R(a([M("audit-files")]),a([R(a([M(e+"-files")]),$(tr(a([Le("tree-item tree-link"+(t===u?" underline":"")),Dt("/"+u),Rt("prefetch")]),a([le("dashboard")])),O(o,l=>tr(a([Le("tree-item tree-link"+(l===t?" underline":"")),Dt("/"+l),Rt("prefetch")]),a([le($r(l))]))))),R(a([M(e+"-dirs")]),O(s,l=>ms(l,t,n)))]))}function Wn(e,t,r,n,i){return R(a([M("tree-grid")]),a([R(a([M("file-tree")]),a([Hi(a([M("audit-tree-header")]),a([le(r+" files")])),Rl(r,n,i)])),R(a([M("tree-resizer")]),a([])),R(a([M("file-contents")]),a([e])),Rn(t)?R(a([M("panel-resizer")]),a([])):cn(a([])),(()=>{if(t instanceof m){let s=t[0];return R(a([M("side-panel")]),a([s]))}else return cn(a([]))})()]))}var Ue=class extends p{constructor(t,r,n){super(),this.route=t,this.audit_metadata=r,this.source_files=n}},wt=class extends p{},Pe=class extends p{constructor(t){super(),this.audit_name=t}},xt=class extends p{constructor(t,r){super(),this.audit_name=t,this.page_path=r}},wr=class extends p{constructor(t){super(),this.route=t}},xr=class extends p{constructor(t,r){super(),this.audit_name=t,this.metadata=r}},Mn=class extends p{constructor(t,r){super(),this.page_path=t,this.source_file=r}};function _s(e){let t=nn(e.path);if(t.hasLength(0))return new wt;if(t.hasLength(1)&&t.head==="dashboard")return new wt;if(t.hasLength(1)){let r=t.head;return new Pe(r)}else if(t.hasLength(2)&&t.tail.head==="dashboard"){let r=t.head;return new Pe(r)}else{let r=t.head;return new xt(r,e.path)}}function Hl(e){let t=_s(e);return new wr(t)}function hs(e,t){let r=U(e.audit_metadata,t);return r.isOk()&&r[0].isOk()?Oe():An("/audit-metadata/"+t,En(fs(),n=>new xr(t,n)))}function Gl(e,t){let r=U(e.source_files,t);return r.isOk()&&r[0].isOk()?Oe():An("/source-file/"+t,En(Ct(cs()),n=>new Mn(t,n)))}function $s(e,t){if(t instanceof Pe){let r=t.audit_name;return hs(e,r)}else if(t instanceof xt){let r=t.audit_name,n=t.page_path;return an(a([hs(e,r),Gl(e,n)]))}else return Oe()}function Vl(e){let t=new Ue((()=>{let r=Bn();if(r.isOk()){let n=r[0];return _s(n)}else return new wt})(),T(),T());return[t,an(a([as(Hl),$s(t,t.route)]))]}function Jl(e,t){if(t instanceof wr){let r=t.route;return[(()=>{let n=e;return new Ue(r,n.audit_metadata,n.source_files)})(),$s(e,r)]}else if(t instanceof xr){let r=t.audit_name,n=t.metadata;return[(()=>{let i=e;return new Ue(i.route,Y(e.audit_metadata,r,n),i.source_files)})(),Oe()]}else{let r=t.page_path,n=t.source_file;return[(()=>{let i=e;return new Ue(i.route,i.audit_metadata,Y(e.source_files,r,n))})(),Oe()]}}function Yl(e){let t=e.route;if(t instanceof Pe){let r=t.audit_name;return Wn(Ie(a([]),a([le("Dashboard")])),new w,r,r+"/dashboard",(()=>{let n=U(e.audit_metadata,r),i=ge(n,s=>s.isOk()?s[0].in_scope_files:a([]));return X(i,a([]))})())}else if(t instanceof xt){let r=t.audit_name,n=t.page_path;return Wn(Ie(a([]),a([le("Page")])),new w,r,n,(()=>{let i=U(e.audit_metadata,r),s=ge(i,o=>o.isOk()?o[0].in_scope_files:a([]));return X(s,a([]))})())}else return Ie(a([]),a([le("Home")]))}function ws(){Zr("Starting client controller");let e=Di(Vl,Jl,Yl);return Ri(e,"#app",void 0)}ws();
