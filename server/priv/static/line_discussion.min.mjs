var a=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},E=class{static fromArray(t,r){let n=r||new Zt;for(let i=t.length-1;i>=0;--i)n=new Ge(t[i],n);return n}[Symbol.iterator](){return new Wn(this)}toArray(){return[...this]}atLeastLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return r!==void 0}hasLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return t===-1&&r instanceof Zt}countLength(){let t=this,r=0;for(;t;)t=t.tail,r++;return r-1}};function $(e,t){return new Ge(e,t)}function u(e,t){return E.fromArray(e,t)}var Wn=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Zt)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},Zt=class extends E{},Ge=class extends E{constructor(t,r){super(),this.head=t,this.tail=r}},ce=class{bitSize;byteSize;bitOffset;rawBuffer;constructor(t,r,n){if(!(t instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=r??t.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=n??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(t.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=t}byteAt(t){if(!(t<0||t>=this.byteSize))return Gt(this.rawBuffer,this.bitOffset,t)}equals(t){if(this.bitSize!==t.bitSize)return!1;let r=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&t.bitOffset===0){for(let i=0;i<r;i++)if(this.rawBuffer[i]!==t.rawBuffer[i])return!1;let n=this.bitSize%8;if(n){let i=8-n;if(this.rawBuffer[r]>>i!==t.rawBuffer[r]>>i)return!1}}else{for(let i=0;i<r;i++){let s=Gt(this.rawBuffer,this.bitOffset,i),o=Gt(t.rawBuffer,t.bitOffset,i);if(s!==o)return!1}let n=this.bitSize%8;if(n){let i=Gt(this.rawBuffer,this.bitOffset,r),s=Gt(t.rawBuffer,t.bitOffset,r),o=8-n;if(i>>o!==s>>o)return!1}}return!0}get buffer(){if(ds("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(ds("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}};function Gt(e,t,r){if(t===0)return e[r]??0;{let n=e[r]<<t&255,i=e[r+1]>>8-t;return n|i}}var bt=class{constructor(t){this.value=t}},_s={};function ds(e,t){_s[e]||(console.warn(`Deprecated BitArray.${e} property used in JavaScript FFI code. ${t}.`),_s[e]=!0)}function Jn(e,t,r){if(r??=e.bitSize,hs(e,t,r),t===r)return new ce(new Uint8Array);if(t===0&&r===e.bitSize)return e;t+=e.bitOffset,r+=e.bitOffset;let n=Math.trunc(t/8),s=Math.trunc((r+7)/8)-n,o;return n===0&&s===e.rawBuffer.byteLength?o=e.rawBuffer:o=new Uint8Array(e.rawBuffer.buffer,e.rawBuffer.byteOffset+n,s),new ce(o,r-t,t%8)}function $s(e,t,r,n,i){if(hs(e,t,r),t===r)return 0;t+=e.bitOffset,r+=e.bitOffset;let s=t%8===0,o=r%8===0;if(s&&o)return Wu(e,t/8,r/8,n,i);let l=r-t,c=Math.trunc(t/8),p=Math.trunc((r-1)/8);if(c==p){let f=255>>t%8,d=(8-r%8)%8,h=(e.rawBuffer[c]&f)>>d;if(i){let m=2**(l-1);h>=m&&(h-=m*2)}return h}return l<=53?Yu(e.rawBuffer,t,r,n,i):Hu(e.rawBuffer,t,r,n,i)}function Wu(e,t,r,n,i){return r-t<=6?Ju(e.rawBuffer,t,r,n,i):Pu(e.rawBuffer,t,r,n,i)}function Ju(e,t,r,n,i){let s=r-t,o=0;if(n)for(let l=t;l<r;l++)o*=256,o+=e[l];else for(let l=r-1;l>=t;l--)o*=256,o+=e[l];if(i){let l=2**(s*8-1);o>=l&&(o-=l*2)}return o}function Pu(e,t,r,n,i){let s=r-t,o=0n;if(n)for(let l=t;l<r;l++)o*=256n,o+=BigInt(e[l]);else for(let l=r-1;l>=t;l--)o*=256n,o+=BigInt(e[l]);if(i){let l=1n<<BigInt(s*8-1);o>=l&&(o-=l*2n)}return Number(o)}function Yu(e,t,r,n,i){let s=t%8===0,o=r-t,l=Math.trunc(t/8),c=0;if(n){if(!s){let p=8-t%8;c=e[l++]&(1<<p)-1,o-=p}for(;o>=8;)c*=256,c+=e[l++],o-=8;o>0&&(c*=2**o,c+=e[l]>>8-o)}else if(s){let p=r-t,f=1;for(;p>=8;)c+=e[l++]*f,f*=256,p-=8;c+=(e[l]>>8-p)*f}else{let p=t%8,f=8-p,d=r-t,h=1;for(;d>=8;){let m=e[l]<<p|e[l+1]>>f;c+=(m&255)*h,h*=256,d-=8,l++}if(d>0){let m=d-Math.max(0,d-f),y=(e[l]&(1<<f)-1)>>f-m;d-=m,d>0&&(y*=2**d,y+=e[l+1]>>8-d),c+=y*h}}if(i){let p=2**(r-t-1);c>=p&&(c-=p*2)}return c}function Hu(e,t,r,n,i){let s=t%8===0,o=r-t,l=Math.trunc(t/8),c=0n;if(n){if(!s){let p=8-t%8;c=BigInt(e[l++]&(1<<p)-1),o-=p}for(;o>=8;)c*=256n,c+=BigInt(e[l++]),o-=8;o>0&&(c<<=BigInt(o),c+=BigInt(e[l]>>8-o))}else if(s){let p=r-t,f=0n;for(;p>=8;)c+=BigInt(e[l++])<<f,f+=8n,p-=8;c+=BigInt(e[l]>>8-p)<<f}else{let p=t%8,f=8-p,d=r-t,h=0n;for(;d>=8;){let m=e[l]<<p|e[l+1]>>f;c+=BigInt(m&255)<<h,h+=8n,d-=8,l++}if(d>0){let m=d-Math.max(0,d-f),y=(e[l]&(1<<f)-1)>>f-m;d-=m,d>0&&(y<<=d,y+=e[l+1]>>8-d),c+=BigInt(y)<<h}}if(i){let p=2n**BigInt(r-t-1);c>=p&&(c-=p*2n)}return Number(c)}function hs(e,t,r){if(t<0||t>e.bitSize||r<t||r>e.bitSize){let n=`Invalid bit array slice: start = ${t}, end = ${r}, bit size = ${e.bitSize}`;throw new globalThis.Error(n)}}var vt=class e extends a{static isResult(t){return t instanceof e}},x=class extends vt{constructor(t){super(),this[0]=t}isOk(){return!0}},g=class extends vt{constructor(t){super(),this[0]=t}isOk(){return!1}};function v(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!ms(n)||!ms(i)||!Xu(n,i)||Ru(n,i)||Gu(n,i)||Zu(n,i)||Vu(n,i)||Ku(n,i)||Qu(n,i))return!1;let o=Object.getPrototypeOf(n);if(o!==null&&typeof o.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[l,c]=Uu(n);for(let p of l(n))r.push(c(n,p),c(i,p))}return!0}function Uu(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function Ru(e,t){return e instanceof Date&&(e>t||e<t)}function Gu(e,t){return!(e instanceof ce)&&e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function Zu(e,t){return Array.isArray(e)&&e.length!==t.length}function Vu(e,t){return e instanceof Map&&e.size!==t.size}function Ku(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function Qu(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function ms(e){return typeof e=="object"&&e!==null}function Xu(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function Q(e,t){return t===0?0:e%t}function D(e,t){return Math.trunc(kt(e,t))}function kt(e,t){return t===0?0:e/t}function fe(e,t,r,n,i,s){let o=new globalThis.Error(i);o.gleam_error=e,o.module=t,o.line=r,o.function=n,o.fn=n;for(let l in s)o[l]=s[l];return o}var w=class extends a{constructor(t){super(),this[0]=t}},b=class extends a{};function Ze(e){return!v(e,new b)}function xs(e,t){if(e instanceof w){let r=e[0];return new x(r)}else return new g(t)}function Ar(e,t){return e instanceof w?e[0]:t}function Mr(e,t){if(e instanceof w){let r=e[0];return new w(t(r))}else return new b}function ws(e){return e instanceof w?e[0]:new b}var gs=new WeakMap,Pn=new DataView(new ArrayBuffer(8)),Yn=0;function Hn(e){let t=gs.get(e);if(t!==void 0)return t;let r=Yn++;return Yn===2147483647&&(Yn=0),gs.set(e,r),r}function Un(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Gn(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function bs(e){Pn.setFloat64(0,e);let t=Pn.getInt32(0),r=Pn.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function el(e){return Gn(e.toString())}function tl(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return Hn(e);if(e instanceof Date)return bs(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+ne(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+ne(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+Un(ne(n),ne(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];r=r+Un(ne(o),Gn(s))|0}}return r}function ne(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return bs(e);case"string":return Gn(e);case"bigint":return el(e);case"object":return tl(e);case"symbol":return Hn(e);case"function":return Hn(e);default:return 0}}var ve=5,Zn=Math.pow(2,ve),rl=Zn-1,nl=Zn/2,il=Zn/4,R=0,be=1,X=2,Ve=3,Vn={type:X,bitmap:0,array:[]};function Vt(e,t){return e>>>t&rl}function Tr(e,t){return 1<<Vt(e,t)}function sl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Kn(e,t){return sl(e&t-1)}function ie(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function ol(e,t,r){let n=e.length,i=new Array(n+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=r;s<n;)i[o++]=e[s++];return i}function Rn(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function vs(e,t,r,n,i,s){let o=ne(t);if(o===n)return{type:Ve,hash:o,array:[{type:R,k:t,v:r},{type:R,k:i,v:s}]};let l={val:!1};return Kt(Qn(Vn,e,o,t,r,l),e,n,i,s,l)}function Kt(e,t,r,n,i,s){switch(e.type){case be:return ul(e,t,r,n,i,s);case X:return Qn(e,t,r,n,i,s);case Ve:return ll(e,t,r,n,i,s)}}function ul(e,t,r,n,i,s){let o=Vt(r,t),l=e.array[o];if(l===void 0)return s.val=!0,{type:be,size:e.size+1,array:ie(e.array,o,{type:R,k:n,v:i})};if(l.type===R)return v(n,l.k)?i===l.v?e:{type:be,size:e.size,array:ie(e.array,o,{type:R,k:n,v:i})}:(s.val=!0,{type:be,size:e.size,array:ie(e.array,o,vs(t+ve,l.k,l.v,r,n,i))});let c=Kt(l,t+ve,r,n,i,s);return c===l?e:{type:be,size:e.size,array:ie(e.array,o,c)}}function Qn(e,t,r,n,i,s){let o=Tr(r,t),l=Kn(e.bitmap,o);if(e.bitmap&o){let c=e.array[l];if(c.type!==R){let f=Kt(c,t+ve,r,n,i,s);return f===c?e:{type:X,bitmap:e.bitmap,array:ie(e.array,l,f)}}let p=c.k;return v(n,p)?i===c.v?e:{type:X,bitmap:e.bitmap,array:ie(e.array,l,{type:R,k:n,v:i})}:(s.val=!0,{type:X,bitmap:e.bitmap,array:ie(e.array,l,vs(t+ve,p,c.v,r,n,i))})}else{let c=e.array.length;if(c>=nl){let p=new Array(32),f=Vt(r,t);p[f]=Qn(Vn,t+ve,r,n,i,s);let d=0,h=e.bitmap;for(let m=0;m<32;m++){if(h&1){let y=e.array[d++];p[m]=y}h=h>>>1}return{type:be,size:c+1,array:p}}else{let p=ol(e.array,l,{type:R,k:n,v:i});return s.val=!0,{type:X,bitmap:e.bitmap|o,array:p}}}}function ll(e,t,r,n,i,s){if(r===e.hash){let o=Xn(e,n);if(o!==-1)return e.array[o].v===i?e:{type:Ve,hash:r,array:ie(e.array,o,{type:R,k:n,v:i})};let l=e.array.length;return s.val=!0,{type:Ve,hash:r,array:ie(e.array,l,{type:R,k:n,v:i})}}return Kt({type:X,bitmap:Tr(e.hash,t),array:[e]},t,r,n,i,s)}function Xn(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(v(t,e.array[n].k))return n;return-1}function Er(e,t,r,n){switch(e.type){case be:return al(e,t,r,n);case X:return cl(e,t,r,n);case Ve:return fl(e,n)}}function al(e,t,r,n){let i=Vt(r,t),s=e.array[i];if(s!==void 0){if(s.type!==R)return Er(s,t+ve,r,n);if(v(n,s.k))return s}}function cl(e,t,r,n){let i=Tr(r,t);if(!(e.bitmap&i))return;let s=Kn(e.bitmap,i),o=e.array[s];if(o.type!==R)return Er(o,t+ve,r,n);if(v(n,o.k))return o}function fl(e,t){let r=Xn(e,t);if(!(r<0))return e.array[r]}function ei(e,t,r,n){switch(e.type){case be:return pl(e,t,r,n);case X:return _l(e,t,r,n);case Ve:return dl(e,n)}}function pl(e,t,r,n){let i=Vt(r,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===R){if(!v(s.k,n))return e}else if(o=ei(s,t+ve,r,n),o===s)return e;if(o===void 0){if(e.size<=il){let l=e.array,c=new Array(e.size-1),p=0,f=0,d=0;for(;p<i;){let h=l[p];h!==void 0&&(c[f]=h,d|=1<<p,++f),++p}for(++p;p<l.length;){let h=l[p];h!==void 0&&(c[f]=h,d|=1<<p,++f),++p}return{type:X,bitmap:d,array:c}}return{type:be,size:e.size-1,array:ie(e.array,i,o)}}return{type:be,size:e.size,array:ie(e.array,i,o)}}function _l(e,t,r,n){let i=Tr(r,t);if(!(e.bitmap&i))return e;let s=Kn(e.bitmap,i),o=e.array[s];if(o.type!==R){let l=ei(o,t+ve,r,n);return l===o?e:l!==void 0?{type:X,bitmap:e.bitmap,array:ie(e.array,s,l)}:e.bitmap===i?void 0:{type:X,bitmap:e.bitmap^i,array:Rn(e.array,s)}}return v(n,o.k)?e.bitmap===i?void 0:{type:X,bitmap:e.bitmap^i,array:Rn(e.array,s)}:e}function dl(e,t){let r=Xn(e,t);if(r<0)return e;if(e.array.length!==1)return{type:Ve,hash:e.hash,array:Rn(e.array,r)}}function ks(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===R){t(s.v,s.k);continue}ks(s,t)}}}var se=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=Er(this.root,0,ne(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?Vn:this.root,s=Kt(i,0,ne(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=ei(this.root,0,ne(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:Er(this.root,0,ne(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){ks(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+Un(ne(r),ne(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;try{return this.forEach((r,n)=>{if(!v(t.get(n,!r),r))throw ys}),!0}catch(r){if(r===ys)return!1;throw r}}},ys=Symbol();var Ss=void 0,Os={};function I(e){return e.toString()}function Br(e){let t=e.toString().replace("+","");if(t.indexOf(".")>=0)return t;{let r=t.indexOf("e");return r>=0?t.slice(0,r)+".0"+t.slice(r):t+".0"}}var Ls;function hl(e){if(globalThis.Intl&&Intl.Segmenter)return Ls||=new Intl.Segmenter,Ls.segment(e)[Symbol.iterator]()}function As(e){let t,r=hl(e);return r?t=r.next().value?.segment:t=e.match(/./su)?.[0],t?new x([t,e.slice(t.length)]):new g(Ss)}function De(e){let t="";for(let r of e)t=t+r;return t}var Ms=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),xl=new RegExp(`^[${Ms}]*`),wl=new RegExp(`[${Ms}]*$`);function Es(e){return e.replace(xl,"")}function Ts(e){return e.replace(wl,"")}function ti(e){console.log(e)}function Qt(e){return Math.floor(e)}function ri(e){return Math.round(e)}function Xt(){let e=Math.random();return e===1?Xt():e}function V(){return se.new()}function Ir(e){return E.fromArray(e.entries())}function Bs(e,t){return t.delete(e)}function oe(e,t){let r=e.get(t,Os);return r===Os?new g(Ss):new x(r)}function Is(e,t,r){return r.set(e,t)}function ue(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof vt)return"Result";if(e instanceof E)return"List";if(e instanceof ce)return"BitArray";if(e instanceof se)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function ni(e,t){return gl(e,ue(t))}function gl(e,t){return new g(E.fromArray([new Y(e,t,E.fromArray([]))]))}function ii(e){return typeof e=="string"?new x(e):ni("String",e)}function qs(e){return Number.isInteger(e)?new x(e):ni("Int",e)}function zs(e,t){let r=()=>ni("Dict",e);if(e instanceof se||e instanceof WeakMap||e instanceof Map){let n=oe(e,t);return new x(n.isOk()?new w(n[0]):new b)}else return e===null?r():Object.getPrototypeOf(e)==Object.prototype?js(e,t,()=>new x(new b)):js(e,t,r)}function js(e,t,r){try{return t in e?new x(new w(e[t])):r()}catch{return r()}}function ke(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return yl(e);if(t==="bigint"||Number.isInteger(e))return e.toString();if(t==="number")return Br(e);if(Array.isArray(e))return`#(${e.map(ke).join(", ")})`;if(e instanceof E)return Ol(e);if(e instanceof bt)return jl(e);if(e instanceof ce)return Ll(e);if(e instanceof a)return kl(e);if(e instanceof se)return bl(e);if(e instanceof Set)return`//js(Set(${[...e].map(ke).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return vl(e)}function yl(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];switch(n){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}}return t+='"',t}function bl(e){let t="dict.from_list([",r=!0;return e.forEach((n,i)=>{r||(t=t+", "),t=t+"#("+ke(i)+", "+ke(n)+")",r=!1}),t+"])"}function vl(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let s of Object.keys(e))r.push(`${ke(s)}: ${ke(e[s])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function kl(e){let t=Object.keys(e).map(r=>{let n=ke(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function Ol(e){return`[${e.toArray().map(ke).join(", ")}]`}function Ll(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function jl(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function Ml(e){return-1*e}function qr(e){return e>=0?ri(e):0-ri(Ml(e))}function si(e){let t=Xt()*e,r=Qt(t);return qr(r)}function Oe(e,t,r){return Is(t,r,e)}function Tl(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head[0],s=r.head[1];e=r.tail,t=Oe(n,i,s)}}}function Dr(e){return Tl(e,V())}function Bl(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function Il(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return Bl(n,u([]));{let i=r.head[0];e=r.tail,t=$(i,n)}}}function oi(e){return Il(Ir(e),u([]))}function ui(e,t){return Bs(t,e)}function zl(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1))e=r.tail,t=n+1;else return n}}function li(e){return zl(e,0)}function Dl(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function C(e){return Dl(e,u([]))}function Ds(e){if(e.hasLength(0))return new g(void 0);{let t=e.head;return new x(t)}}function Cl(e){return(t,r)=>{let n=oe(t,e(r));if(n.isOk()){let i=n[0];return Oe(t,e(r),$(r,i))}else return Oe(t,e(r),u([r]))}}function Nl(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return C(s);{let o=n.head,l=n.tail,c=(()=>{let p=i(o);if(p.isOk()){let f=p[0];return $(f,s)}else return s})();e=l,t=i,r=c}}}function tr(e,t){return Nl(e,t,u([]))}function Fl(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return C(s);{let o=n.head;e=n.tail,t=i,r=$(i(o),s)}}}function G(e,t){return Fl(e,t,u([]))}function Wl(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function Lt(e,t){return Wl(C(e),t)}function le(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let o=n.head;e=n.tail,t=s(i,o),r=s}}}function Cs(e,t){return le(e,V(),Cl(t))}function Jl(e,t,r,n){for(;;){let i=e,s=t,o=r,l=n;if(i.hasLength(0))return s;{let c=i.head;e=i.tail,t=o(s,c,l),r=o,n=l+1}}}function Nr(e,t,r){return Jl(e,t,r,0)}function fi(e){let r=Es(e);return Ts(r)}function Fr(e,t){for(;;){let r=e,n=t;if(n>0){let s=As(r);if(s.isOk())e=s[0][1],t=n-1;else return r}else return r}}function Ne(e){let t=ke(e);return t}function Ps(e){return!!e.isOk()}function pe(e,t){if(e.isOk()){let r=e[0];return new x(t(r))}else{let r=e[0];return new g(r)}}function Te(e,t){if(e.isOk()){let r=e[0];return new x(r)}else{let r=e[0];return new g(t(r))}}function H(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new g(r)}}function pi(e,t){return H(e,t)}function St(e,t){return e.isOk()?e[0]:t}function Be(e,t){if(e.isOk()){let r=e[0];return new x(r)}else return new g(t)}var Y=class extends a{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};function ra(e,t){return Te(e,r=>G(r,t))}function Ys(e){return ii(e)}function Hs(e){return t=>{if(e.hasLength(0))return new g(u([new Y("another type",ue(t),u([]))]));{let r=e.head,n=e.tail,i=r(t);if(i.isOk()){let s=i[0];return new x(s)}else return Hs(n)(t)}}}function na(e,t){let r=t,n=Hs(u([ii,o=>pe(qs(o),I)])),i=(()=>{let o=n(r);if(o.isOk())return o[0];{let l=u(["<",ue(r),">"]),c=De(l);return c}})(),s=e;return new Y(s.expected,s.found,$(i,e.path))}function _i(e,t){return r=>{let n=new Y("field","nothing",u([]));return H(zs(r,e),i=>{let o=xs(i,u([n])),l=H(o,t);return ra(l,c=>na(c,e))})}}function Us(e,t){let r=Number.isInteger(t);if(e instanceof se||e instanceof WeakMap||e instanceof Map){let n={},i=e.get(t,n);return i===n?new x(new b):new x(new w(i))}if(Number.isInteger(t)&&t<8&&e instanceof E){let n=0;for(let i of e){if(n===t)return new x(new w(i));n++}return new g("Indexable")}return r&&Array.isArray(e)||e&&typeof e=="object"||e&&Object.getPrototypeOf(e)===Object.prototype?t in e?new x(new w(e[t])):new x(new b):new g(r?"Indexable":"Dict")}function Rs(e,t,r,n,i){if(!(e instanceof E||Array.isArray(e))){let o=new _e("List",ue(e),i);return[i,E.fromArray([o])]}let s=[];for(let o of e){let l=t(o),[c,p]=l;if(p instanceof Ge){let[f,d]=r(l,n.toString());return[i,d]}s.push(c),n++}return[E.fromArray(s),i]}function Gs(e){return Number.isInteger(e)?new x(e):new g(0)}function Zs(e){return typeof e=="string"?new x(e):new g(0)}function Vs(e){return e==null}var _e=class extends a{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}},de=class extends a{constructor(t){super(),this.function=t}};function ae(e,t){let r=t.function(e),n=r[0],i=r[1];return i.hasLength(0)?new x(n):new g(i)}function Fe(e){return new de(t=>[e,u([])])}function ia(e,t){return new de(r=>{let n=e.function(r),i=n[0],s=n[1];return[t(i),s]})}function sa(e,t,r){for(;;){let n=e,i=t,s=r;if(s.hasLength(0))return i;{let o=s.head,l=s.tail,c=o.function(n),p=c;if(c[1].hasLength(0))return p;e=n,t=i,r=l}}}function oa(e,t){return new de(r=>{let n=e.function(r),i=n;return n[1].hasLength(0)?i:sa(r,i,t)})}function rr(e){return new de(t=>{if(Vs(t))return[new b,u([])];{let n=e.function(t),i=n[0],s=n[1];return[new w(i),s]}})}function ua(e,t){return u([new _e(e,ue(t),u([]))])}function Ks(e,t,r){let n=r(e);return n.isOk()?[n[0],u([])]:[n[0],u([new _e(t,ue(e),u([]))])]}function la(e){return v(!0,e)?[!0,u([])]:v(!1,e)?[!1,u([])]:[!1,ua("Bool",e)]}function aa(e){return Ks(e,"Int",Gs)}var At=new de(la),We=new de(aa);function ca(e){return Ks(e,"String",Zs)}var T=new de(ca);function Qs(e){return new de(t=>Rs(t,e.function,(r,n)=>Wr(r,u([n])),0,u([])))}function Wr(e,t){let r=oa(T,u([ia(We,I)])),n=G(t,s=>{let o=s,l=ae(o,r);return l.isOk()?l[0]:"<"+ue(o)+">"}),i=G(e[1],s=>{let o=s;return new _e(o.expected,o.found,Lt(n,s.path))});return[e[0],i]}function fa(e,t,r,n,i){for(;;){let s=e,o=t,l=r,c=n,p=i;if(s.hasLength(0)){let f=l(c);return Wr(f,C(o))}else{let f=s.head,d=s.tail,h=Us(c,f);if(h.isOk()&&h[0]instanceof w){let m=h[0][0];e=d,t=$(f,o),r=l,n=m,i=p}else{if(h.isOk()&&h[0]instanceof b)return p(c,$(f,o));{let m=h[0],re=[l(c)[0],u([new _e(m,ue(c),u([]))])];return Wr(re,C(o))}}}}}function Xs(e,t,r){return new de(n=>{let i=fa(e,u([]),t.function,n,(f,d)=>{let y=[t.function(f)[0],u([new _e("Field","Nothing",u([]))])];return Wr(y,C(d))}),s=i[0],o=i[1],l=r(s).function(n),c=l[0],p=l[1];return[c,Lt(o,p)]})}function A(e,t,r){return Xs(u([e]),t,r)}function mi(e,t,r){return e?t():r()}function eo(e){return Object.fromEntries(e)}function to(){return null}function ro(e){try{let t=JSON.parse(e);return new x(t)}catch(t){return new g(_a(t,e))}}function _a(e,t){return da(e)?new Pr:ma(e,t)}function da(e){return/((unexpected (end|eof))|(end of data)|(unterminated string)|(json( parse error|\.parse)\: expected '(\:|\}|\])'))/i.test(e.message)}function ma(e,t){let r=[$a,ha,wa,xa];for(let n of r){let i=n(e,t);if(i)return i}return new Je("",0)}function $a(e){let r=/unexpected token '(.)', ".+" is not valid JSON/i.exec(e.message);if(!r)return null;let n=Jr(r[1]);return new Je(n,-1)}function ha(e){let r=/unexpected token (.) in JSON at position (\d+)/i.exec(e.message);if(!r)return null;let n=Jr(r[1]),i=Number(r[2]);return new Je(n,i)}function xa(e,t){let n=/(unexpected character|expected .*) at line (\d+) column (\d+)/i.exec(e.message);if(!n)return null;let i=Number(n[2]),s=Number(n[3]),o=ga(i,s,t),l=Jr(t[o]);return new Je(l,o)}function wa(e){let r=/unexpected (identifier|token) "(.)"/i.exec(e.message);if(!r)return null;let n=Jr(r[2]);return new Je(n,0)}function Jr(e){return"0x"+e.charCodeAt(0).toString(16).toUpperCase()}function ga(e,t,r){if(e===1)return t-1;let n=1,i=0;return r.split("").find((s,o)=>(s===`
`&&(n+=1),n===e?(i=o+t,!0):!1)),i}var Pr=class extends a{},Je=class extends a{constructor(t){super(),this[0]=t}};var hi=class extends a{constructor(t){super(),this[0]=t}};function ba(e,t){return pi(ro(e),r=>{let n=ae(r,t);return Te(n,i=>new hi(i))})}function Yr(e,t){return ba(e,t)}function me(e){return e}function q(e){return e}function no(){return to()}function io(e,t){if(e instanceof w){let r=e[0];return t(r)}else return no()}function $e(e){return eo(e)}var Hr=class extends a{constructor(t){super(),this.all=t}};function wi(e){return new Hr(u([t=>e(t.dispatch,t.emit,t.select,t.root)]))}function so(e){return wi((t,r,n,i)=>e(t))}function oo(e,t){return wi((r,n,i,s)=>n(e,t))}function F(){return new Hr(u([]))}var Mt=class extends a{constructor(t){super(),this.content=t}},M=class extends a{constructor(t,r,n,i,s,o,l){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=s,this.self_closing=o,this.void=l}},ir=class extends a{constructor(t){super(),this.subtree=t}},Et=class extends a{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}},sr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};function ja(e){if(e instanceof Et)return new g(void 0);{let t=e[0],r=e[1],n=Fr(t,2);return new x([n,r])}}function Sa(e,t,r){return Nr(e,t,(n,i,s)=>{let o=r+"-"+I(s);return uo(i,n,o)})}function uo(e,t,r){for(;;){let n=e,i=t,s=r;if(n instanceof Mt)return i;if(n instanceof ir){let o=n.subtree;e=o(),t=i,r=s}else{let o=n.attrs,l=n.children,c=le(o,i,(p,f)=>{let d=ja(f);if(d.isOk()){let h=d[0][0],m=d[0][1];return Oe(p,s+"-"+h,m)}else return p});return Sa(l,c,s)}}}function lo(e){return uo(e,V(),"0")}function _(e,t){return new Et(e,t,!1)}function co(e,t){return new sr("on"+e,t)}function fo(e){return _("style",le(e,"",(t,r)=>{let n=r[0],i=r[1];return t+n+":"+i+";"}))}function k(e){return _("class",e)}function he(e){return _("id",e)}function po(e){return _("value",e)}function gi(e){return _("placeholder",e)}function yi(e){return _("href",e)}function xe(e,t,r){return e==="area"?new M("","",e,t,u([]),!1,!0):e==="base"?new M("","",e,t,u([]),!1,!0):e==="br"?new M("","",e,t,u([]),!1,!0):e==="col"?new M("","",e,t,u([]),!1,!0):e==="embed"?new M("","",e,t,u([]),!1,!0):e==="hr"?new M("","",e,t,u([]),!1,!0):e==="img"?new M("","",e,t,u([]),!1,!0):e==="input"?new M("","",e,t,u([]),!1,!0):e==="link"?new M("","",e,t,u([]),!1,!0):e==="meta"?new M("","",e,t,u([]),!1,!0):e==="param"?new M("","",e,t,u([]),!1,!0):e==="source"?new M("","",e,t,u([]),!1,!0):e==="track"?new M("","",e,t,u([]),!1,!0):e==="wbr"?new M("","",e,t,u([]),!1,!0):new M("","",e,t,r,!1,!1)}function Tt(e,t,r,n){return new M("",e,t,r,n,!1,!1)}function or(e){return new Mt(e)}function we(e){return xe("lustre-fragment",u([fo(u([["display","contents"]]))]),e)}var ur=class extends a{constructor(t){super(),this.dict=t}};function Rr(){return new ur(V())}function ki(e,t){let r=e.dict,n=oe(r,t);return Ps(n)}function _o(e,t){return new ur(ui(e.dict,t))}var Aa=void 0;function Oi(e,t){return new ur(Oe(e.dict,t,Aa))}var Gr=class extends a{constructor(t){super(),this[0]=t}},Zr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Vr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};function ho(e){return v(e.created,V())&&v(e.removed,Rr())&&v(e.updated,V())}var Kr=class extends a{constructor(t){super(),this[0]=t}},Qr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Bt=class extends a{constructor(t){super(),this[0]=t}},K=class extends a{constructor(t){super(),this[0]=t}},It=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Xr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};var ar=class extends a{},en=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},tn=class extends a{constructor(t){super(),this[0]=t}},cr=class extends a{constructor(t){super(),this[0]=t}};var Li=class extends a{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var rn=class extends a{constructor(t){super(),this.name=t}},nn=class extends a{constructor(t){super(),this.name=t}},sn=class extends a{constructor(t){super(),this.selector=t}},fr=class extends a{};function xo(e,t,r,n){return new Li(e,t,r,new w(n))}globalThis.customElements&&!globalThis.customElements.get("lustre-fragment")&&globalThis.customElements.define("lustre-fragment",class extends HTMLElement{constructor(){super()}});function dr(e,t,r){let n,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:s,next:o,parent:l}=i.pop();for(;o.subtree!==void 0;)o=o.subtree();if(o.content!==void 0)if(s)if(s.nodeType===Node.TEXT_NODE)s.textContent!==o.content&&(s.textContent=o.content),n??=s;else{let c=document.createTextNode(o.content);l.replaceChild(c,s),n??=c}else{let c=document.createTextNode(o.content);l.appendChild(c),n??=c}else if(o.tag!==void 0){let c=za({prev:s,next:o,dispatch:r,stack:i});s?s!==c&&l.replaceChild(c,s):l.appendChild(c),n??=c}}return n}function za({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),o=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),l;if(pr.has(o))l=pr.get(o);else{let O=new Map;pr.set(o,O),l=O}let c=s?new Set(l.keys()):null,p=s?new Set(Array.from(e.attributes,O=>O.name)):null,f=null,d=null,h=null;if(s&&t.tag==="textarea"){let O=t.children[Symbol.iterator]().next().value?.content;O!==void 0&&(o.value=O)}let m=[];for(let O of t.attrs){let L=O[0],P=O[1];if(O.as_property)o[L]!==P&&(o[L]=P),s&&p.delete(L);else if(L.startsWith("on")){let ye=L.slice(2),Fn=r(P,ye==="input");l.has(ye)||o.addEventListener(ye,_r),l.set(ye,Fn),s&&c.delete(ye)}else if(L.startsWith("data-lustre-on-")){let ye=L.slice(15),Fn=r(Da);l.has(ye)||o.addEventListener(ye,_r),l.set(ye,Fn),o.setAttribute(L,P),s&&(c.delete(ye),p.delete(L))}else L.startsWith("delegate:data-")||L.startsWith("delegate:aria-")?(o.setAttribute(L,P),m.push([L.slice(10),P])):L==="class"?f=f===null?P:f+" "+P:L==="style"?d=d===null?P:d+P:L==="dangerous-unescaped-html"?h=P:(o.getAttribute(L)!==P&&o.setAttribute(L,P),(L==="value"||L==="selected")&&(o[L]=P),s&&p.delete(L))}if(f!==null&&(o.setAttribute("class",f),s&&p.delete("class")),d!==null&&(o.setAttribute("style",d),s&&p.delete("style")),s){for(let O of p)o.removeAttribute(O);for(let O of c)l.delete(O),o.removeEventListener(O,_r)}if(t.tag==="slot"&&window.queueMicrotask(()=>{for(let O of o.assignedElements())for(let[L,P]of m)O.hasAttribute(L)||O.setAttribute(L,P)}),t.key!==void 0&&t.key!=="")o.setAttribute("data-lustre-key",t.key);else if(h!==null)return o.innerHTML=h,o;let y=o.firstChild,J=null,re=null,ge=null,Nn=on(t).next().value;if(s&&Nn!==void 0&&Nn.key!==void 0&&Nn.key!==""){J=new Set,re=wo(e),ge=wo(t);for(let O of on(t))y=Ca(y,O,o,n,ge,re,J)}else for(let O of on(t))n.unshift({prev:y,next:O,parent:o}),y=y?.nextSibling;for(;y;){let O=y.nextSibling;o.removeChild(y),y=O}return o}var pr=new WeakMap;function _r(e){let t=e.currentTarget;if(!pr.has(t)){t.removeEventListener(e.type,_r);return}let r=pr.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,_r);return}r.get(e.type)(e)}function Da(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((s,o)=>{let l=o.split(".");for(let c=0,p=s,f=e;c<l.length;c++)c===l.length-1?p[l[c]]=f[l[c]]:(p[l[c]]??={},f=f[l[c]],p=p[l[c]]);return s},{data:n})}}function wo(e){let t=new Map;if(e)for(let r of on(e)){let n=r?.key||r?.getAttribute?.("data-lustre-key");n&&t.set(n,r)}return t}function Ca(e,t,r,n,i,s,o){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let c=e.nextSibling;r.removeChild(e),e=c}if(s.size===0)return n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e;if(o.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;o.add(t.key);let l=s.get(t.key);if(!l&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!l&&e!==null){let c=document.createTextNode("");return r.insertBefore(c,e),n.unshift({prev:c,next:t,parent:r}),e}return!l||l===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(l,e),n.unshift({prev:l,next:t,parent:r}),e)}function*on(e){for(let t of e.children)yield*go(t)}function*go(e){e.subtree!==void 0?yield*go(e.subtree()):yield e}var Ai=class e{static start({init:t,update:r,view:n},i,s){if(!Si())return new g(new fr);let o=i instanceof HTMLElement?i:document.querySelector(i);if(!o)return new g(new sn(i));let l=new e(o,t(s),r,n);return new x(c=>l.send(c))}constructor(t,[r,n],i,s){this.root=t,this.#e=r,this.#s=i,this.#r=s,this.#t=window.setTimeout(()=>this.#i(n.all.toArray(),!0),0)}root;send(t){if(t instanceof Bt){if(t[0]instanceof cr){this.#t=window.clearTimeout(this.#t),this.#n=[],this.#e=t[0][0];let r=this.#r(this.#e),n=(s,o=!1)=>l=>{let c=s(l);c instanceof x&&this.send(new K(c[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));dr(i,r,n)}}else if(t instanceof K){let r=t[0],n=t[1]??!1;this.#n.push(r),n?(this.#t=window.clearTimeout(this.#t),this.#i()):this.#t||(this.#t=window.setTimeout(()=>this.#i()))}else if(t instanceof It){let r=t[0],n=t[1];this.root.dispatchEvent(new CustomEvent(r,{detail:n,bubbles:!0,composed:!0}))}else if(t instanceof ar)for(this.#t=window.clearTimeout(this.#t),this.#e=null,this.#s=null,this.#r=null,this.#n=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#s;#r;#n=[];#t;#i(t=[]){this.#t=void 0,this.#o(t);let r=this.#r(this.#e),n=(s,o=!1)=>l=>{let c=s(l);c instanceof x&&this.send(new K(c[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));dr(i,r,n)}#o(t=[]){for(;this.#n.length>0;){let r=this.#n.shift(),[n,i]=this.#s(this.#e,r);t=t.concat(i.all.toArray()),this.#e=n}for(;t.length>0;){let r=t.shift(),n=l=>this.send(new K(l)),i=(l,c)=>this.root.dispatchEvent(new CustomEvent(l,{detail:c,bubbles:!0,composed:!0})),s=()=>{},o=this.root;r({dispatch:n,emit:i,select:s,root:o})}this.#n.length>0&&this.#o(t)}},Ia=Ai.start,ji=({init:e,update:t,view:r,on_attribute_change:n},i)=>{if(!Si())return new g(new fr);if(!i.includes("-"))return new g(new rn(i));if(window.customElements.get(i))return new g(new nn(i));let[s,o]=e(void 0),l=n instanceof w,c=class extends HTMLElement{static get observedAttributes(){return l?n[0].entries().map(([f])=>f):[]}constructor(){super(),this.attachShadow({mode:"open"}),this.internals=this.attachInternals(),l&&n[0].forEach((f,d)=>{let h=`__mirrored__${d}`;Object.defineProperty(this,d,{get(){return this[h]},set(m){let y=this[h];if(this.#t&&v(y,m))return;this[h]=m;let J=f(m);J instanceof g||(this.#r.push(J[0]),this.#t&&!this.#n&&(this.#n=window.requestAnimationFrame(()=>this.#i())))}})})}connectedCallback(){this.#u().finally(()=>{this.#i(o.all.toArray(),!0),this.#t=!0})}attributeChangedCallback(f,d,h){d!==h&&(this[f]=h)}disconnectedCallback(){this.#s=null,this.#r=[],this.#n=window.cancelAnimationFrame(this.#n),this.#t=!1}send(f){if(f instanceof Bt){if(f[0]instanceof cr){this.#n=window.cancelAnimationFrame(this.#n),this.#r=[],this.#s=f[0][0];let d=r(this.#s),h=(y,J=!1)=>re=>{let ge=y(re);ge instanceof x&&this.send(new K(ge[0],J))},m=this.shadowRoot.childNodes[this.#e.length]??this.shadowRoot.appendChild(document.createTextNode(""));dr(m,d,h)}}else if(f instanceof K){let d=f[0],h=f[1]??!1;this.#r.push(d),h?(this.#n=window.cancelAnimationFrame(this.#n),this.#i()):this.#n||(this.#n=window.requestAnimationFrame(()=>this.#i()))}else if(f instanceof It){let d=f[0],h=f[1];this.dispatchEvent(new CustomEvent(d,{detail:h,bubbles:!0,composed:!0}))}}#e=[];#s=s;#r=[];#n;#t=!0;#i(f=[]){if(!this.#t)return;this.#n=void 0,this.#o(f);let d=r(this.#s),h=(y,J=!1)=>re=>{let ge=y(re);ge instanceof x&&this.send(new K(ge[0],J))},m=this.shadowRoot.childNodes[this.#e.length]??this.shadowRoot.appendChild(document.createTextNode(""));dr(m,d,h)}#o(f=[]){for(;this.#r.length>0;){let d=this.#r.shift(),[h,m]=t(this.#s,d);f=f.concat(m.all.toArray()),this.#s=h}for(;f.length>0;){let d=f.shift(),h=re=>this.send(new K(re)),m=(re,ge)=>this.dispatchEvent(new CustomEvent(re,{detail:ge,bubbles:!0,composed:!0})),y=()=>{},J=this.shadowRoot;d({dispatch:h,emit:m,select:y,root:J})}this.#r.length>0&&this.#o(f)}async#u(){let f=[];for(let h of document.querySelectorAll("link[rel=stylesheet]"))h.sheet||f.push(new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",y)}));for(await Promise.allSettled(f);this.#e.length;)this.#e.shift().remove(),this.shadowRoot.firstChild.remove();this.shadowRoot.adoptedStyleSheets=this.getRootNode().adoptedStyleSheets;let d=[];for(let h of document.styleSheets)try{this.shadowRoot.adoptedStyleSheets.push(h)}catch{try{let m=new CSSStyleSheet;for(let y of h.cssRules)m.insertRule(y.cssText,m.cssRules.length);this.shadowRoot.adoptedStyleSheets.push(m)}catch{let m=h.ownerNode.cloneNode();this.shadowRoot.prepend(m),this.#e.push(m),d.push(new Promise((y,J)=>{m.onload=y,m.onerror=J}))}}return Promise.allSettled(d)}};return window.customElements.define(i,c),new x(void 0)},Mi=class e{static start({init:t,update:r,view:n,on_attribute_change:i},s){let o=new e(t(s),r,n,i);return new x(l=>o.send(l))}constructor([t,r],n,i,s){this.#e=t,this.#s=n,this.#n=i,this.#t=i(t),this.#u=s,this.#i=new Map,this.#o=lo(this.#t),this.#l(r.all.toArray())}send(t){if(t instanceof Kr){for(let r of t[0]){let n=this.#u.get(r[0]);if(!n)continue;let i=n(r[1]);i instanceof g||this.#r.push(i)}this.#l()}else if(t instanceof Qr)this.#r=this.#r.concat(t[0].toArray()),this.#l(t[1].all.toArray());else if(!(t instanceof Bt))if(t instanceof K)this.#r.push(t[0]),this.#l();else if(t instanceof It){let r=new Zr(t[0],t[1]);for(let[n,i]of this.#i)i(r)}else if(t instanceof Xr){let r=this.#o.get(t[0]);if(!r)return;let n=r(t[1]);if(n instanceof g)return;this.#r.push(n[0]),this.#l()}else if(t instanceof en){let r=oi(this.#u),n=new Vr(r,this.#t);this.#i=this.#i.set(t[0],t[1]),t[1](n)}else t instanceof tn&&(this.#i=this.#i.delete(t[0]))}#e;#s;#r;#n;#t;#i;#o;#u;#l(t=[]){this.#a(t);let r=this.#n(this.#e),n=elements(this.#t,r);if(!ho(n)){let i=new Gr(n);for(let[s,o]of this.#i)o(i)}this.#t=r,this.#o=n.handlers}#a(t=[]){for(;this.#r.length>0;){let r=this.#r.shift(),[n,i]=this.#s(this.#e,r);t=t.concat(i.all.toArray()),this.#e=n}for(;t.length>0;)t.shift()({dispatch:l=>this.send(new K(l)),emit:(l,c)=>this.root.dispatchEvent(new CustomEvent(l,{detail:c,bubbles:!0,composed:!0})),select:()=>{},root:null});this.#r.length>0&&this.#a(t)}},qa=Mi.start,Si=()=>globalThis.window&&window.document;function yo(e,t,r){return e?t():r()}var Pe=class extends a{constructor(t,r){super(),this.seconds=t,this.nanoseconds=r}};function Ei(e){let t=1e9,r=Q(e.nanoseconds,t),n=e.nanoseconds-r,i=e.seconds+D(n,t);return r>=0?new Pe(i,r):new Pe(i-1,t+r)}function bo(e,t){let r=new Pe(t.seconds-e.seconds,t.nanoseconds-e.nanoseconds);return Ei(r)}function mr(e,t){let r=new Pe(e.seconds+t.seconds,e.nanoseconds+t.nanoseconds);return Ei(r)}function $r(e){return new Pe(e,0)}function un(e){let t=new Pe(0,e);return Ei(t)}function hr(e){return[e.seconds,e.nanoseconds]}var Z=864e8;function Lo(e){return e*Z}function jo(e){return D(e,Z)}var Mo=1,_n=0,nc=0,ic=0,Eo=!1,To=!1,dn=0;function So(){return Date.now()*1e3+dn}function Ao(){return Math.trunc(performance.now()*1e3)+dn}function Bi(){if(To)return _n+dn;if(Eo){let e=So()-nc,t=Math.trunc(e*Mo);return _n+t}return So()}function Ii(){return-new Date().getTimezoneOffset()}function Bo(){if(To)return _n+dn;if(Eo){let e=Ao()-ic,t=Math.trunc(e*Mo);return _n+t}return Ao()}var sc=1;function Io(){return sc++}var qi=class extends a{constructor(t,r,n,i){super(),this.timestamp_utc_us=t,this.offset_local_us=r,this.monotonic_us=n,this.unique=i}},mn=class extends a{constructor(t,r,n){super(),this.date=t,this.time=r,this.offset=n}};var zt=class extends a{constructor(t,r){super(),this.date=t,this.time=r}},zi=class extends a{constructor(t){super(),this.minutes=t}},Dt=class extends a{constructor(t){super(),this.unix_days=t}};var Ye=class extends a{constructor(t){super(),this.microseconds=t}},Di=class extends a{},xr=class extends a{constructor(t){super(),this.microseconds=t}};function Yo(e){return e.unique}function Ho(e,t,r){return new mn(e,t,r)}function Uo(e){return new zt(e.date,e.time)}function Wi(e){return e.date}function Ji(e){return e.time}function Ro(e){return new Dt(D(e,86400))}function Go(e){return new Dt(D(e,Z))}function Zo(e){return Go(e.timestamp_utc_us)}function Vo(e){return e.unix_days*86400}function Ko(e,t){return new Dt(e.unix_days+t)}function Qo(e,t){return new Dt(e.unix_days-t)}function $n(e){if(e instanceof Ye&&e.microseconds<0){let t=e.microseconds;return new Ye(Z+Q(t,Z))}else if(e instanceof Ye&&e.microseconds>=Z){let t=e.microseconds;return new Ye(Q(t,Z))}else return e}function Ct(e){return new Ye(e)}function Ie(e){let t=$n(e);if(t instanceof Ye)return t.microseconds;if(t instanceof Di)return Z;{let r=t.microseconds;return Z+r}}function Xo(e){return Ct(Q(e,Z))}function eu(e){return Xo(e.timestamp_utc_us)}function et(e){return un(e*1e3)}function cc(e){let t=-e.minutes*6e7;return et(t)}function Pi(e){let t=Ie(e);return et(t)}function Xe(e){let t=hr(e),r=t[0],n=t[1];return r*1e6+D(n,1e3)}function tu(e,t){let r=Xe(t);if(r===0)return e;if(e instanceof xr&&r+e.microseconds<1e6){let i=e.microseconds;return new xr(i+r)}else if(e instanceof xr){let i=Ie(e)+(r-1e6),s=Ct(i);return $n(s)}else{let i=Ie(e)+r,s=Ct(i);return $n(s)}}function ru(e,t){if(Xe(t)===0)return e;{let n=Ie(e)-Xe(t),i=Ct(n);return $n(i)}}function fc(e,t){let r=$r(e);return mr(r,un(t))}function Yi(e){let r=Lo(e);return et(r)}function nu(e,t){return mr(e,t)}function Hi(e){let t=hr(e),r=t[0],n=t[1];if(r>=0&&n>=0)return e;{let s=r<0?-r:r,o=n<0?-n:n;return fc(s,o)}}function iu(e){return bo(e,$r(0))}function hn(e,t){return mr(e,iu(t))}function Ui(e){let t=hr(e),r=t[0],n=t[1];return r>=0&&n>=0}function Ri(e){let t=Xe(e);return jo(t)}function su(e){return Xe(e)}function ou(){return Ii()*6e7}function uu(){return new qi(Bi(),ou(),Bo(),Io())}var wr=new zi(0);function lu(e){return new mn(Zo(e),eu(e),wr)}function au(e,t){return mi(!Ui(t),()=>Gi(e,Hi(t)),()=>{let r=Ri(t),n=hn(t,Yi(r)),i=(()=>{let d=e.time,h=Pi(d),m=hn(h,n);return su(m)})(),s=i<0?[i+Z,r+1]:[i,r],o=s[0],l=s[1],c=et(Ie(e.time)-o),p=(()=>{let d=e.date;return Qo(d,l)})(),f=(()=>{let d=e.time;return ru(d,c)})();return new zt(p,f)})}function Gi(e,t){return mi(!Ui(t),()=>au(e,Hi(t)),()=>{let r=Ri(t),n=hn(t,Yi(r)),i=(()=>{let d=e.time,h=Pi(d),m=nu(h,n);return su(m)})(),s=i>=Z?[i-Z,r+1]:[i,r],o=s[0],l=s[1],c=et(o-Ie(e.time)),p=(()=>{let d=e.date;return Ko(d,l)})(),f=(()=>{let d=e.time;return tu(d,c)})();return new zt(p,f)})}function cu(e){let t=(()=>{let n=Uo(e);return Gi(n,cc(e.offset))})();return new zt(t.date,t.time)}function Ki(e){return Ro(e)}function Qi(e){return Vo(e)}function xn(e){return Ki(D(e,1e3))}function wn(e){return Qi(e)*1e3}function hu(e){let t=(e-wn(xn(e)))*1e3;return Ct(t)}function Mc(e,t,r){return Ho(e,t,r)}function es(e){return Mc(xn(e),hu(e),wr)}function Ec(e){return cu(e)}function gr(e){let t=Ec(e);return wn(Wi(t))+D(Ie(Ji(t)),1e3)}function xu(){return uu()}function wu(e){return lu(e)}function gu(e){return Yo(e)}function te(e){return or(e)}function B(e,t){return xe("div",e,t)}function ts(e){return xe("hr",e,u([]))}function Nt(e,t){return xe("p",e,t)}function rs(e,t){return xe("a",e,t)}function bn(e,t){return xe("span",e,t)}function je(e,t){return xe("button",e,t)}function yu(e){return xe("input",e,u([]))}function bu(e,t){return xe("textarea",e,u([or(t)]))}function tt(e,t){return oo(e,t)}function Ue(e,t){return co(e,t)}function Se(e){return Ue("click",t=>new x(e))}function ns(e){return Ue("focus",t=>new x(e))}function is(e){return Ue("blur",t=>new x(e))}function qc(e){let t=e;return _i("target",_i("value",Ys))(t)}function ss(e){return Ue("input",t=>{let r=qc(t);return pe(r,e)})}var vn="http://www.w3.org/2000/svg";function os(e){return Tt(vn,"line",e,u([]))}function us(e){return Tt(vn,"polyline",e,u([]))}function rt(e,t){return Tt(vn,"svg",e,t)}function z(e){return Tt(vn,"path",e,u([]))}function ls(e){return rt($(_("stroke-linejoin","round"),$(_("stroke-linecap","round"),$(_("stroke-width","2"),$(_("stroke","currentColor"),$(_("fill","none"),$(_("viewBox","0 0 24 24"),$(_("height","24"),$(_("width","24"),e)))))))),u([z(u([_("d","M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z")])),z(u([_("d","M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1")]))]))}function ku(e){return rt($(_("stroke-linejoin","round"),$(_("stroke-linecap","round"),$(_("stroke-width","2"),$(_("stroke","currentColor"),$(_("fill","none"),$(_("viewBox","0 0 24 24"),$(_("height","24"),$(_("width","24"),e)))))))),u([z(u([_("d","M13 7 8.7 2.7a2.41 2.41 0 0 0-3.4 0L2.7 5.3a2.41 2.41 0 0 0 0 3.4L7 13")])),z(u([_("d","m8 6 2-2")])),z(u([_("d","m18 16 2-2")])),z(u([_("d","m17 11 4.3 4.3c.94.94.94 2.46 0 3.4l-2.6 2.6c-.94.94-2.46.94-3.4 0L11 17")])),z(u([_("d","M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z")])),z(u([_("d","m15 5 4 4")]))]))}function Ou(e){return rt($(_("stroke-linejoin","round"),$(_("stroke-linecap","round"),$(_("stroke-width","2"),$(_("stroke","currentColor"),$(_("fill","none"),$(_("viewBox","0 0 24 24"),$(_("height","24"),$(_("width","24"),e)))))))),u([z(u([_("d","m3 10 2.5-2.5L3 5")])),z(u([_("d","m3 19 2.5-2.5L3 14")])),z(u([_("d","M10 6h11")])),z(u([_("d","M10 12h11")])),z(u([_("d","M10 18h11")]))]))}function Lu(e){return rt($(_("stroke-linejoin","round"),$(_("stroke-linecap","round"),$(_("stroke-width","2"),$(_("stroke","currentColor"),$(_("fill","none"),$(_("viewBox","0 0 24 24"),$(_("height","24"),$(_("width","24"),e)))))))),u([us(u([_("points","15 3 21 3 21 9")])),us(u([_("points","9 21 3 21 3 15")])),os(u([_("y2","10"),_("y1","3"),_("x2","14"),_("x1","21")])),os(u([_("y2","14"),_("y1","21"),_("x2","10"),_("x1","3")]))]))}function kn(e){return rt($(_("stroke-linejoin","round"),$(_("stroke-linecap","round"),$(_("stroke-width","2"),$(_("stroke","currentColor"),$(_("fill","none"),$(_("viewBox","0 0 24 24"),$(_("height","24"),$(_("width","24"),e)))))))),u([z(u([_("d","M18 6 6 18")])),z(u([_("d","m6 6 12 12")]))]))}function ju(e){return rt($(_("stroke-linejoin","round"),$(_("stroke-linecap","round"),$(_("stroke-width","2"),$(_("stroke","currentColor"),$(_("fill","none"),$(_("viewBox","0 0 24 24"),$(_("height","24"),$(_("width","24"),e)))))))),u([z(u([_("d","M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z")])),z(u([_("d","m15 5 4 4")]))]))}var Su="line-discussion";var yr=class extends a{constructor(t,r,n,i,s,o,l,c){super(),this.note_id=t,this.parent_id=r,this.significance=n,this.user_name=i,this.message=s,this.expanded_message=o,this.time=l,this.modifier=c}},nt=class extends a{},it=class extends a{},st=class extends a{},Ft=class extends a{},ot=class extends a{},Wt=class extends a{},Jt=class extends a{},Pt=class extends a{},Yt=class extends a{},Ht=class extends a{},Ut=class extends a{},br=class extends a{},vr=class extends a{},Rt=class extends a{};function Nc(e){return e instanceof nt?1:e instanceof it?2:e instanceof st?3:e instanceof Ft?4:e instanceof ot?5:e instanceof Wt?6:e instanceof Jt?7:e instanceof Pt?8:e instanceof Yt?9:e instanceof Ht?10:e instanceof Ut?11:12}function Fc(e){return e instanceof vr?0:e instanceof Rt?1:2}function Au(e){return $e(u([["n",me(e.note_id)],["p",me(e.parent_id)],["s",q((()=>{let t=e.significance;return Nc(t)})())],["u",me(e.user_name)],["m",me(e.message)],["x",io(e.expanded_message,me)],["t",q((()=>{let t=e.time;return gr(t)})())],["d",q((()=>{let t=e.modifier;return Fc(t)})())]]))}var as=class extends a{constructor(t,r,n,i,s,o,l,c){super(),this.note_id=t,this.parent_id=r,this.significance=n,this.user_name=i,this.message=s,this.expanded_message=o,this.time=l,this.edited=c}},ut=class extends a{},lt=class extends a{},at=class extends a{},ct=class extends a{},ft=class extends a{},pt=class extends a{},_t=class extends a{},kr=class extends a{},dt=class extends a{},mt=class extends a{},$t=class extends a{},ht=class extends a{},xt=class extends a{},wt=class extends a{},Re=class extends a{},gt=class extends a{},yt=class extends a{},Or=class extends a{};function Wc(e){if(e===0)return new ut;if(e===1)return new lt;if(e===2)return new at;if(e===3)return new ct;if(e===4)return new ft;if(e===5)return new pt;if(e===6)return new _t;if(e===7)return new kr;if(e===8)return new dt;if(e===9)return new mt;if(e===10)return new $t;if(e===11)return new ht;if(e===12)return new xt;if(e===13)return new wt;if(e===14)return new Re;if(e===15)return new gt;if(e===16)return new yt;if(e===17)return new Or;throw fe("panic","o11a/computed_note",128,"significance_from_int","Invalid note significance found",{})}function Jc(){return A("n",T,e=>A("p",T,t=>A("s",We,r=>A("u",T,n=>A("m",T,i=>A("x",rr(T),s=>A("t",We,o=>A("e",At,l=>Fe(new as(e,t,Wc(r),n,i,s,es(o),l))))))))))}function Eu(e){return e instanceof ut?new b:e instanceof lt?new w("Unanswered Question"):e instanceof at?new w("Answered"):e instanceof ct?new w("Answer"):e instanceof ft?new w("Incomplete ToDo"):e instanceof pt?new w("Complete"):e instanceof _t?new w("Completion"):e instanceof kr?new w("Unconfirmed Finding"):e instanceof dt?new w("Confirmed Finding"):e instanceof mt?new w("Rejected Finding"):e instanceof $t?new w("Confirmation"):e instanceof ht?new w("Rejection"):e instanceof xt?new w("Unanswered Dev Question"):e instanceof wt?new w("Answered Dev Question"):e instanceof Re?new w("Info"):e instanceof gt?new w("Incorrect Info"):e instanceof yt?new w("Rejection"):new w("Confirmation")}function Tu(e){return e instanceof ut?!1:e instanceof lt||e instanceof at?!0:e instanceof ct?!1:e instanceof ft||e instanceof pt?!0:e instanceof _t?!1:e instanceof kr||e instanceof dt||e instanceof mt?!0:e instanceof $t||e instanceof ht?!1:e instanceof xt||e instanceof wt||e instanceof Re||e instanceof gt?!0:(e instanceof yt,!1)}function Bu(e){return H(ae(e,T),t=>pe((()=>{let r=Yr(t,Qs(Jc()));return Be(r,u([new _e("json-encoded computed note",Ne(t),u([]))]))})(),r=>Cs(r,n=>n.parent_id)))}var Iu="user-submitted-line-note",qu="user-clicked-discussion-preview",cs="user-focused-input",zu="user-unfocused-input",Du="user-maximized-thread";function Cu(e){return Ue("keydown",t=>{let r=A("ctrlKey",At,i=>A("key",T,s=>Fe([i,s]))),n=u([new Y("","",u([]))]);return H((()=>{let i=ae(t,r);return Be(i,n)})(),i=>{let s=i[0],o=i[1];return s&&o==="Enter"?new x(e):new g(n)})})}var W=class extends a{constructor(t,r,n,i,s,o,l,c,p,f,d,h,m,y,J){super(),this.reference=t,this.show_reference_discussion=r,this.user_name=n,this.line_number=i,this.topic_id=s,this.topic_title=o,this.notes=l,this.current_note_draft=c,this.current_thread_id=p,this.current_thread_notes=f,this.active_thread=d,this.show_expanded_message_box=h,this.current_expanded_message_draft=m,this.expanded_messages=y,this.editing_note=J}},fs=class extends a{constructor(t,r,n,i){super(),this.current_thread_id=t,this.parent_note=r,this.prior_thread_id=n,this.prior_thread=i}},On=class extends a{constructor(t,r,n,i){super(),this.topic_id=t,this.topic_title=r,this.line_number=n,this.reference=i}},Ln=class extends a{constructor(t){super(),this[0]=t}},jn=class extends a{constructor(t){super(),this[0]=t}},Lr=class extends a{},Sn=class extends a{constructor(t,r){super(),this.new_thread_id=t,this.parent_note=r}},An=class extends a{},Mn=class extends a{constructor(t){super(),this[0]=t}},En=class extends a{constructor(t){super(),this[0]=t}},Tn=class extends a{constructor(t){super(),this.for_note_id=t}},ps=class extends a{},Bn=class extends a{},In=class extends a{},jr=class extends a{},qn=class extends a{},Sr=class extends a{constructor(t){super(),this[0]=t}},zn=class extends a{},Dn=class extends a{},Cn=class extends a{};function Uc(e){return[new W(new b,!1,"guest",0,"","",V(),"","",u([]),new b,!1,new b,Rr(),new b),F()]}function Rc(e){let t=e.active_thread;if(t instanceof w){let r=t[0];return B(u([]),u([B(u([k("flex justify-end width-full")]),u([je(u([Se(new An),k("icon-button flex gap-[.5rem] pl-[.5rem] pr-[.3rem] pt-[.3rem] pb-[.1rem] mb-[.25rem]")]),u([te("Close Thread"),kn(u([]))]))])),te("Current Thread: "),te(r.parent_note.message),(()=>{let n=r.parent_note.expanded_message;if(n instanceof w){let i=n[0];return B(u([k("mt-[.5rem]")]),u([Nt(u([]),u([te(i)]))]))}else return we(u([]))})(),ts(u([k("mt-[.5rem]")]))]))}else return B(u([k("flex items-start justify-between width-full mb-[.5rem]")]),u([bn(u([k("pt-[.1rem] underline")]),u([Ze(e.reference)?rs(u([yi("/"+e.topic_id)]),u([te(e.topic_title)])):te(e.topic_title)])),B(u([]),u([Ze(e.reference)?je(u([Se(new Cn),k("icon-button p-[.3rem] mr-[.5rem]")]),u([kn(u([]))])):we(u([])),je(u([Se(new qn),k("icon-button p-[.3rem] ")]),u([Lu(u([]))]))]))]))}function Gc(e){let t="input-border rounded-md text-[0.65rem] pb-[0.15rem] pt-1 px-[0.5rem]",r=Eu(e);if(r instanceof w){let n=r[0];return bn(u([k(t)]),u([te(n)]))}else return we(u([]))}function Zc(e){return G(e.current_thread_notes,t=>B(u([k("line-discussion-item")]),u([B(u([k("flex justify-between mb-[.2rem]")]),u([B(u([k("flex gap-[.5rem] items-start")]),u([Nt(u([]),u([te(t.user_name)])),Gc(t.significance)])),B(u([k("flex gap-[.5rem]")]),u([je(u([he("edit-message-button"),k("icon-button p-[.3rem]"),Se(new Sr(t))]),u([ju(u([]))])),t.expanded_message instanceof w?je(u([he("expand-message-button"),k("icon-button p-[.3rem]"),Se(new Tn(t.note_id))]),u([Ou(u([]))])):we(u([])),Tu(t.significance)?je(u([he("switch-thread-button"),k("icon-button p-[.3rem]"),Se(new Sn(t.note_id,t))]),u([ls(u([]))])):we(u([]))]))])),Nt(u([]),u([te(t.message)])),ki(e.expanded_messages,t.note_id)?B(u([k("mt-[.5rem]")]),u([Nt(u([]),u([te((()=>{let n=t.expanded_message;return Ar(n,"")})())]))])):we(u([])),ts(u([k("mt-[.5rem]")]))])))}function Vc(e){let t="absolute overlay p-[.5rem] flex w-[100%] h-60 mt-2",r="grow text-[.95rem] resize-none p-[.3rem]";return B(u([he("expanded-message"),e.show_expanded_message_box?k(t+" show-exp"):k(t)]),u([bu(u([he("expanded-message-box"),k(r),gi("Write an expanded message body"),ss(n=>new En(n)),ns(new In),is(new jr),Cu(new Lr)]),(()=>{let n=e.current_expanded_message_draft;return Ar(n,"")})())]))}function Kc(e,t){if(t){if(e==="done")return[new ot,"done"];if(e.startsWith("done: ")){let r=e.slice(6);return[new ot,r]}else if(e.startsWith("a: ")){let r=e.slice(3);return[new st,r]}else if(e.startsWith("answer: ")){let r=e.slice(8);return[new st,r]}else if(e.startsWith("reject: ")){let r=e.slice(8);return[new Pt,r]}else if(e.startsWith("confirm: ")){let r=e.slice(9);return[new Jt,r]}else if(e.startsWith("incorrect: ")){let r=e.slice(11);return[new Ut,r]}else if(e.startsWith("correct: ")){let r=e.slice(9);return[new br,r]}else return[new nt,e]}else if(e.startsWith("todo: ")){let r=e.slice(6);return[new Ft,r]}else if(e.startsWith("q: ")){let r=e.slice(3);return[new it,r]}else if(e.startsWith("question: ")){let r=e.slice(10);return[new it,r]}else if(e.startsWith("finding: ")){let r=e.slice(9);return[new Wt,r]}else if(e.startsWith("dev: ")){let r=e.slice(5);return[new Yt,r]}else if(e.startsWith("info: ")){let r=e.slice(6);return[new Ht,r]}else return[new nt,e]}function Qc(e){return e instanceof ct?"a: ":e instanceof wt?"dev: ":e instanceof at?"q: ":e instanceof ut?"":e instanceof pt?"todo: ":e instanceof dt?"finding: ":e instanceof $t?"confirm: ":e instanceof ht?"reject: ":e instanceof ft?"todo: ":e instanceof Re?"info: ":e instanceof Or?"correct: ":e instanceof yt?"incorrect: ":e instanceof mt?"finding: ":e instanceof gt?"info: ":e instanceof _t?"done: ":e instanceof xt?"dev: ":e instanceof lt?"q: ":"finding: "}function Xc(e,t){if(t instanceof On){let r=t.topic_id,n=t.topic_title,i=t.line_number,s=t.reference;return[(()=>{let o=e;return new W(s,o.show_reference_discussion,o.user_name,i,r,n,o.notes,o.current_note_draft,r,(()=>{let l=oe(e.notes,r);return St(l,u([]))})(),o.active_thread,o.show_expanded_message_box,o.current_expanded_message_draft,o.expanded_messages,o.editing_note)})(),F()]}else if(t instanceof Ln){let r=t[0];return[(()=>{let n=e;return new W(n.reference,n.show_reference_discussion,n.user_name,n.line_number,n.topic_id,n.topic_title,r,n.current_note_draft,n.current_thread_id,(()=>{let i=oe(r,e.current_thread_id);return St(i,u([]))})(),n.active_thread,n.show_expanded_message_box,n.current_expanded_message_draft,n.expanded_messages,n.editing_note)})(),F()]}else if(t instanceof jn){let r=t[0];return nf("user wrote note","src/o11a/ui/line_discussion.gleam",197),[(()=>{let n=e;return new W(n.reference,n.show_reference_discussion,n.user_name,n.line_number,n.topic_id,n.topic_title,n.notes,r,n.current_thread_id,n.current_thread_notes,n.active_thread,n.show_expanded_message_box,n.current_expanded_message_draft,n.expanded_messages,n.editing_note)})(),F()]}else if(t instanceof Lr){let r=Kc((()=>{let s=e.current_note_draft;return fi(s)})(),Ze(e.active_thread)),n=r[0],i=r[1];return yo(e.current_note_draft==="",()=>[e,F()],()=>{let s=xu(),o=wu(s),l=e.user_name+(()=>{let y=gu(s);return I(y)})()+(()=>{let y=gr(o);return I(y)})(),c=(()=>{let m=e.editing_note;if(m instanceof w){let y=m[0];return[new Rt,y.note_id]}else return[new vr,e.current_thread_id]})(),p=c[0],f=c[1],d=(()=>{let m=(()=>{let y=e.current_expanded_message_draft;return Mr(y,fi)})();return m instanceof w&&m[0]===""?new b:m})(),h=new yr(l,f,n,"user"+(()=>{let m=si(100);return I(m)})(),i,d,o,p);return[(()=>{let m=e;return new W(m.reference,m.show_reference_discussion,m.user_name,m.line_number,m.topic_id,m.topic_title,m.notes,"",m.current_thread_id,m.current_thread_notes,m.active_thread,!1,new b,m.expanded_messages,new b)})(),tt(Iu,$e(u([["note",Au(h)],["topic_id",me(e.topic_id)]])))]})}else if(t instanceof Sn){let r=t.new_thread_id,n=t.parent_note;return[(()=>{let i=e;return new W(i.reference,i.show_reference_discussion,i.user_name,i.line_number,i.topic_id,i.topic_title,i.notes,i.current_note_draft,r,(()=>{let s=oe(e.notes,r);return St(s,u([]))})(),new w(new fs(r,n,e.current_thread_id,e.active_thread)),i.show_expanded_message_box,i.current_expanded_message_draft,i.expanded_messages,i.editing_note)})(),F()]}else if(t instanceof An){let r=(()=>{let i=e.active_thread,s=Mr(i,o=>o.prior_thread);return ws(s)})(),n=(()=>{let i=Mr(r,s=>s.current_thread_id);return Ar(i,e.topic_id)})();return[(()=>{let i=e;return new W(i.reference,i.show_reference_discussion,i.user_name,i.line_number,i.topic_id,i.topic_title,i.notes,i.current_note_draft,n,(()=>{let s=oe(e.notes,n);return St(s,u([]))})(),r,i.show_expanded_message_box,i.current_expanded_message_draft,i.expanded_messages,i.editing_note)})(),F()]}else if(t instanceof Mn){let r=t[0];return[(()=>{let n=e;return new W(n.reference,n.show_reference_discussion,n.user_name,n.line_number,n.topic_id,n.topic_title,n.notes,n.current_note_draft,n.current_thread_id,n.current_thread_notes,n.active_thread,r,n.current_expanded_message_draft,n.expanded_messages,n.editing_note)})(),F()]}else if(t instanceof En){let r=t[0];return[(()=>{let n=e;return new W(n.reference,n.show_reference_discussion,n.user_name,n.line_number,n.topic_id,n.topic_title,n.notes,n.current_note_draft,n.current_thread_id,n.current_thread_notes,n.active_thread,n.show_expanded_message_box,new w(r),n.expanded_messages,n.editing_note)})(),F()]}else if(t instanceof Tn){let r=t.for_note_id;return ki(e.expanded_messages,r)?[(()=>{let i=e;return new W(i.reference,i.show_reference_discussion,i.user_name,i.line_number,i.topic_id,i.topic_title,i.notes,i.current_note_draft,i.current_thread_id,i.current_thread_notes,i.active_thread,i.show_expanded_message_box,i.current_expanded_message_draft,_o(e.expanded_messages,r),i.editing_note)})(),F()]:[(()=>{let i=e;return new W(i.reference,i.show_reference_discussion,i.user_name,i.line_number,i.topic_id,i.topic_title,i.notes,i.current_note_draft,i.current_thread_id,i.current_thread_notes,i.active_thread,i.show_expanded_message_box,i.current_expanded_message_draft,Oi(e.expanded_messages,r),i.editing_note)})(),F()]}else{if(t instanceof ps)return[e,tt(qu,$e(u([["line_number",q(e.line_number)],["discussion_lane",q(1)]])))];if(t instanceof Bn)return[e,tt(cs,$e(u([["line_number",q(e.line_number)],["discussion_lane",q(1)]])))];if(t instanceof In)return[(()=>{let r=e;return new W(r.reference,r.show_reference_discussion,r.user_name,r.line_number,r.topic_id,r.topic_title,r.notes,r.current_note_draft,r.current_thread_id,r.current_thread_notes,r.active_thread,!0,r.current_expanded_message_draft,r.expanded_messages,r.editing_note)})(),tt(cs,$e(u([["line_number",q(e.line_number)],["discussion_lane",q(1)]])))];if(t instanceof jr)return[e,tt(zu,$e(u([["line_number",q(e.line_number)],["discussion_lane",q(1)]])))];if(t instanceof qn)return[e,tt(Du,$e(u([["line_number",q(e.line_number)],["discussion_lane",q(1)]])))];if(t instanceof Sr){let r=t[0];return[(()=>{let n=e;return new W(n.reference,n.show_reference_discussion,n.user_name,n.line_number,n.topic_id,n.topic_title,n.notes,Qc(r.significance)+r.message,n.current_thread_id,n.current_thread_notes,n.active_thread,r.expanded_message instanceof w,r.expanded_message,n.expanded_messages,new w(r))})(),F()]}else if(t instanceof zn){let r=Ds(e.current_thread_notes);if(r.isOk()){let n=r[0];return[e,so(i=>i(new Sr(n)))]}else return[e,F()]}else return t instanceof Dn?[(()=>{let r=e;return new W(r.reference,r.show_reference_discussion,r.user_name,r.line_number,r.topic_id,r.topic_title,r.notes,"",r.current_thread_id,r.current_thread_notes,r.active_thread,!1,new b,r.expanded_messages,new b)})(),F()]:[(()=>{let r=e;return new W(r.reference,!e.show_reference_discussion,r.user_name,r.line_number,r.topic_id,r.topic_title,r.notes,r.current_note_draft,r.current_thread_id,r.current_thread_notes,r.active_thread,r.show_expanded_message_box,r.current_expanded_message_draft,r.expanded_messages,r.editing_note)})(),F()]}}function ef(e,t){return Ue("keydown",r=>{let n=A("ctrlKey",At,s=>A("key",T,o=>Fe([s,o]))),i=u([new Y("","",u([]))]);return H((()=>{let s=ae(r,n);return Be(s,i)})(),s=>{let o=s[0],l=s[1];return o&&l==="Enter"?new x(e):l==="ArrowUp"?new x(t):new g(i)})})}function tf(e){return B(u([k("flex justify-between items-center gap-[.35rem]")]),u([je(u([he("toggle-expanded-message-button"),k("icon-button p-[.3rem]"),Se(new Mn(!e.show_expanded_message_box))]),u([ku(u([]))])),e.editing_note instanceof w?je(u([he("cancel-message-edit-button"),k("icon-button p-[.3rem]"),Se(new Dn)]),u([kn(u([]))])):we(u([])),yu(u([he("new-comment-input"),k("inline-block w-full grow text-[0.9rem] pl-2 pb-[.2rem] p-[0.3rem] border-[none] border-t border-solid;"),gi("Add a new comment"),ss(t=>new jn(t)),ns(new Bn),is(new jr),ef(new Lr,new zn),po(e.current_note_draft)]))]))}function rf(e){return ti("Rendering line discussion "+e.topic_title),B(u([he("line-discussion-overlay")]),u([Ze(e.reference)&&!e.show_reference_discussion?we(u([B(u([k("overlay p-[.5rem]")]),u([B(u([k("flex items-start justify-between width-full mb-[.5rem]")]),u([bn(u([k("pt-[.1rem] underline")]),u([rs(u([yi("/"+e.topic_id)]),u([te(e.topic_title)]))])),je(u([Se(new Cn),k("icon-button p-[.3rem]")]),u([ls(u([]))]))])),B(u([k("flex flex-col overflow-auto max-h-[30rem] gap-[.5rem]")]),tr(e.current_thread_notes,r=>v(r.significance,new Re)?new x(Nt(u([]),u([te(r.message+(Ze(r.expanded_message)?"^":""))]))):new g(void 0)))]))])):we(u([B(u([k("overlay p-[.5rem]")]),u([Rc(e),Ze(e.active_thread)||li(e.current_thread_notes)>0?B(u([he("comment-list"),k("flex flex-col-reverse overflow-auto max-h-[30rem] gap-[.5rem] mb-[.5rem]")]),Zc(e)):we(u([])),tf(e)])),Vc(e)]))]))}function Nu(){return xo(Uc,Xc,rf,Dr(u([["dsc-data",e=>{let t=ae(e,T);if(t.isOk()){let r=t[0],n=A("topic_id",T,s=>A("topic_title",T,o=>A("line_number",We,l=>A("reference",rr(T),c=>Fe([s,o,l,c]))))),i=Yr(r,n);if(i.isOk()){let s=i[0][0],o=i[0][1],l=i[0][2],c=i[0][3];return new x(new On(s,o,l,c))}else return new g(u([new Y("dsc-data",Ne(e),u([]))]))}else return new g(u([new Y("dsc-data",Ne(e),u([]))]))}],["dsc",e=>{let t=Bu(e);if(t.isOk()){let r=t[0];return new x(new Ln(r))}else return new g(u([new Y("line-discussion",Ne(e),u([]))]))}]])))}var Fu=Su;function nf(e,t,r){let n="\x1B[90m",i="\x1B[39m",s=`${t}:${r}`,o=qe(e);if(typeof process=="object"&&process.stderr?.write){let l=`${n}${s}${i}
${o}
`;process.stderr.write(l)}else if(typeof Deno=="object"){let l=`${n}${s}${i}
${o}
`;Deno.stderr.writeSync(new TextEncoder().encode(l))}else{let l=`${s}
${o}`;console.log(l)}return e}function sf(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];n==`
`?t+="\\n":n=="\r"?t+="\\r":n=="	"?t+="\\t":n=="\f"?t+="\\f":n=="\\"?t+="\\\\":n=='"'?t+='\\"':n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}return t+='"',t}function of(e){let t="dict.from_list([",r=!0,n=[];return e.forEach((i,s)=>{n.push([s,i])}),n.sort(),n.forEach(([i,s])=>{r||(t=t+", "),t=t+"#("+qe(i)+", "+qe(s)+")",r=!1}),t+"])"}function uf(e){let t=Object.keys(e).map(r=>{let n=qe(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function lf(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let s of Object.keys(e))r.push(`${qe(s)}: ${qe(e[s])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function qe(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return sf(e);if(t==="bigint"||t==="number")return e.toString();if(Array.isArray(e))return`#(${e.map(qe).join(", ")})`;if(e instanceof E)return`[${e.toArray().map(qe).join(", ")}]`;if(e instanceof bt)return`//utfcodepoint(${String.fromCodePoint(e.value)})`;if(e instanceof ce)return af(e);if(e instanceof a)return uf(e);if(cf(e))return of(e);if(e instanceof Set)return`//js(Set(${[...e].map(qe).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return lf(e)}function af(e){let t=e.bitOffset+8*Math.trunc(e.bitSize/8),r=Jn(e,e.bitOffset,t),n=e.bitSize%8;if(n>0){let i=$s(e,t,e.bitSize,!1,!1),s=Array.from(r.rawBuffer),o=`${i}:size(${n})`;return s.length===0?`<<${o}>>`:`<<${Array.from(r.rawBuffer).join(", ")}, ${o}>>`}else return`<<${Array.from(r.rawBuffer).join(", ")}>>`}function cf(e){try{return e instanceof se}catch{return!1}}ji(Nu(),Fu);
