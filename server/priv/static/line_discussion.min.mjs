var a=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},M=class{static fromArray(t,r){let n=r||new Gt;for(let i=t.length-1;i>=0;--i)n=new He(t[i],n);return n}[Symbol.iterator](){return new In(this)}toArray(){return[...this]}atLeastLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return r!==void 0}hasLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return t===-1&&r instanceof Gt}countLength(){let t=this,r=0;for(;t;)t=t.tail,r++;return r-1}};function $(e,t){return new He(e,t)}function u(e,t){return M.fromArray(e,t)}var In=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Gt)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},Gt=class extends M{},He=class extends M{constructor(t,r){super(),this.head=t,this.tail=r}},ae=class{bitSize;byteSize;bitOffset;rawBuffer;constructor(t,r,n){if(!(t instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=r??t.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=n??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(t.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=t}byteAt(t){if(!(t<0||t>=this.byteSize))return Rt(this.rawBuffer,this.bitOffset,t)}equals(t){if(this.bitSize!==t.bitSize)return!1;let r=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&t.bitOffset===0){for(let i=0;i<r;i++)if(this.rawBuffer[i]!==t.rawBuffer[i])return!1;let n=this.bitSize%8;if(n){let i=8-n;if(this.rawBuffer[r]>>i!==t.rawBuffer[r]>>i)return!1}}else{for(let i=0;i<r;i++){let s=Rt(this.rawBuffer,this.bitOffset,i),o=Rt(t.rawBuffer,t.bitOffset,i);if(s!==o)return!1}let n=this.bitSize%8;if(n){let i=Rt(this.rawBuffer,this.bitOffset,r),s=Rt(t.rawBuffer,t.bitOffset,r),o=8-n;if(i>>o!==s>>o)return!1}}return!0}get buffer(){if(cs("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(cs("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}};function Rt(e,t,r){if(t===0)return e[r]??0;{let n=e[r]<<t&255,i=e[r+1]>>8-t;return n|i}}var yt=class{constructor(t){this.value=t}},as={};function cs(e,t){as[e]||(console.warn(`Deprecated BitArray.${e} property used in JavaScript FFI code. ${t}.`),as[e]=!0)}function qn(e,t,r){if(r??=e.bitSize,_s(e,t,r),t===r)return new ae(new Uint8Array);if(t===0&&r===e.bitSize)return e;t+=e.bitOffset,r+=e.bitOffset;let n=Math.trunc(t/8),s=Math.trunc((r+7)/8)-n,o;return n===0&&s===e.rawBuffer.byteLength?o=e.rawBuffer:o=new Uint8Array(e.rawBuffer.buffer,e.rawBuffer.byteOffset+n,s),new ae(o,r-t,t%8)}function ps(e,t,r,n,i){if(_s(e,t,r),t===r)return 0;t+=e.bitOffset,r+=e.bitOffset;let s=t%8===0,o=r%8===0;if(s&&o)return Nu(e,t/8,r/8,n,i);let l=r-t,c=Math.trunc(t/8),p=Math.trunc((r-1)/8);if(c==p){let f=255>>t%8,_=(8-r%8)%8,h=(e.rawBuffer[c]&f)>>_;if(i){let m=2**(l-1);h>=m&&(h-=m*2)}return h}return l<=53?Ju(e.rawBuffer,t,r,n,i):Pu(e.rawBuffer,t,r,n,i)}function Nu(e,t,r,n,i){return r-t<=6?Fu(e.rawBuffer,t,r,n,i):Wu(e.rawBuffer,t,r,n,i)}function Fu(e,t,r,n,i){let s=r-t,o=0;if(n)for(let l=t;l<r;l++)o*=256,o+=e[l];else for(let l=r-1;l>=t;l--)o*=256,o+=e[l];if(i){let l=2**(s*8-1);o>=l&&(o-=l*2)}return o}function Wu(e,t,r,n,i){let s=r-t,o=0n;if(n)for(let l=t;l<r;l++)o*=256n,o+=BigInt(e[l]);else for(let l=r-1;l>=t;l--)o*=256n,o+=BigInt(e[l]);if(i){let l=1n<<BigInt(s*8-1);o>=l&&(o-=l*2n)}return Number(o)}function Ju(e,t,r,n,i){let s=t%8===0,o=r-t,l=Math.trunc(t/8),c=0;if(n){if(!s){let p=8-t%8;c=e[l++]&(1<<p)-1,o-=p}for(;o>=8;)c*=256,c+=e[l++],o-=8;o>0&&(c*=2**o,c+=e[l]>>8-o)}else if(s){let p=r-t,f=1;for(;p>=8;)c+=e[l++]*f,f*=256,p-=8;c+=(e[l]>>8-p)*f}else{let p=t%8,f=8-p,_=r-t,h=1;for(;_>=8;){let m=e[l]<<p|e[l+1]>>f;c+=(m&255)*h,h*=256,_-=8,l++}if(_>0){let m=_-Math.max(0,_-f),y=(e[l]&(1<<f)-1)>>f-m;_-=m,_>0&&(y*=2**_,y+=e[l+1]>>8-_),c+=y*h}}if(i){let p=2**(r-t-1);c>=p&&(c-=p*2)}return c}function Pu(e,t,r,n,i){let s=t%8===0,o=r-t,l=Math.trunc(t/8),c=0n;if(n){if(!s){let p=8-t%8;c=BigInt(e[l++]&(1<<p)-1),o-=p}for(;o>=8;)c*=256n,c+=BigInt(e[l++]),o-=8;o>0&&(c<<=BigInt(o),c+=BigInt(e[l]>>8-o))}else if(s){let p=r-t,f=0n;for(;p>=8;)c+=BigInt(e[l++])<<f,f+=8n,p-=8;c+=BigInt(e[l]>>8-p)<<f}else{let p=t%8,f=8-p,_=r-t,h=0n;for(;_>=8;){let m=e[l]<<p|e[l+1]>>f;c+=BigInt(m&255)<<h,h+=8n,_-=8,l++}if(_>0){let m=_-Math.max(0,_-f),y=(e[l]&(1<<f)-1)>>f-m;_-=m,_>0&&(y<<=_,y+=e[l+1]>>8-_),c+=BigInt(y)<<h}}if(i){let p=2n**BigInt(r-t-1);c>=p&&(c-=p*2n)}return Number(c)}function _s(e,t,r){if(t<0||t>e.bitSize||r<t||r>e.bitSize){let n=`Invalid bit array slice: start = ${t}, end = ${r}, bit size = ${e.bitSize}`;throw new globalThis.Error(n)}}var bt=class e extends a{static isResult(t){return t instanceof e}},x=class extends bt{constructor(t){super(),this[0]=t}isOk(){return!0}},g=class extends bt{constructor(t){super(),this[0]=t}isOk(){return!1}};function v(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!fs(n)||!fs(i)||!Vu(n,i)||Hu(n,i)||Uu(n,i)||Ru(n,i)||Gu(n,i)||Zu(n,i)||Ku(n,i))return!1;let o=Object.getPrototypeOf(n);if(o!==null&&typeof o.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[l,c]=Yu(n);for(let p of l(n))r.push(c(n,p),c(i,p))}return!0}function Yu(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function Hu(e,t){return e instanceof Date&&(e>t||e<t)}function Uu(e,t){return!(e instanceof ae)&&e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function Ru(e,t){return Array.isArray(e)&&e.length!==t.length}function Gu(e,t){return e instanceof Map&&e.size!==t.size}function Zu(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function Ku(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function fs(e){return typeof e=="object"&&e!==null}function Vu(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function Q(e,t){return t===0?0:e%t}function I(e,t){return Math.trunc(vt(e,t))}function vt(e,t){return t===0?0:e/t}function ce(e,t,r,n,i,s){let o=new globalThis.Error(i);o.gleam_error=e,o.module=t,o.line=r,o.function=n,o.fn=n;for(let l in s)o[l]=s[l];return o}var w=class extends a{constructor(t){super(),this[0]=t}},b=class extends a{};function Dn(e){return!v(e,new b)}function ds(e,t){if(e instanceof w){let r=e[0];return new x(r)}else return new g(t)}function jr(e,t){return e instanceof w?e[0]:t}function Sr(e,t){if(e instanceof w){let r=e[0];return new w(t(r))}else return new b}function ms(e){return e instanceof w?e[0]:new b}var $s=new WeakMap,zn=new DataView(new ArrayBuffer(8)),Cn=0;function Nn(e){let t=$s.get(e);if(t!==void 0)return t;let r=Cn++;return Cn===2147483647&&(Cn=0),$s.set(e,r),r}function Fn(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Jn(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function xs(e){zn.setFloat64(0,e);let t=zn.getInt32(0),r=zn.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function Qu(e){return Jn(e.toString())}function Xu(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return Nn(e);if(e instanceof Date)return xs(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+ne(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+ne(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+Fn(ne(n),ne(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];r=r+Fn(ne(o),Jn(s))|0}}return r}function ne(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return xs(e);case"string":return Jn(e);case"bigint":return Qu(e);case"object":return Xu(e);case"symbol":return Nn(e);case"function":return Nn(e);default:return 0}}var ge=5,Pn=Math.pow(2,ge),el=Pn-1,tl=Pn/2,rl=Pn/4,H=0,we=1,X=2,Ue=3,Yn={type:X,bitmap:0,array:[]};function Zt(e,t){return e>>>t&el}function Mr(e,t){return 1<<Zt(e,t)}function nl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Hn(e,t){return nl(e&t-1)}function ie(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function il(e,t,r){let n=e.length,i=new Array(n+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=r;s<n;)i[o++]=e[s++];return i}function Wn(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function ws(e,t,r,n,i,s){let o=ne(t);if(o===n)return{type:Ue,hash:o,array:[{type:H,k:t,v:r},{type:H,k:i,v:s}]};let l={val:!1};return Kt(Un(Yn,e,o,t,r,l),e,n,i,s,l)}function Kt(e,t,r,n,i,s){switch(e.type){case we:return sl(e,t,r,n,i,s);case X:return Un(e,t,r,n,i,s);case Ue:return ol(e,t,r,n,i,s)}}function sl(e,t,r,n,i,s){let o=Zt(r,t),l=e.array[o];if(l===void 0)return s.val=!0,{type:we,size:e.size+1,array:ie(e.array,o,{type:H,k:n,v:i})};if(l.type===H)return v(n,l.k)?i===l.v?e:{type:we,size:e.size,array:ie(e.array,o,{type:H,k:n,v:i})}:(s.val=!0,{type:we,size:e.size,array:ie(e.array,o,ws(t+ge,l.k,l.v,r,n,i))});let c=Kt(l,t+ge,r,n,i,s);return c===l?e:{type:we,size:e.size,array:ie(e.array,o,c)}}function Un(e,t,r,n,i,s){let o=Mr(r,t),l=Hn(e.bitmap,o);if(e.bitmap&o){let c=e.array[l];if(c.type!==H){let f=Kt(c,t+ge,r,n,i,s);return f===c?e:{type:X,bitmap:e.bitmap,array:ie(e.array,l,f)}}let p=c.k;return v(n,p)?i===c.v?e:{type:X,bitmap:e.bitmap,array:ie(e.array,l,{type:H,k:n,v:i})}:(s.val=!0,{type:X,bitmap:e.bitmap,array:ie(e.array,l,ws(t+ge,p,c.v,r,n,i))})}else{let c=e.array.length;if(c>=tl){let p=new Array(32),f=Zt(r,t);p[f]=Un(Yn,t+ge,r,n,i,s);let _=0,h=e.bitmap;for(let m=0;m<32;m++){if(h&1){let y=e.array[_++];p[m]=y}h=h>>>1}return{type:we,size:c+1,array:p}}else{let p=il(e.array,l,{type:H,k:n,v:i});return s.val=!0,{type:X,bitmap:e.bitmap|o,array:p}}}}function ol(e,t,r,n,i,s){if(r===e.hash){let o=Rn(e,n);if(o!==-1)return e.array[o].v===i?e:{type:Ue,hash:r,array:ie(e.array,o,{type:H,k:n,v:i})};let l=e.array.length;return s.val=!0,{type:Ue,hash:r,array:ie(e.array,l,{type:H,k:n,v:i})}}return Kt({type:X,bitmap:Mr(e.hash,t),array:[e]},t,r,n,i,s)}function Rn(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(v(t,e.array[n].k))return n;return-1}function Ar(e,t,r,n){switch(e.type){case we:return ul(e,t,r,n);case X:return ll(e,t,r,n);case Ue:return al(e,n)}}function ul(e,t,r,n){let i=Zt(r,t),s=e.array[i];if(s!==void 0){if(s.type!==H)return Ar(s,t+ge,r,n);if(v(n,s.k))return s}}function ll(e,t,r,n){let i=Mr(r,t);if(!(e.bitmap&i))return;let s=Hn(e.bitmap,i),o=e.array[s];if(o.type!==H)return Ar(o,t+ge,r,n);if(v(n,o.k))return o}function al(e,t){let r=Rn(e,t);if(!(r<0))return e.array[r]}function Gn(e,t,r,n){switch(e.type){case we:return cl(e,t,r,n);case X:return fl(e,t,r,n);case Ue:return pl(e,n)}}function cl(e,t,r,n){let i=Zt(r,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===H){if(!v(s.k,n))return e}else if(o=Gn(s,t+ge,r,n),o===s)return e;if(o===void 0){if(e.size<=rl){let l=e.array,c=new Array(e.size-1),p=0,f=0,_=0;for(;p<i;){let h=l[p];h!==void 0&&(c[f]=h,_|=1<<p,++f),++p}for(++p;p<l.length;){let h=l[p];h!==void 0&&(c[f]=h,_|=1<<p,++f),++p}return{type:X,bitmap:_,array:c}}return{type:we,size:e.size-1,array:ie(e.array,i,o)}}return{type:we,size:e.size,array:ie(e.array,i,o)}}function fl(e,t,r,n){let i=Mr(r,t);if(!(e.bitmap&i))return e;let s=Hn(e.bitmap,i),o=e.array[s];if(o.type!==H){let l=Gn(o,t+ge,r,n);return l===o?e:l!==void 0?{type:X,bitmap:e.bitmap,array:ie(e.array,s,l)}:e.bitmap===i?void 0:{type:X,bitmap:e.bitmap^i,array:Wn(e.array,s)}}return v(n,o.k)?e.bitmap===i?void 0:{type:X,bitmap:e.bitmap^i,array:Wn(e.array,s)}:e}function pl(e,t){let r=Rn(e,t);if(r<0)return e;if(e.array.length!==1)return{type:Ue,hash:e.hash,array:Wn(e.array,r)}}function gs(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===H){t(s.v,s.k);continue}gs(s,t)}}}var se=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=Ar(this.root,0,ne(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?Yn:this.root,s=Kt(i,0,ne(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=Gn(this.root,0,ne(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:Ar(this.root,0,ne(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){gs(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+Fn(ne(r),ne(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;try{return this.forEach((r,n)=>{if(!v(t.get(n,!r),r))throw hs}),!0}catch(r){if(r===hs)return!1;throw r}}},hs=Symbol();var Zn=void 0,ys={};function Re(e){return/^[-+]?(\d+)$/.test(e)?new x(parseInt(e)):new g(Zn)}function E(e){return e.toString()}function Er(e){let t=e.toString().replace("+","");if(t.indexOf(".")>=0)return t;{let r=t.indexOf("e");return r>=0?t.slice(0,r)+".0"+t.slice(r):t+".0"}}var bs;function ml(e){if(globalThis.Intl&&Intl.Segmenter)return bs||=new Intl.Segmenter,bs.segment(e)[Symbol.iterator]()}function ks(e){let t,r=ml(e);return r?t=r.next().value?.segment:t=e.match(/./su)?.[0],t?new x([t,e.slice(t.length)]):new g(Zn)}function qe(e){let t="";for(let r of e)t=t+r;return t}var Os=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),$l=new RegExp(`^[${Os}]*`),hl=new RegExp(`[${Os}]*$`);function Ls(e){return e.replace($l,"")}function js(e){return e.replace(hl,"")}function Kn(e){console.log(e)}function Vt(e){return Math.floor(e)}function Vn(e){return Math.round(e)}function Qt(){let e=Math.random();return e===1?Qt():e}function K(){return se.new()}function Tr(e){return M.fromArray(e.entries())}function Ss(e,t){return t.delete(e)}function oe(e,t){let r=e.get(t,ys);return r===ys?new g(Zn):new x(r)}function As(e,t,r){return r.set(e,t)}function ue(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof bt)return"Result";if(e instanceof M)return"List";if(e instanceof ae)return"BitArray";if(e instanceof se)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function Qn(e,t){return xl(e,ue(t))}function xl(e,t){return new g(M.fromArray([new q(e,t,M.fromArray([]))]))}function Xn(e){return typeof e=="string"?new x(e):Qn("String",e)}function Ms(e){return Number.isInteger(e)?new x(e):Qn("Int",e)}function Es(e,t){let r=()=>Qn("Dict",e);if(e instanceof se||e instanceof WeakMap||e instanceof Map){let n=oe(e,t);return new x(n.isOk()?new w(n[0]):new b)}else return e===null?r():Object.getPrototypeOf(e)==Object.prototype?vs(e,t,()=>new x(new b)):vs(e,t,r)}function vs(e,t,r){try{return t in e?new x(new w(e[t])):r()}catch{return r()}}function ye(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return wl(e);if(t==="bigint"||Number.isInteger(e))return e.toString();if(t==="number")return Er(e);if(Array.isArray(e))return`#(${e.map(ye).join(", ")})`;if(e instanceof M)return vl(e);if(e instanceof yt)return Ol(e);if(e instanceof ae)return kl(e);if(e instanceof a)return bl(e);if(e instanceof se)return gl(e);if(e instanceof Set)return`//js(Set(${[...e].map(ye).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return yl(e)}function wl(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];switch(n){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}}return t+='"',t}function gl(e){let t="dict.from_list([",r=!0;return e.forEach((n,i)=>{r||(t=t+", "),t=t+"#("+ye(i)+", "+ye(n)+")",r=!1}),t+"])"}function yl(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let s of Object.keys(e))r.push(`${ye(s)}: ${ye(e[s])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function bl(e){let t=Object.keys(e).map(r=>{let n=ye(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function vl(e){return`[${e.toArray().map(ye).join(", ")}]`}function kl(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function Ol(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function Sl(e){return-1*e}function Br(e){return e>=0?Vn(e):0-Vn(Sl(e))}function ei(e){let t=Qt()*e,r=Vt(t);return Br(r)}function be(e,t,r){return As(t,r,e)}function Ml(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head[0],s=r.head[1];e=r.tail,t=be(n,i,s)}}}function Ir(e){return Ml(e,K())}function El(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function Tl(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return El(n,u([]));{let i=r.head[0];e=r.tail,t=$(i,n)}}}function ti(e){return Tl(Tr(e),u([]))}function ri(e,t){return Ss(t,e)}function Il(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1))e=r.tail,t=n+1;else return n}}function ni(e){return Il(e,0)}function ql(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function W(e){return ql(e,u([]))}function Ts(e){if(e.hasLength(0))return new g(void 0);{let t=e.head;return new x(t)}}function Dl(e){return(t,r)=>{let n=oe(t,e(r));if(n.isOk()){let i=n[0];return be(t,e(r),$(r,i))}else return be(t,e(r),u([r]))}}function zl(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return W(s);{let o=n.head;e=n.tail,t=i,r=$(i(o),s)}}}function U(e,t){return zl(e,t,u([]))}function Cl(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=$(i,n)}}}function Ot(e,t){return Cl(W(e),t)}function le(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let o=n.head;e=n.tail,t=s(i,o),r=s}}}function Bs(e,t){return le(e,K(),Dl(t))}function Nl(e,t,r,n){for(;;){let i=e,s=t,o=r,l=n;if(i.hasLength(0))return s;{let c=i.head;e=i.tail,t=o(s,c,l),r=o,n=l+1}}}function Dr(e,t,r){return Nl(e,t,r,0)}function oi(e){let r=Ls(e);return js(r)}function zr(e,t){for(;;){let r=e,n=t;if(n>0){let s=ks(r);if(s.isOk())e=s[0][1],t=n-1;else return r}else return r}}function ze(e){let t=ye(e);return t}function Ns(e){return!!e.isOk()}function fe(e,t){if(e.isOk()){let r=e[0];return new x(t(r))}else{let r=e[0];return new g(r)}}function Ae(e,t){if(e.isOk()){let r=e[0];return new x(r)}else{let r=e[0];return new g(t(r))}}function J(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new g(r)}}function ui(e,t){return J(e,t)}function jt(e,t){return e.isOk()?e[0]:t}function Me(e,t){if(e.isOk()){let r=e[0];return new x(r)}else return new g(t)}var q=class extends a{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};function Xl(e,t){return Ae(e,r=>U(r,t))}function Fs(e){return Xn(e)}function Ws(e){return t=>{if(e.hasLength(0))return new g(u([new q("another type",ue(t),u([]))]));{let r=e.head,n=e.tail,i=r(t);if(i.isOk()){let s=i[0];return new x(s)}else return Ws(n)(t)}}}function ea(e,t){let r=t,n=Ws(u([Xn,o=>fe(Ms(o),E)])),i=(()=>{let o=n(r);if(o.isOk())return o[0];{let l=u(["<",ue(r),">"]),c=qe(l);return c}})(),s=e;return new q(s.expected,s.found,$(i,e.path))}function li(e,t){return r=>{let n=new q("field","nothing",u([]));return J(Es(r,e),i=>{let o=ds(i,u([n])),l=J(o,t);return Xl(l,c=>ea(c,e))})}}function Js(e,t){let r=Number.isInteger(t);if(e instanceof se||e instanceof WeakMap||e instanceof Map){let n={},i=e.get(t,n);return i===n?new x(new b):new x(new w(i))}if(Number.isInteger(t)&&t<8&&e instanceof M){let n=0;for(let i of e){if(n===t)return new x(new w(i));n++}return new g("Indexable")}return r&&Array.isArray(e)||e&&typeof e=="object"||e&&Object.getPrototypeOf(e)===Object.prototype?t in e?new x(new w(e[t])):new x(new b):new g(r?"Indexable":"Dict")}function Ps(e,t,r,n,i){if(!(e instanceof M||Array.isArray(e))){let o=new pe("List",ue(e),i);return[i,M.fromArray([o])]}let s=[];for(let o of e){let l=t(o),[c,p]=l;if(p instanceof He){let[f,_]=r(l,n.toString());return[i,_]}s.push(c),n++}return[M.fromArray(s),i]}function Ys(e){return Number.isInteger(e)?new x(e):new g(0)}function Hs(e){return typeof e=="string"?new x(e):new g(0)}function Us(e){return e==null}var pe=class extends a{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}},_e=class extends a{constructor(t){super(),this.function=t}};function te(e,t){let r=t.function(e),n=r[0],i=r[1];return i.hasLength(0)?new x(n):new g(i)}function Ze(e){return new _e(t=>[e,u([])])}function ta(e,t){return new _e(r=>{let n=e.function(r),i=n[0],s=n[1];return[t(i),s]})}function ra(e,t,r){for(;;){let n=e,i=t,s=r;if(s.hasLength(0))return i;{let o=s.head,l=s.tail,c=o.function(n),p=c;if(c[1].hasLength(0))return p;e=n,t=i,r=l}}}function na(e,t){return new _e(r=>{let n=e.function(r),i=n;return n[1].hasLength(0)?i:ra(r,i,t)})}function ci(e){return new _e(t=>{if(Us(t))return[new b,u([])];{let n=e.function(t),i=n[0],s=n[1];return[new w(i),s]}})}function ia(e,t){return u([new pe(e,ue(t),u([]))])}function Rs(e,t,r){let n=r(e);return n.isOk()?[n[0],u([])]:[n[0],u([new pe(t,ue(e),u([]))])]}function sa(e){return v(!0,e)?[!0,u([])]:v(!1,e)?[!1,u([])]:[!1,ia("Bool",e)]}function oa(e){return Rs(e,"Int",Ys)}var St=new _e(sa),At=new _e(oa);function ua(e){return Rs(e,"String",Hs)}var z=new _e(ua);function Gs(e){return new _e(t=>Ps(t,e.function,(r,n)=>Cr(r,u([n])),0,u([])))}function Cr(e,t){let r=na(z,u([ta(At,E)])),n=U(t,s=>{let o=s,l=te(o,r);return l.isOk()?l[0]:"<"+ue(o)+">"}),i=U(e[1],s=>{let o=s;return new pe(o.expected,o.found,Ot(n,s.path))});return[e[0],i]}function la(e,t,r,n,i){for(;;){let s=e,o=t,l=r,c=n,p=i;if(s.hasLength(0)){let f=l(c);return Cr(f,W(o))}else{let f=s.head,_=s.tail,h=Js(c,f);if(h.isOk()&&h[0]instanceof w){let m=h[0][0];e=_,t=$(f,o),r=l,n=m,i=p}else{if(h.isOk()&&h[0]instanceof b)return p(c,$(f,o));{let m=h[0],re=[l(c)[0],u([new pe(m,ue(c),u([]))])];return Cr(re,W(o))}}}}}function Zs(e,t,r){return new _e(n=>{let i=la(e,u([]),t.function,n,(f,_)=>{let y=[t.function(f)[0],u([new pe("Field","Nothing",u([]))])];return Cr(y,W(_))}),s=i[0],o=i[1],l=r(s).function(n),c=l[0],p=l[1];return[c,Ot(o,p)]})}function Y(e,t,r){return Zs(u([e]),t,r)}function fi(e,t,r){return e?t():r()}function Ks(e){return Object.fromEntries(e)}function Vs(){return null}function Qs(e){try{let t=JSON.parse(e);return new x(t)}catch(t){return new g(ca(t,e))}}function ca(e,t){return fa(e)?new Fr:pa(e,t)}function fa(e){return/((unexpected (end|eof))|(end of data)|(unterminated string)|(json( parse error|\.parse)\: expected '(\:|\}|\])'))/i.test(e.message)}function pa(e,t){let r=[_a,da,$a,ma];for(let n of r){let i=n(e,t);if(i)return i}return new Ce("",0)}function _a(e){let r=/unexpected token '(.)', ".+" is not valid JSON/i.exec(e.message);if(!r)return null;let n=Nr(r[1]);return new Ce(n,-1)}function da(e){let r=/unexpected token (.) in JSON at position (\d+)/i.exec(e.message);if(!r)return null;let n=Nr(r[1]),i=Number(r[2]);return new Ce(n,i)}function ma(e,t){let n=/(unexpected character|expected .*) at line (\d+) column (\d+)/i.exec(e.message);if(!n)return null;let i=Number(n[2]),s=Number(n[3]),o=ha(i,s,t),l=Nr(t[o]);return new Ce(l,o)}function $a(e){let r=/unexpected (identifier|token) "(.)"/i.exec(e.message);if(!r)return null;let n=Nr(r[2]);return new Ce(n,0)}function Nr(e){return"0x"+e.charCodeAt(0).toString(16).toUpperCase()}function ha(e,t,r){if(e===1)return t-1;let n=1,i=0;return r.split("").find((s,o)=>(s===`
`&&(n+=1),n===e?(i=o+t,!0):!1)),i}var Fr=class extends a{},Ce=class extends a{constructor(t){super(),this[0]=t}};var _i=class extends a{constructor(t){super(),this[0]=t}};function wa(e,t){return ui(Qs(e),r=>{let n=te(r,t);return Ae(n,i=>new _i(i))})}function Xs(e,t){return wa(e,t)}function de(e){return e}function T(e){return e}function eo(){return Vs()}function to(e,t){if(e instanceof w){let r=e[0];return t(r)}else return eo()}function me(e){return Ks(e)}var Wr=class extends a{constructor(t){super(),this.all=t}};function mi(e){return new Wr(u([t=>e(t.dispatch,t.emit,t.select,t.root)]))}function ro(e){return mi((t,r,n,i)=>e(t))}function no(e,t){return mi((r,n,i,s)=>n(e,t))}function C(){return new Wr(u([]))}var Mt=class extends a{constructor(t){super(),this.content=t}},A=class extends a{constructor(t,r,n,i,s,o,l){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=s,this.self_closing=o,this.void=l}},tr=class extends a{constructor(t){super(),this.subtree=t}},Et=class extends a{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}},rr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};function ka(e){if(e instanceof Et)return new g(void 0);{let t=e[0],r=e[1],n=zr(t,2);return new x([n,r])}}function Oa(e,t,r){return Dr(e,t,(n,i,s)=>{let o=r+"-"+E(s);return io(i,n,o)})}function io(e,t,r){for(;;){let n=e,i=t,s=r;if(n instanceof Mt)return i;if(n instanceof tr){let o=n.subtree;e=o(),t=i,r=s}else{let o=n.attrs,l=n.children,c=le(o,i,(p,f)=>{let _=ka(f);if(_.isOk()){let h=_[0][0],m=_[0][1];return be(p,s+"-"+h,m)}else return p});return Oa(l,c,s)}}}function so(e){return io(e,K(),"0")}function d(e,t){return new Et(e,t,!1)}function uo(e,t){return new rr("on"+e,t)}function lo(e){return d("style",le(e,"",(t,r)=>{let n=r[0],i=r[1];return t+n+":"+i+";"}))}function k(e){return d("class",e)}function $e(e){return d("id",e)}function ao(e){return d("value",e)}function $i(e){return d("placeholder",e)}function ke(e,t,r){return e==="area"?new A("","",e,t,u([]),!1,!0):e==="base"?new A("","",e,t,u([]),!1,!0):e==="br"?new A("","",e,t,u([]),!1,!0):e==="col"?new A("","",e,t,u([]),!1,!0):e==="embed"?new A("","",e,t,u([]),!1,!0):e==="hr"?new A("","",e,t,u([]),!1,!0):e==="img"?new A("","",e,t,u([]),!1,!0):e==="input"?new A("","",e,t,u([]),!1,!0):e==="link"?new A("","",e,t,u([]),!1,!0):e==="meta"?new A("","",e,t,u([]),!1,!0):e==="param"?new A("","",e,t,u([]),!1,!0):e==="source"?new A("","",e,t,u([]),!1,!0):e==="track"?new A("","",e,t,u([]),!1,!0):e==="wbr"?new A("","",e,t,u([]),!1,!0):new A("","",e,t,r,!1,!1)}function Tt(e,t,r,n){return new A("",e,t,r,n,!1,!1)}function nr(e){return new Mt(e)}function Ee(e){return ke("lustre-fragment",u([lo(u([["display","contents"]]))]),e)}var ir=class extends a{constructor(t){super(),this.dict=t}};function Pr(){return new ir(K())}function wi(e,t){let r=e.dict,n=oe(r,t);return Ns(n)}function co(e,t){return new ir(ri(e.dict,t))}var La=void 0;function gi(e,t){return new ir(be(e.dict,t,La))}var Yr=class extends a{constructor(t){super(),this[0]=t}},Hr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Ur=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};function _o(e){return v(e.created,K())&&v(e.removed,Pr())&&v(e.updated,K())}var Rr=class extends a{constructor(t){super(),this[0]=t}},Gr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Bt=class extends a{constructor(t){super(),this[0]=t}},V=class extends a{constructor(t){super(),this[0]=t}},It=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Zr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}};var or=class extends a{},Kr=class extends a{constructor(t,r){super(),this[0]=t,this[1]=r}},Vr=class extends a{constructor(t){super(),this[0]=t}},ur=class extends a{constructor(t){super(),this[0]=t}};var yi=class extends a{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var Qr=class extends a{constructor(t){super(),this.name=t}},Xr=class extends a{constructor(t){super(),this.name=t}},en=class extends a{constructor(t){super(),this.selector=t}},lr=class extends a{};function mo(e,t,r,n){return new yi(e,t,r,new w(n))}globalThis.customElements&&!globalThis.customElements.get("lustre-fragment")&&globalThis.customElements.define("lustre-fragment",class extends HTMLElement{constructor(){super()}});function fr(e,t,r){let n,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:s,next:o,parent:l}=i.pop();for(;o.subtree!==void 0;)o=o.subtree();if(o.content!==void 0)if(s)if(s.nodeType===Node.TEXT_NODE)s.textContent!==o.content&&(s.textContent=o.content),n??=s;else{let c=document.createTextNode(o.content);l.replaceChild(c,s),n??=c}else{let c=document.createTextNode(o.content);l.appendChild(c),n??=c}else if(o.tag!==void 0){let c=Ba({prev:s,next:o,dispatch:r,stack:i});s?s!==c&&l.replaceChild(c,s):l.appendChild(c),n??=c}}return n}function Ba({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),o=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),l;if(ar.has(o))l=ar.get(o);else{let O=new Map;ar.set(o,O),l=O}let c=s?new Set(l.keys()):null,p=s?new Set(Array.from(e.attributes,O=>O.name)):null,f=null,_=null,h=null;if(s&&t.tag==="textarea"){let O=t.children[Symbol.iterator]().next().value?.content;O!==void 0&&(o.value=O)}let m=[];for(let O of t.attrs){let L=O[0],F=O[1];if(O.as_property)o[L]!==F&&(o[L]=F),s&&p.delete(L);else if(L.startsWith("on")){let xe=L.slice(2),Bn=r(F,xe==="input");l.has(xe)||o.addEventListener(xe,cr),l.set(xe,Bn),s&&c.delete(xe)}else if(L.startsWith("data-lustre-on-")){let xe=L.slice(15),Bn=r(Ia);l.has(xe)||o.addEventListener(xe,cr),l.set(xe,Bn),o.setAttribute(L,F),s&&(c.delete(xe),p.delete(L))}else L.startsWith("delegate:data-")||L.startsWith("delegate:aria-")?(o.setAttribute(L,F),m.push([L.slice(10),F])):L==="class"?f=f===null?F:f+" "+F:L==="style"?_=_===null?F:_+F:L==="dangerous-unescaped-html"?h=F:(o.getAttribute(L)!==F&&o.setAttribute(L,F),(L==="value"||L==="selected")&&(o[L]=F),s&&p.delete(L))}if(f!==null&&(o.setAttribute("class",f),s&&p.delete("class")),_!==null&&(o.setAttribute("style",_),s&&p.delete("style")),s){for(let O of p)o.removeAttribute(O);for(let O of c)l.delete(O),o.removeEventListener(O,cr)}if(t.tag==="slot"&&window.queueMicrotask(()=>{for(let O of o.assignedElements())for(let[L,F]of m)O.hasAttribute(L)||O.setAttribute(L,F)}),t.key!==void 0&&t.key!=="")o.setAttribute("data-lustre-key",t.key);else if(h!==null)return o.innerHTML=h,o;let y=o.firstChild,Z=null,re=null,he=null,Tn=tn(t).next().value;if(s&&Tn!==void 0&&Tn.key!==void 0&&Tn.key!==""){Z=new Set,re=$o(e),he=$o(t);for(let O of tn(t))y=qa(y,O,o,n,he,re,Z)}else for(let O of tn(t))n.unshift({prev:y,next:O,parent:o}),y=y?.nextSibling;for(;y;){let O=y.nextSibling;o.removeChild(y),y=O}return o}var ar=new WeakMap;function cr(e){let t=e.currentTarget;if(!ar.has(t)){t.removeEventListener(e.type,cr);return}let r=ar.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,cr);return}r.get(e.type)(e)}function Ia(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((s,o)=>{let l=o.split(".");for(let c=0,p=s,f=e;c<l.length;c++)c===l.length-1?p[l[c]]=f[l[c]]:(p[l[c]]??={},f=f[l[c]],p=p[l[c]]);return s},{data:n})}}function $o(e){let t=new Map;if(e)for(let r of tn(e)){let n=r?.key||r?.getAttribute?.("data-lustre-key");n&&t.set(n,r)}return t}function qa(e,t,r,n,i,s,o){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let c=e.nextSibling;r.removeChild(e),e=c}if(s.size===0)return n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e;if(o.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;o.add(t.key);let l=s.get(t.key);if(!l&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!l&&e!==null){let c=document.createTextNode("");return r.insertBefore(c,e),n.unshift({prev:c,next:t,parent:r}),e}return!l||l===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(l,e),n.unshift({prev:l,next:t,parent:r}),e)}function*tn(e){for(let t of e.children)yield*ho(t)}function*ho(e){e.subtree!==void 0?yield*ho(e.subtree()):yield e}var ki=class e{static start({init:t,update:r,view:n},i,s){if(!vi())return new g(new lr);let o=i instanceof HTMLElement?i:document.querySelector(i);if(!o)return new g(new en(i));let l=new e(o,t(s),r,n);return new x(c=>l.send(c))}constructor(t,[r,n],i,s){this.root=t,this.#e=r,this.#s=i,this.#r=s,this.#t=window.setTimeout(()=>this.#i(n.all.toArray(),!0),0)}root;send(t){if(t instanceof Bt){if(t[0]instanceof ur){this.#t=window.clearTimeout(this.#t),this.#n=[],this.#e=t[0][0];let r=this.#r(this.#e),n=(s,o=!1)=>l=>{let c=s(l);c instanceof x&&this.send(new V(c[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));fr(i,r,n)}}else if(t instanceof V){let r=t[0],n=t[1]??!1;this.#n.push(r),n?(this.#t=window.clearTimeout(this.#t),this.#i()):this.#t||(this.#t=window.setTimeout(()=>this.#i()))}else if(t instanceof It){let r=t[0],n=t[1];this.root.dispatchEvent(new CustomEvent(r,{detail:n,bubbles:!0,composed:!0}))}else if(t instanceof or)for(this.#t=window.clearTimeout(this.#t),this.#e=null,this.#s=null,this.#r=null,this.#n=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#s;#r;#n=[];#t;#i(t=[]){this.#t=void 0,this.#o(t);let r=this.#r(this.#e),n=(s,o=!1)=>l=>{let c=s(l);c instanceof x&&this.send(new V(c[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));fr(i,r,n)}#o(t=[]){for(;this.#n.length>0;){let r=this.#n.shift(),[n,i]=this.#s(this.#e,r);t=t.concat(i.all.toArray()),this.#e=n}for(;t.length>0;){let r=t.shift(),n=l=>this.send(new V(l)),i=(l,c)=>this.root.dispatchEvent(new CustomEvent(l,{detail:c,bubbles:!0,composed:!0})),s=()=>{},o=this.root;r({dispatch:n,emit:i,select:s,root:o})}this.#n.length>0&&this.#o(t)}},Ea=ki.start,bi=({init:e,update:t,view:r,on_attribute_change:n},i)=>{if(!vi())return new g(new lr);if(!i.includes("-"))return new g(new Qr(i));if(window.customElements.get(i))return new g(new Xr(i));let[s,o]=e(void 0),l=n instanceof w,c=class extends HTMLElement{static get observedAttributes(){return l?n[0].entries().map(([f])=>f):[]}constructor(){super(),this.attachShadow({mode:"open"}),this.internals=this.attachInternals(),l&&n[0].forEach((f,_)=>{let h=`__mirrored__${_}`;Object.defineProperty(this,_,{get(){return this[h]},set(m){let y=this[h];if(this.#t&&v(y,m))return;this[h]=m;let Z=f(m);Z instanceof g||(this.#r.push(Z[0]),this.#t&&!this.#n&&(this.#n=window.requestAnimationFrame(()=>this.#i())))}})})}connectedCallback(){this.#u().finally(()=>{this.#i(o.all.toArray(),!0),this.#t=!0})}attributeChangedCallback(f,_,h){_!==h&&(this[f]=h)}disconnectedCallback(){this.#s=null,this.#r=[],this.#n=window.cancelAnimationFrame(this.#n),this.#t=!1}send(f){if(f instanceof Bt){if(f[0]instanceof ur){this.#n=window.cancelAnimationFrame(this.#n),this.#r=[],this.#s=f[0][0];let _=r(this.#s),h=(y,Z=!1)=>re=>{let he=y(re);he instanceof x&&this.send(new V(he[0],Z))},m=this.shadowRoot.childNodes[this.#e.length]??this.shadowRoot.appendChild(document.createTextNode(""));fr(m,_,h)}}else if(f instanceof V){let _=f[0],h=f[1]??!1;this.#r.push(_),h?(this.#n=window.cancelAnimationFrame(this.#n),this.#i()):this.#n||(this.#n=window.requestAnimationFrame(()=>this.#i()))}else if(f instanceof It){let _=f[0],h=f[1];this.dispatchEvent(new CustomEvent(_,{detail:h,bubbles:!0,composed:!0}))}}#e=[];#s=s;#r=[];#n;#t=!0;#i(f=[]){if(!this.#t)return;this.#n=void 0,this.#o(f);let _=r(this.#s),h=(y,Z=!1)=>re=>{let he=y(re);he instanceof x&&this.send(new V(he[0],Z))},m=this.shadowRoot.childNodes[this.#e.length]??this.shadowRoot.appendChild(document.createTextNode(""));fr(m,_,h)}#o(f=[]){for(;this.#r.length>0;){let _=this.#r.shift(),[h,m]=t(this.#s,_);f=f.concat(m.all.toArray()),this.#s=h}for(;f.length>0;){let _=f.shift(),h=re=>this.send(new V(re)),m=(re,he)=>this.dispatchEvent(new CustomEvent(re,{detail:he,bubbles:!0,composed:!0})),y=()=>{},Z=this.shadowRoot;_({dispatch:h,emit:m,select:y,root:Z})}this.#r.length>0&&this.#o(f)}async#u(){let f=[];for(let h of document.querySelectorAll("link[rel=stylesheet]"))h.sheet||f.push(new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",y)}));for(await Promise.allSettled(f);this.#e.length;)this.#e.shift().remove(),this.shadowRoot.firstChild.remove();this.shadowRoot.adoptedStyleSheets=this.getRootNode().adoptedStyleSheets;let _=[];for(let h of document.styleSheets)try{this.shadowRoot.adoptedStyleSheets.push(h)}catch{try{let m=new CSSStyleSheet;for(let y of h.cssRules)m.insertRule(y.cssText,m.cssRules.length);this.shadowRoot.adoptedStyleSheets.push(m)}catch{let m=h.ownerNode.cloneNode();this.shadowRoot.prepend(m),this.#e.push(m),_.push(new Promise((y,Z)=>{m.onload=y,m.onerror=Z}))}}return Promise.allSettled(_)}};return window.customElements.define(i,c),new x(void 0)},Oi=class e{static start({init:t,update:r,view:n,on_attribute_change:i},s){let o=new e(t(s),r,n,i);return new x(l=>o.send(l))}constructor([t,r],n,i,s){this.#e=t,this.#s=n,this.#n=i,this.#t=i(t),this.#u=s,this.#i=new Map,this.#o=so(this.#t),this.#l(r.all.toArray())}send(t){if(t instanceof Rr){for(let r of t[0]){let n=this.#u.get(r[0]);if(!n)continue;let i=n(r[1]);i instanceof g||this.#r.push(i)}this.#l()}else if(t instanceof Gr)this.#r=this.#r.concat(t[0].toArray()),this.#l(t[1].all.toArray());else if(!(t instanceof Bt))if(t instanceof V)this.#r.push(t[0]),this.#l();else if(t instanceof It){let r=new Hr(t[0],t[1]);for(let[n,i]of this.#i)i(r)}else if(t instanceof Zr){let r=this.#o.get(t[0]);if(!r)return;let n=r(t[1]);if(n instanceof g)return;this.#r.push(n[0]),this.#l()}else if(t instanceof Kr){let r=ti(this.#u),n=new Ur(r,this.#t);this.#i=this.#i.set(t[0],t[1]),t[1](n)}else t instanceof Vr&&(this.#i=this.#i.delete(t[0]))}#e;#s;#r;#n;#t;#i;#o;#u;#l(t=[]){this.#a(t);let r=this.#n(this.#e),n=elements(this.#t,r);if(!_o(n)){let i=new Yr(n);for(let[s,o]of this.#i)o(i)}this.#t=r,this.#o=n.handlers}#a(t=[]){for(;this.#r.length>0;){let r=this.#r.shift(),[n,i]=this.#s(this.#e,r);t=t.concat(i.all.toArray()),this.#e=n}for(;t.length>0;)t.shift()({dispatch:l=>this.send(new V(l)),emit:(l,c)=>this.root.dispatchEvent(new CustomEvent(l,{detail:c,bubbles:!0,composed:!0})),select:()=>{},root:null});this.#r.length>0&&this.#a(t)}},Ta=Oi.start,vi=()=>globalThis.window&&window.document;function xo(e,t,r){return e?t():r()}var Ne=class extends a{constructor(t,r){super(),this.seconds=t,this.nanoseconds=r}};function Li(e){let t=1e9,r=Q(e.nanoseconds,t),n=e.nanoseconds-r,i=e.seconds+I(n,t);return r>=0?new Ne(i,r):new Ne(i-1,t+r)}function wo(e,t){let r=new Ne(t.seconds-e.seconds,t.nanoseconds-e.nanoseconds);return Li(r)}function pr(e,t){let r=new Ne(e.seconds+t.seconds,e.nanoseconds+t.nanoseconds);return Li(r)}function _r(e){return new Ne(e,0)}function rn(e){let t=new Ne(0,e);return Li(t)}function dr(e){return[e.seconds,e.nanoseconds]}var R=864e8;function vo(e){return e*R}function ko(e){return I(e,R)}var jo=1,an=0,ec=0,tc=0,So=!1,Ao=!1,cn=0;function Oo(){return Date.now()*1e3+cn}function Lo(){return Math.trunc(performance.now()*1e3)+cn}function Si(){if(Ao)return an+cn;if(So){let e=Oo()-ec,t=Math.trunc(e*jo);return an+t}return Oo()}function Ai(){return-new Date().getTimezoneOffset()}function Mo(){if(Ao)return an+cn;if(So){let e=Lo()-tc,t=Math.trunc(e*jo);return an+t}return Lo()}var rc=1;function Eo(){return rc++}var Mi=class extends a{constructor(t,r,n,i){super(),this.timestamp_utc_us=t,this.offset_local_us=r,this.monotonic_us=n,this.unique=i}},fn=class extends a{constructor(t,r,n){super(),this.date=t,this.time=r,this.offset=n}};var Dt=class extends a{constructor(t,r){super(),this.date=t,this.time=r}},Ei=class extends a{constructor(t){super(),this.minutes=t}},zt=class extends a{constructor(t){super(),this.unix_days=t}};var Fe=class extends a{constructor(t){super(),this.microseconds=t}},Ti=class extends a{},mr=class extends a{constructor(t){super(),this.microseconds=t}};function Wo(e){return e.unique}function Jo(e,t,r){return new fn(e,t,r)}function Po(e){return new Dt(e.date,e.time)}function Di(e){return e.date}function zi(e){return e.time}function Yo(e){return new zt(I(e,86400))}function Ho(e){return new zt(I(e,R))}function Uo(e){return Ho(e.timestamp_utc_us)}function Ro(e){return e.unix_days*86400}function Go(e,t){return new zt(e.unix_days+t)}function Zo(e,t){return new zt(e.unix_days-t)}function pn(e){if(e instanceof Fe&&e.microseconds<0){let t=e.microseconds;return new Fe(R+Q(t,R))}else if(e instanceof Fe&&e.microseconds>=R){let t=e.microseconds;return new Fe(Q(t,R))}else return e}function Ct(e){return new Fe(e)}function Te(e){let t=pn(e);if(t instanceof Fe)return t.microseconds;if(t instanceof Ti)return R;{let r=t.microseconds;return R+r}}function Ko(e){return Ct(Q(e,R))}function Vo(e){return Ko(e.timestamp_utc_us)}function Qe(e){return rn(e*1e3)}function uc(e){let t=-e.minutes*6e7;return Qe(t)}function Ci(e){let t=Te(e);return Qe(t)}function Ve(e){let t=dr(e),r=t[0],n=t[1];return r*1e6+I(n,1e3)}function Qo(e,t){let r=Ve(t);if(r===0)return e;if(e instanceof mr&&r+e.microseconds<1e6){let i=e.microseconds;return new mr(i+r)}else if(e instanceof mr){let i=Te(e)+(r-1e6),s=Ct(i);return pn(s)}else{let i=Te(e)+r,s=Ct(i);return pn(s)}}function Xo(e,t){if(Ve(t)===0)return e;{let n=Te(e)-Ve(t),i=Ct(n);return pn(i)}}function lc(e,t){let r=_r(e);return pr(r,rn(t))}function Ni(e){let r=vo(e);return Qe(r)}function eu(e,t){return pr(e,t)}function Fi(e){let t=dr(e),r=t[0],n=t[1];if(r>=0&&n>=0)return e;{let s=r<0?-r:r,o=n<0?-n:n;return lc(s,o)}}function tu(e){return wo(e,_r(0))}function _n(e,t){return pr(e,tu(t))}function Wi(e){let t=dr(e),r=t[0],n=t[1];return r>=0&&n>=0}function Ji(e){let t=Ve(e);return ko(t)}function ru(e){return Ve(e)}function nu(){return Ai()*6e7}function iu(){return new Mi(Si(),nu(),Mo(),Eo())}var $r=new Ei(0);function su(e){return new fn(Uo(e),Vo(e),$r)}function ou(e,t){return fi(!Wi(t),()=>Pi(e,Fi(t)),()=>{let r=Ji(t),n=_n(t,Ni(r)),i=(()=>{let _=e.time,h=Ci(_),m=_n(h,n);return ru(m)})(),s=i<0?[i+R,r+1]:[i,r],o=s[0],l=s[1],c=Qe(Te(e.time)-o),p=(()=>{let _=e.date;return Zo(_,l)})(),f=(()=>{let _=e.time;return Xo(_,c)})();return new Dt(p,f)})}function Pi(e,t){return fi(!Wi(t),()=>ou(e,Fi(t)),()=>{let r=Ji(t),n=_n(t,Ni(r)),i=(()=>{let _=e.time,h=Ci(_),m=eu(h,n);return ru(m)})(),s=i>=R?[i-R,r+1]:[i,r],o=s[0],l=s[1],c=Qe(o-Te(e.time)),p=(()=>{let _=e.date;return Go(_,l)})(),f=(()=>{let _=e.time;return Qo(_,c)})();return new Dt(p,f)})}function uu(e){let t=(()=>{let n=Po(e);return Pi(n,uc(e.offset))})();return new Dt(t.date,t.time)}function Ui(e){return Yo(e)}function Ri(e){return Ro(e)}function dn(e){return Ui(I(e,1e3))}function mn(e){return Ri(e)*1e3}function du(e){let t=(e-mn(dn(e)))*1e3;return Ct(t)}function jc(e,t,r){return Jo(e,t,r)}function Zi(e){return jc(dn(e),du(e),$r)}function Sc(e){return uu(e)}function hr(e){let t=Sc(e);return mn(Di(t))+I(Te(zi(t)),1e3)}function mu(){return iu()}function $u(e){return su(e)}function hu(e){return Wo(e)}function Oe(e){return nr(e)}function G(e,t){return ke("div",e,t)}function Ki(e){return ke("hr",e,u([]))}function xr(e,t){return ke("p",e,t)}function Vi(e,t){return ke("span",e,t)}function Je(e,t){return ke("button",e,t)}function xu(e){return ke("input",e,u([]))}function wu(e,t){return ke("textarea",e,u([nr(t)]))}function Xe(e,t){return no(e,t)}function Pe(e,t){return uo(e,t)}function Ye(e){return Pe("click",t=>new x(e))}function Qi(e){return Pe("focus",t=>new x(e))}function Xi(e){return Pe("blur",t=>new x(e))}function Tc(e){let t=e;return li("target",li("value",Fs))(t)}function es(e){return Pe("input",t=>{let r=Tc(t);return fe(r,e)})}var xn="http://www.w3.org/2000/svg";function ts(e){return Tt(xn,"line",e,u([]))}function rs(e){return Tt(xn,"polyline",e,u([]))}function et(e,t){return Tt(xn,"svg",e,t)}function B(e){return Tt(xn,"path",e,u([]))}function yu(e){return et($(d("stroke-linejoin","round"),$(d("stroke-linecap","round"),$(d("stroke-width","2"),$(d("stroke","currentColor"),$(d("fill","none"),$(d("viewBox","0 0 24 24"),$(d("height","24"),$(d("width","24"),e)))))))),u([B(u([d("d","M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z")])),B(u([d("d","M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1")]))]))}function bu(e){return et($(d("stroke-linejoin","round"),$(d("stroke-linecap","round"),$(d("stroke-width","2"),$(d("stroke","currentColor"),$(d("fill","none"),$(d("viewBox","0 0 24 24"),$(d("height","24"),$(d("width","24"),e)))))))),u([B(u([d("d","M13 7 8.7 2.7a2.41 2.41 0 0 0-3.4 0L2.7 5.3a2.41 2.41 0 0 0 0 3.4L7 13")])),B(u([d("d","m8 6 2-2")])),B(u([d("d","m18 16 2-2")])),B(u([d("d","m17 11 4.3 4.3c.94.94.94 2.46 0 3.4l-2.6 2.6c-.94.94-2.46.94-3.4 0L11 17")])),B(u([d("d","M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z")])),B(u([d("d","m15 5 4 4")]))]))}function vu(e){return et($(d("stroke-linejoin","round"),$(d("stroke-linecap","round"),$(d("stroke-width","2"),$(d("stroke","currentColor"),$(d("fill","none"),$(d("viewBox","0 0 24 24"),$(d("height","24"),$(d("width","24"),e)))))))),u([B(u([d("d","m3 10 2.5-2.5L3 5")])),B(u([d("d","m3 19 2.5-2.5L3 14")])),B(u([d("d","M10 6h11")])),B(u([d("d","M10 12h11")])),B(u([d("d","M10 18h11")]))]))}function ku(e){return et($(d("stroke-linejoin","round"),$(d("stroke-linecap","round"),$(d("stroke-width","2"),$(d("stroke","currentColor"),$(d("fill","none"),$(d("viewBox","0 0 24 24"),$(d("height","24"),$(d("width","24"),e)))))))),u([rs(u([d("points","15 3 21 3 21 9")])),rs(u([d("points","9 21 3 21 3 15")])),ts(u([d("y2","10"),d("y1","3"),d("x2","14"),d("x1","21")])),ts(u([d("y2","14"),d("y1","21"),d("x2","10"),d("x1","3")]))]))}function ns(e){return et($(d("stroke-linejoin","round"),$(d("stroke-linecap","round"),$(d("stroke-width","2"),$(d("stroke","currentColor"),$(d("fill","none"),$(d("viewBox","0 0 24 24"),$(d("height","24"),$(d("width","24"),e)))))))),u([B(u([d("d","M18 6 6 18")])),B(u([d("d","m6 6 12 12")]))]))}function Ou(e){return et($(d("stroke-linejoin","round"),$(d("stroke-linecap","round"),$(d("stroke-width","2"),$(d("stroke","currentColor"),$(d("fill","none"),$(d("viewBox","0 0 24 24"),$(d("height","24"),$(d("width","24"),e)))))))),u([B(u([d("d","M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z")])),B(u([d("d","m15 5 4 4")]))]))}var Lu="line-discussion";var wr=class extends a{constructor(t,r,n,i,s,o,l,c){super(),this.note_id=t,this.parent_id=r,this.significance=n,this.user_name=i,this.message=s,this.expanded_message=o,this.time=l,this.modifier=c}},tt=class extends a{},rt=class extends a{},nt=class extends a{},Nt=class extends a{},it=class extends a{},Ft=class extends a{},Wt=class extends a{},Jt=class extends a{},Pt=class extends a{},Yt=class extends a{},Ht=class extends a{},gr=class extends a{},yr=class extends a{},Ut=class extends a{};function Dc(e){return e instanceof tt?1:e instanceof rt?2:e instanceof nt?3:e instanceof Nt?4:e instanceof it?5:e instanceof Ft?6:e instanceof Wt?7:e instanceof Jt?8:e instanceof Pt?9:e instanceof Yt?10:e instanceof Ht?11:12}function zc(e){return e instanceof yr?0:e instanceof Ut?1:2}function ju(e){return me(u([["n",de(e.note_id)],["p",de(e.parent_id)],["s",T((()=>{let t=e.significance;return Dc(t)})())],["u",de(e.user_name)],["m",de(e.message)],["x",to(e.expanded_message,de)],["t",T((()=>{let t=e.time;return hr(t)})())],["d",T((()=>{let t=e.modifier;return zc(t)})())]]))}var is=class extends a{constructor(t,r,n,i,s,o,l,c){super(),this.note_id=t,this.parent_id=r,this.significance=n,this.user_name=i,this.message=s,this.expanded_message=o,this.time=l,this.edited=c}},st=class extends a{},ot=class extends a{},ut=class extends a{},lt=class extends a{},at=class extends a{},ct=class extends a{},ft=class extends a{},br=class extends a{},pt=class extends a{},_t=class extends a{},dt=class extends a{},mt=class extends a{},$t=class extends a{},ht=class extends a{},xt=class extends a{},wt=class extends a{},gt=class extends a{},vr=class extends a{};function Cc(e){if(e===0)return new st;if(e===1)return new ot;if(e===2)return new ut;if(e===3)return new lt;if(e===4)return new at;if(e===5)return new ct;if(e===6)return new ft;if(e===7)return new br;if(e===8)return new pt;if(e===9)return new _t;if(e===10)return new dt;if(e===11)return new mt;if(e===12)return new $t;if(e===13)return new ht;if(e===14)return new xt;if(e===15)return new wt;if(e===16)return new gt;if(e===17)return new vr;throw ce("panic","o11a/computed_note",128,"significance_from_int","Invalid note significance found",{})}function Nc(){return Y("n",z,e=>Y("p",z,t=>Y("s",At,r=>Y("u",z,n=>Y("m",z,i=>Y("x",ci(z),s=>Y("t",At,o=>Y("e",St,l=>Ze(new is(e,t,Cc(r),n,i,s,Zi(o),l))))))))))}function Au(e){return e instanceof st?new b:e instanceof ot?new w("Unanswered Question"):e instanceof ut?new w("Answered"):e instanceof lt?new w("Answer"):e instanceof at?new w("Incomplete ToDo"):e instanceof ct?new w("Complete"):e instanceof ft?new w("Completion"):e instanceof br?new w("Unconfirmed Finding"):e instanceof pt?new w("Confirmed Finding"):e instanceof _t?new w("Rejected Finding"):e instanceof dt?new w("Confirmation"):e instanceof mt?new w("Rejection"):e instanceof $t?new w("Unanswered Dev Question"):e instanceof ht?new w("Answered Dev Question"):e instanceof xt?new w("Info"):e instanceof wt?new w("Incorrect Info"):e instanceof gt?new w("Rejection"):new w("Confirmation")}function Mu(e){return e instanceof st?!1:e instanceof ot||e instanceof ut?!0:e instanceof lt?!1:e instanceof at||e instanceof ct?!0:e instanceof ft?!1:e instanceof br||e instanceof pt||e instanceof _t?!0:e instanceof dt||e instanceof mt?!1:e instanceof $t||e instanceof ht||e instanceof xt||e instanceof wt?!0:(e instanceof gt,!1)}function Eu(e){return J(te(e,z),t=>fe((()=>{let r=Xs(t,Gs(Nc()));return Me(r,u([new pe("json-encoded computed note",ze(t),u([]))]))})(),r=>Bs(r,n=>n.parent_id)))}var Tu="user-submitted-line-note",Bu="user-clicked-discussion-preview",ss="user-focused-input",Iu="user-unfocused-input",qu="user-maximized-thread";function Du(e){return Pe("keydown",t=>{let r=Y("ctrlKey",St,i=>Y("key",z,s=>Ze([i,s]))),n=u([new q("","",u([]))]);return J((()=>{let i=te(t,r);return Me(i,n)})(),i=>{let s=i[0],o=i[1];return s&&o==="Enter"?new x(e):new g(n)})})}var N=class extends a{constructor(t,r,n,i,s,o,l,c,p,f,_,h,m,y){super(),this.user_name=t,this.line_number=r,this.line_id=n,this.line_tag=i,this.line_number_text=s,this.notes=o,this.current_note_draft=l,this.current_thread_id=c,this.current_thread_notes=p,this.active_thread=f,this.show_expanded_message_box=_,this.current_expanded_message_draft=h,this.expanded_messages=m,this.editing_note=y}},os=class extends a{constructor(t,r,n,i){super(),this.current_thread_id=t,this.parent_note=r,this.prior_thread_id=n,this.prior_thread=i}},wn=class extends a{constructor(t){super(),this[0]=t}},gn=class extends a{constructor(t){super(),this[0]=t}},yn=class extends a{constructor(t){super(),this[0]=t}},bn=class extends a{constructor(t){super(),this[0]=t}},kr=class extends a{},vn=class extends a{constructor(t,r){super(),this.new_thread_id=t,this.parent_note=r}},kn=class extends a{},On=class extends a{constructor(t){super(),this[0]=t}},Ln=class extends a{constructor(t){super(),this[0]=t}},jn=class extends a{constructor(t){super(),this.for_note_id=t}},us=class extends a{},Sn=class extends a{},An=class extends a{},Or=class extends a{},Mn=class extends a{},Lr=class extends a{constructor(t){super(),this[0]=t}},En=class extends a{},ls=class extends a{};function Pc(e){return[new N("guest",0,"","","",K(),"","",u([]),new b,!1,new b,Pr(),new b),C()]}function Yc(e){let t=e.active_thread;if(t instanceof w){let r=t[0];return G(u([]),u([G(u([k("flex justify-end width-full")]),u([Je(u([Ye(new kn),k("icon-button flex gap-[.5rem] pl-[.5rem] pr-[.3rem] pt-[.3rem] pb-[.1rem] mb-[.25rem]")]),u([Oe("Close Thread"),ns(u([]))]))])),Oe("Current Thread: "),Oe(r.parent_note.message),(()=>{let n=r.parent_note.expanded_message;if(n instanceof w){let i=n[0];return G(u([k("mt-[.5rem]")]),u([xr(u([]),u([Oe(i)]))]))}else return Ee(u([]))})(),Ki(u([k("mt-[.5rem]")]))]))}else return G(u([k("flex items-center justify-between width-full")]),u([Vi(u([k("pt-[.1rem]")]),u([Oe(e.line_tag)])),Je(u([Ye(new Mn),k("icon-button p-[.3rem] ")]),u([ku(u([]))]))]))}function Hc(e){let t="input-border rounded-md text-[0.65rem] pb-[0.15rem] pt-1 px-[0.5rem]",r=Au(e);if(r instanceof w){let n=r[0];return Vi(u([k(t)]),u([Oe(n)]))}else return Ee(u([]))}function Uc(e){return U(e.current_thread_notes,t=>G(u([k("line-discussion-item")]),u([G(u([k("flex justify-between mb-[.2rem]")]),u([G(u([k("flex gap-[.5rem] items-start")]),u([xr(u([]),u([Oe(t.user_name)])),Hc(t.significance)])),G(u([k("flex gap-[.5rem]")]),u([Je(u([$e("edit-message-button"),k("icon-button p-[.3rem]"),Ye(new Lr(t))]),u([Ou(u([]))])),t.expanded_message instanceof w?Je(u([$e("expand-message-button"),k("icon-button p-[.3rem]"),Ye(new jn(t.note_id))]),u([vu(u([]))])):Ee(u([])),Mu(t.significance)?Je(u([$e("switch-thread-button"),k("icon-button p-[.3rem]"),Ye(new vn(t.note_id,t))]),u([yu(u([]))])):Ee(u([]))]))])),xr(u([]),u([Oe(t.message)])),wi(e.expanded_messages,t.note_id)?G(u([k("mt-[.5rem]")]),u([xr(u([]),u([Oe((()=>{let n=t.expanded_message;return jr(n,"")})())]))])):Ee(u([])),Ki(u([k("mt-[.5rem]")]))])))}function Rc(e){let t="absolute overlay p-[.5rem] flex w-[100%] h-60 mt-2",r="grow text-[.95rem] resize-none p-[.3rem]";return G(u([$e("expanded-message"),e.show_expanded_message_box?k(t+" show-exp"):k(t)]),u([wu(u([$e("expanded-message-box"),k(r),$i("Write an expanded message body"),es(n=>new Ln(n)),Qi(new An),Xi(new Or),Du(new kr)]),(()=>{let n=e.current_expanded_message_draft;return jr(n,"")})())]))}function Gc(e,t){if(t){if(e==="done")return[new it,"done"];if(e.startsWith("done: ")){let r=e.slice(6);return[new it,r]}else if(e.startsWith("a: ")){let r=e.slice(3);return[new nt,r]}else if(e.startsWith("answer: ")){let r=e.slice(8);return[new nt,r]}else if(e.startsWith("reject: ")){let r=e.slice(8);return[new Jt,r]}else if(e.startsWith("confirm: ")){let r=e.slice(9);return[new Wt,r]}else if(e.startsWith("incorrect: ")){let r=e.slice(11);return[new Ht,r]}else if(e.startsWith("correct: ")){let r=e.slice(9);return[new gr,r]}else return[new tt,e]}else if(e.startsWith("todo: ")){let r=e.slice(6);return[new Nt,r]}else if(e.startsWith("q: ")){let r=e.slice(3);return[new rt,r]}else if(e.startsWith("question: ")){let r=e.slice(10);return[new rt,r]}else if(e.startsWith("finding: ")){let r=e.slice(9);return[new Ft,r]}else if(e.startsWith("dev: ")){let r=e.slice(5);return[new Pt,r]}else if(e.startsWith("info: ")){let r=e.slice(6);return[new Yt,r]}else return[new tt,e]}function Zc(e){return e instanceof lt?"a: ":e instanceof ht?"dev: ":e instanceof ut?"q: ":e instanceof st?"":e instanceof ct?"todo: ":e instanceof pt?"finding: ":e instanceof dt?"confirm: ":e instanceof mt?"reject: ":e instanceof at?"todo: ":e instanceof xt?"info: ":e instanceof vr?"correct: ":e instanceof gt?"incorrect: ":e instanceof _t?"finding: ":e instanceof wt?"info: ":e instanceof ft?"done: ":e instanceof $t?"dev: ":e instanceof ot?"q: ":"finding: "}function Kc(e,t){if(t instanceof wn){let r=t[0];return[(()=>{let n=e;return new N(n.user_name,n.line_number,r,n.line_tag,n.line_number_text,n.notes,n.current_note_draft,r,(()=>{let i=oe(e.notes,r);return jt(i,u([]))})(),n.active_thread,n.show_expanded_message_box,n.current_expanded_message_draft,n.expanded_messages,n.editing_note)})(),C()]}else if(t instanceof gn){let r=t[0],n=E(r);return[(()=>{let i=e;return new N(i.user_name,r,i.line_id,"L"+n,n,i.notes,i.current_note_draft,i.current_thread_id,i.current_thread_notes,i.active_thread,i.show_expanded_message_box,i.current_expanded_message_draft,i.expanded_messages,i.editing_note)})(),C()]}else if(t instanceof yn){let r=t[0];return[(()=>{let n=e;return new N(n.user_name,n.line_number,n.line_id,n.line_tag,n.line_number_text,r,n.current_note_draft,n.current_thread_id,(()=>{let i=oe(r,e.current_thread_id);return jt(i,u([]))})(),n.active_thread,n.show_expanded_message_box,n.current_expanded_message_draft,n.expanded_messages,n.editing_note)})(),C()]}else if(t instanceof bn){let r=t[0];return ef("user wrote note","src/o11a/ui/line_discussion.gleam",190),[(()=>{let n=e;return new N(n.user_name,n.line_number,n.line_id,n.line_tag,n.line_number_text,n.notes,r,n.current_thread_id,n.current_thread_notes,n.active_thread,n.show_expanded_message_box,n.current_expanded_message_draft,n.expanded_messages,n.editing_note)})(),C()]}else if(t instanceof kr){let r=Gc((()=>{let s=e.current_note_draft;return oi(s)})(),Dn(e.active_thread)),n=r[0],i=r[1];return xo(e.current_note_draft==="",()=>[e,C()],()=>{let s=mu(),o=$u(s),l=e.user_name+(()=>{let y=hu(s);return E(y)})()+(()=>{let y=hr(o);return E(y)})(),c=(()=>{let m=e.editing_note;if(m instanceof w){let y=m[0];return[new Ut,y.note_id]}else return[new yr,e.current_thread_id]})(),p=c[0],f=c[1],_=(()=>{let m=(()=>{let y=e.current_expanded_message_draft;return Sr(y,oi)})();return m instanceof w&&m[0]===""?new b:m})(),h=new wr(l,f,n,"user"+(()=>{let m=ei(100);return E(m)})(),i,_,o,p);return[(()=>{let m=e;return new N(m.user_name,m.line_number,m.line_id,m.line_tag,m.line_number_text,m.notes,"",m.current_thread_id,m.current_thread_notes,m.active_thread,!1,new b,m.expanded_messages,new b)})(),Xe(Tu,me(u([["note",ju(h)],["line_id",de(e.line_id)]])))]})}else if(t instanceof vn){let r=t.new_thread_id,n=t.parent_note;return[(()=>{let i=e;return new N(i.user_name,i.line_number,i.line_id,i.line_tag,i.line_number_text,i.notes,i.current_note_draft,r,(()=>{let s=oe(e.notes,r);return jt(s,u([]))})(),new w(new os(r,n,e.current_thread_id,e.active_thread)),i.show_expanded_message_box,i.current_expanded_message_draft,i.expanded_messages,i.editing_note)})(),C()]}else if(t instanceof kn){let r=(()=>{let i=e.active_thread,s=Sr(i,o=>o.prior_thread);return ms(s)})(),n=(()=>{let i=Sr(r,s=>s.current_thread_id);return jr(i,e.line_id)})();return[(()=>{let i=e;return new N(i.user_name,i.line_number,i.line_id,i.line_tag,i.line_number_text,i.notes,i.current_note_draft,n,(()=>{let s=oe(e.notes,n);return jt(s,u([]))})(),r,i.show_expanded_message_box,i.current_expanded_message_draft,i.expanded_messages,i.editing_note)})(),C()]}else if(t instanceof On){let r=t[0];return[(()=>{let n=e;return new N(n.user_name,n.line_number,n.line_id,n.line_tag,n.line_number_text,n.notes,n.current_note_draft,n.current_thread_id,n.current_thread_notes,n.active_thread,r,n.current_expanded_message_draft,n.expanded_messages,n.editing_note)})(),C()]}else if(t instanceof Ln){let r=t[0];return[(()=>{let n=e;return new N(n.user_name,n.line_number,n.line_id,n.line_tag,n.line_number_text,n.notes,n.current_note_draft,n.current_thread_id,n.current_thread_notes,n.active_thread,n.show_expanded_message_box,new w(r),n.expanded_messages,n.editing_note)})(),C()]}else if(t instanceof jn){let r=t.for_note_id;return wi(e.expanded_messages,r)?[(()=>{let i=e;return new N(i.user_name,i.line_number,i.line_id,i.line_tag,i.line_number_text,i.notes,i.current_note_draft,i.current_thread_id,i.current_thread_notes,i.active_thread,i.show_expanded_message_box,i.current_expanded_message_draft,co(e.expanded_messages,r),i.editing_note)})(),C()]:[(()=>{let i=e;return new N(i.user_name,i.line_number,i.line_id,i.line_tag,i.line_number_text,i.notes,i.current_note_draft,i.current_thread_id,i.current_thread_notes,i.active_thread,i.show_expanded_message_box,i.current_expanded_message_draft,gi(e.expanded_messages,r),i.editing_note)})(),C()]}else{if(t instanceof us)return[e,Xe(Bu,me(u([["line_number",T(e.line_number)],["discussion_lane",T(1)]])))];if(t instanceof Sn)return[e,Xe(ss,me(u([["line_number",T(e.line_number)],["discussion_lane",T(1)]])))];if(t instanceof An)return[(()=>{let r=e;return new N(r.user_name,r.line_number,r.line_id,r.line_tag,r.line_number_text,r.notes,r.current_note_draft,r.current_thread_id,r.current_thread_notes,r.active_thread,!0,r.current_expanded_message_draft,r.expanded_messages,r.editing_note)})(),Xe(ss,me(u([["line_number",T(e.line_number)],["discussion_lane",T(1)]])))];if(t instanceof Or)return[e,Xe(Iu,me(u([["line_number",T(e.line_number)],["discussion_lane",T(1)]])))];if(t instanceof Mn)return[e,Xe(qu,me(u([["line_number",T(e.line_number)],["discussion_lane",T(1)]])))];if(t instanceof Lr){let r=t[0];return[(()=>{let n=e;return new N(n.user_name,n.line_number,n.line_id,n.line_tag,n.line_number_text,n.notes,Zc(r.significance)+r.message,n.current_thread_id,n.current_thread_notes,n.active_thread,r.expanded_message instanceof w,r.expanded_message,n.expanded_messages,new w(r))})(),C()]}else if(t instanceof En){let r=Ts(e.current_thread_notes);if(r.isOk()){let n=r[0];return[e,ro(i=>i(new Lr(n)))]}else return[e,C()]}else return[(()=>{let r=e;return new N(r.user_name,r.line_number,r.line_id,r.line_tag,r.line_number_text,r.notes,"",r.current_thread_id,r.current_thread_notes,r.active_thread,!1,new b,r.expanded_messages,new b)})(),C()]}}function Vc(e,t){return Pe("keydown",r=>{let n=Y("ctrlKey",St,s=>Y("key",z,o=>Ze([s,o]))),i=u([new q("","",u([]))]);return J((()=>{let s=te(r,n);return Me(s,i)})(),s=>{let o=s[0],l=s[1];return o&&l==="Enter"?new x(e):l==="ArrowUp"?new x(t):new g(i)})})}function Qc(e){return G(u([k("flex justify-between items-center gap-[.35rem]")]),u([Je(u([$e("toggle-expanded-message-button"),k("icon-button p-[.3rem]"),Ye(new On(!e.show_expanded_message_box))]),u([bu(u([]))])),e.editing_note instanceof w?Je(u([$e("cancel-message-edit-button"),k("icon-button p-[.3rem]"),Ye(new ls)]),u([ns(u([]))])):Ee(u([])),xu(u([$e("new-comment-input"),k("inline-block w-full grow text-[0.9rem] pl-2 pb-[.2rem] p-[0.3rem] border-[none] border-t border-solid;"),$i("Add a new comment"),es(t=>new bn(t)),Qi(new Sn),Xi(new Or),Vc(new kr,new En),ao(e.current_note_draft)]))]))}function Xc(e){return Kn("Rendering line discussion "+e.line_tag),G(u([$e("line-discussion-overlay")]),u([G(u([k("overlay p-[.5rem]")]),u([Dn(e.active_thread)||ni(e.current_thread_notes)>0?G(u([$e("comment-list"),k("flex flex-col-reverse overflow-auto max-h-[30rem] gap-[.5rem] mb-[.5rem]")]),u([Ee(Uc(e)),Yc(e)])):Ee(u([])),Qc(e)])),Rc(e)]))}function zu(){return mo(Pc,Kc,Xc,Ir(u([["line-discussion",e=>(()=>{let r=Eu(e);if(r.isOk()){let n=r[0];return new x(new yn(n))}else return new g(u([new q("line-discussion",ze(e),u([]))]))})()],["line-id",e=>{let t=te(e,z);if(t.isOk()){let r=t[0];return new x(new wn(r))}else return new g(u([new q("line-id",ze(e),u([]))]))}],["line-number",e=>{let t=te(e,z);if(t.isOk()){let r=t[0],n=Re(r);if(n.isOk()){let i=n[0];return new x(new gn(i))}else return new g(u([new q("line-number",r,u([]))]))}else return new g(u([new q("line-number",ze(e),u([]))]))}]])))}var Cu=Lu;function ef(e,t,r){let n="\x1B[90m",i="\x1B[39m",s=`${t}:${r}`,o=Be(e);if(typeof process=="object"&&process.stderr?.write){let l=`${n}${s}${i}
${o}
`;process.stderr.write(l)}else if(typeof Deno=="object"){let l=`${n}${s}${i}
${o}
`;Deno.stderr.writeSync(new TextEncoder().encode(l))}else{let l=`${s}
${o}`;console.log(l)}return e}function tf(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];n==`
`?t+="\\n":n=="\r"?t+="\\r":n=="	"?t+="\\t":n=="\f"?t+="\\f":n=="\\"?t+="\\\\":n=='"'?t+='\\"':n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}return t+='"',t}function rf(e){let t="dict.from_list([",r=!0,n=[];return e.forEach((i,s)=>{n.push([s,i])}),n.sort(),n.forEach(([i,s])=>{r||(t=t+", "),t=t+"#("+Be(i)+", "+Be(s)+")",r=!1}),t+"])"}function nf(e){let t=Object.keys(e).map(r=>{let n=Be(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function sf(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let s of Object.keys(e))r.push(`${Be(s)}: ${Be(e[s])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function Be(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return tf(e);if(t==="bigint"||t==="number")return e.toString();if(Array.isArray(e))return`#(${e.map(Be).join(", ")})`;if(e instanceof M)return`[${e.toArray().map(Be).join(", ")}]`;if(e instanceof yt)return`//utfcodepoint(${String.fromCodePoint(e.value)})`;if(e instanceof ae)return of(e);if(e instanceof a)return nf(e);if(uf(e))return rf(e);if(e instanceof Set)return`//js(Set(${[...e].map(Be).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return sf(e)}function of(e){let t=e.bitOffset+8*Math.trunc(e.bitSize/8),r=qn(e,e.bitOffset,t),n=e.bitSize%8;if(n>0){let i=ps(e,t,e.bitSize,!1,!1),s=Array.from(r.rawBuffer),o=`${i}:size(${n})`;return s.length===0?`<<${o}>>`:`<<${Array.from(r.rawBuffer).join(", ")}, ${o}>>`}else return`<<${Array.from(r.rawBuffer).join(", ")}>>`}function uf(e){try{return e instanceof se}catch{return!1}}bi(zu(),Cu);
